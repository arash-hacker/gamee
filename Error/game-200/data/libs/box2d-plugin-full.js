/*
    2015 Photon Storm Ltd.
 @license      {@link http://choosealicense.com/licenses/no-license/|No License}
*/
var COMPILED=!0,goog=goog||{};goog.global=this;goog.isDef=function(a){return void 0!==a};goog.exportPath_=function(a,b,c){a=a.split(".");c=c||goog.global;a[0]in c||!c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)!a.length&&goog.isDef(b)?c[d]=b:c=c[d]?c[d]:c[d]={}};
goog.define=function(a,b){var c=b;COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,a)?c=goog.global.CLOSURE_UNCOMPILED_DEFINES[a]:goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,a)&&(c=goog.global.CLOSURE_DEFINES[a]));goog.exportPath_(a,c)};goog.DEBUG=!0;goog.LOCALE="en";goog.TRUSTED_SITE=!0;goog.STRICT_MODE_COMPATIBLE=!1;
goog.provide=function(a){if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a];for(var b=a;(b=b.substring(0,b.lastIndexOf(".")))&&!goog.getObjectByName(b);)goog.implicitNamespaces_[b]=!0}goog.exportPath_(a)};goog.setTestOnly=function(a){if(COMPILED&&!goog.DEBUG)throw a=a||"",Error("Importing test-only code into non-debug environment"+(a?": "+a:"."));};goog.forwardDeclare=function(a){};
COMPILED||(goog.isProvided_=function(a){return!goog.implicitNamespaces_[a]&&goog.isDefAndNotNull(goog.getObjectByName(a))},goog.implicitNamespaces_={});goog.getObjectByName=function(a,b){for(var c=a.split("."),d=b||goog.global,e;e=c.shift();)if(goog.isDefAndNotNull(d[e]))d=d[e];else return null;return d};goog.globalize=function(a,b){var c=b||goog.global,d;for(d in a)c[d]=a[d]};
goog.addDependency=function(a,b,c){if(goog.DEPENDENCIES_ENABLED){var d;a=a.replace(/\\/g,"/");for(var e=goog.dependencies_,f=0;d=b[f];f++)e.nameToPath[d]=a,a in e.pathToNames||(e.pathToNames[a]={}),e.pathToNames[a][d]=!0;for(d=0;b=c[d];d++)a in e.requires||(e.requires[a]={}),e.requires[a][b]=!0}};goog.ENABLE_DEBUG_LOADER=!0;
goog.require=function(a){if(!COMPILED&&!goog.isProvided_(a)){if(goog.ENABLE_DEBUG_LOADER){var b=goog.getPathFromDeps_(a);if(b){goog.included_[b]=!0;goog.writeScripts_();return}}a="goog.require could not find: "+a;goog.global.console&&goog.global.console.error(a);throw Error(a);}};goog.basePath="";goog.nullFunction=function(){};goog.identityFunction=function(a,b){return a};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};
goog.addSingletonGetter=function(a){a.getInstance=function(){if(a.instance_)return a.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a);return a.instance_=new a}};goog.instantiatedSingletons_=[];goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;
goog.DEPENDENCIES_ENABLED&&(goog.included_={},goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return"undefined"!=typeof a&&"write"in a},goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document.getElementsByTagName("script"),b=a.length-1;0<=b;--b){var c=a[b].src,d=c.lastIndexOf("?");d=-1==d?c.length:
d;if("base.js"==c.substr(d-7,7)){goog.basePath=c.substr(0,d-7);break}}},goog.importScript_=function(a){var b=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;!goog.dependencies_.written[a]&&b(a)&&(goog.dependencies_.written[a]=!0)},goog.writeScriptTag_=function(a){if(goog.inHtmlDocument_()){var b=goog.global.document;if("complete"==b.readyState){if(/\bdeps.js$/.test(a))return!1;throw Error('Cannot write "'+a+'" after document load');}b.write('<script type="text/javascript" src="'+a+'">\x3c/script>');
return!0}return!1},goog.writeScripts_=function(){function a(e){if(!(e in d.written)){if(!(e in d.visited)&&(d.visited[e]=!0,e in d.requires))for(var f in d.requires[e])if(!goog.isProvided_(f))if(f in d.nameToPath)a(d.nameToPath[f]);else throw Error("Undefined nameToPath for "+f);e in c||(c[e]=!0,b.push(e))}}var b=[],c={},d=goog.dependencies_,e;for(e in goog.included_)d.written[e]||a(e);for(e=0;e<b.length;e++)if(b[e])goog.importScript_(goog.basePath+b[e]);else throw Error("Undefined script input");
},goog.getPathFromDeps_=function(a){return a in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_());
goog.typeOf=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};goog.isNull=function(a){return null===a};goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isString=function(a){return"string"==typeof a};
goog.isBoolean=function(a){return"boolean"==typeof a};goog.isNumber=function(a){return"number"==typeof a};goog.isFunction=function(a){return"function"==goog.typeOf(a)};goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(a){return!!a[goog.UID_PROPERTY_]};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};
goog.UID_PROPERTY_="closure_uid_"+(1E9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();b="array"==b?[]:{};for(var c in a)b[c]=goog.cloneObject(a[c]);return b}return a};goog.bindNative_=function(a,b,c){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}};goog.mixin=function(a,b){for(var c in b)a[c]=b[c]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval)if(null==goog.evalWorksForGlobals_&&(goog.global.eval("var _et_ = 1;"),"undefined"!=typeof goog.global._et_?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1),goog.evalWorksForGlobals_)goog.global.eval(a);else{var b=goog.global.document,c=b.createElement("script");c.type="text/javascript";c.defer=!1;c.appendChild(b.createTextNode(a));b.body.appendChild(c);
b.body.removeChild(c)}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;goog.getCssName=function(a,b){var c=function(a){return goog.cssNameMapping_[a]||a},d=function(a){a=a.split("-");for(var b=[],d=0;d<a.length;d++)b.push(c(a[d]));return b.join("-")};d=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?c:d:function(a){return a};return b?a+"-"+d(b):d(a)};goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};
!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,b){b&&(a=a.replace(/\{\$([^}]+)}/g,function(a,d){return d in b?b[d]:a}));return a};goog.getMsgWithFallback=function(a,b){return a};goog.exportSymbol=function(a,b,c){goog.exportPath_(a,b,c)};goog.exportProperty=function(a,b,c){a[b]=c};
goog.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.base=function(a,c,f){var d=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,d)}};
goog.base=function(a,b,c){var d=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!d)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(d.superClass_)return d.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var e=Array.prototype.slice.call(arguments,2),f=!1,g=a.constructor;g;g=g.superClass_&&g.superClass_.constructor)if(g.prototype[b]===d)f=!0;else if(f)return g.prototype[b].apply(a,
e);if(a[b]===d)return a.constructor.prototype[b].apply(a,e);throw Error("goog.base called from a method of one name to a method of a different name");};goog.scope=function(a){a.call(goog.global)};COMPILED||(goog.global.COMPILED=COMPILED);
goog.defineClass=function(a,b){var c=b.constructor,d=b.statics;c&&c!=Object.prototype.constructor||(c=function(){throw Error("cannot instantiate an interface (no constructor defined).");});c=goog.defineClass.createSealingConstructor_(c,a);a&&goog.inherits(c,a);delete b.constructor;delete b.statics;goog.defineClass.applyProperties_(c.prototype,b);null!=d&&(d instanceof Function?d(c):goog.defineClass.applyProperties_(c,d));return c};goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG;
goog.defineClass.createSealingConstructor_=function(a,b){if(goog.defineClass.SEAL_CLASS_INSTANCES&&Object.seal instanceof Function){if(b&&b.prototype&&b.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_])return a;var c=function(){var b=a.apply(this,arguments)||this;this.constructor===c&&Object.seal(b);return b};return c}return a};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.defineClass.applyProperties_=function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c]);for(var d=0;d<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;d++)c=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[d],Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])};goog.tagUnsealableClass=function(a){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(a.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)};goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable";
var box2d={b2Settings:{}};Object.defineProperty||(Object.defineProperty=function(a,b,c){Object.__defineGetter__&&("get"in c?a.__defineGetter__(b,c.get):"value"in c&&a.__defineGetter__(b,c.value));Object.__defineSetter__&&("set"in c?a.__defineSetter__(b,c.set):"value"in c&&a.__defineSetter__(b,c.value))});box2d.DEBUG=!1;box2d.ENABLE_ASSERTS=box2d.DEBUG;box2d.b2Assert=function(a,b,c){if(box2d.DEBUG&&!a)debugger};box2d.b2_maxFloat=1E37;box2d.b2_epsilon=1E-5;box2d.b2_epsilon_sq=box2d.b2_epsilon*box2d.b2_epsilon;
box2d.b2_pi=Math.PI;box2d.b2_maxManifoldPoints=2;box2d.b2_maxPolygonVertices=8;box2d.b2_aabbExtension=.1;box2d.b2_aabbMultiplier=2;box2d.b2_linearSlop=.008;box2d.b2_angularSlop=2/180*box2d.b2_pi;box2d.b2_polygonRadius=2*box2d.b2_linearSlop;box2d.b2_maxSubSteps=8;box2d.b2_maxTOIContacts=32;box2d.b2_velocityThreshold=1;box2d.b2_maxLinearCorrection=.2;box2d.b2_maxAngularCorrection=8/180*box2d.b2_pi;box2d.b2_maxTranslation=2;box2d.b2_maxTranslationSquared=box2d.b2_maxTranslation*box2d.b2_maxTranslation;
box2d.b2_maxRotation=.5*box2d.b2_pi;box2d.b2_maxRotationSquared=box2d.b2_maxRotation*box2d.b2_maxRotation;box2d.b2_baumgarte=.2;box2d.b2_toiBaumgarte=.75;box2d.b2_timeToSleep=.5;box2d.b2_linearSleepTolerance=.01;box2d.b2_angularSleepTolerance=2/180*box2d.b2_pi;box2d.b2Alloc=function(a){return null};box2d.b2Free=function(a){};box2d.b2Log=function(a){goog.global.console.log.apply(null,arguments)};box2d.b2Version=function(a,b,c){this.major=a||0;this.minor=b||0;this.revision=c||0};
box2d.b2Version.prototype.major=0;box2d.b2Version.prototype.minor=0;box2d.b2Version.prototype.revision=0;box2d.b2Version.prototype.toString=function(){return this.major+"."+this.minor+"."+this.revision};box2d.b2_version=new box2d.b2Version(2,3,0);box2d.b2_changelist=278;box2d.b2ParseInt=function(a){return parseInt(a,10)};box2d.b2ParseUInt=function(a){return box2d.b2Abs(parseInt(a,10))};box2d.b2MakeArray=function(a,b){void 0===a&&(a=0);var c=Array(a);if(void 0!==b)for(var d=0;d<a;++d)c[d]=b(d);return c};
box2d.b2MakeNumberArray=function(a){return box2d.b2MakeArray(a,function(a){return 0})};box2d.b2Math={};box2d.b2_pi_over_180=box2d.b2_pi/180;box2d.b2_180_over_pi=180/box2d.b2_pi;box2d.b2_two_pi=2*box2d.b2_pi;box2d.b2Abs=function(a){return 0>a?-a:a};box2d.b2Min=function(a,b){return a<b?a:b};box2d.b2Max=function(a,b){return a>b?a:b};box2d.b2Clamp=function(a,b,c){return a<b?b:a>c?c:a};box2d.b2Swap=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);var c=a[0];a[0]=b[0];b[0]=c};box2d.b2IsValid=function(a){return isFinite(a)};
box2d.b2Sq=function(a){return a*a};box2d.b2InvSqrt=function(a){return 1/Math.sqrt(a)};box2d.b2Sqrt=function(a){return Math.sqrt(a)};box2d.b2Pow=function(a,b){return Math.pow(a,b)};box2d.b2DegToRad=function(a){return a*box2d.b2_pi_over_180};box2d.b2RadToDeg=function(a){return a*box2d.b2_180_over_pi};box2d.b2Cos=function(a){return Math.cos(a)};box2d.b2Sin=function(a){return Math.sin(a)};box2d.b2Acos=function(a){return Math.acos(a)};box2d.b2Asin=function(a){return Math.asin(a)};
box2d.b2Atan2=function(a,b){return Math.atan2(a,b)};box2d.b2NextPowerOfTwo=function(a){a|=a>>1&2147483647;a|=a>>2&1073741823;a|=a>>4&268435455;a|=a>>8&16777215;return(a|a>>16&65535)+1};box2d.b2IsPowerOfTwo=function(a){return 0<a&&0===(a&a-1)};box2d.b2Random=function(){return 2*Math.random()-1};box2d.b2RandomRange=function(a,b){return(b-a)*Math.random()+a};box2d.b2Vec2=function(a,b){this.x=a||0;this.y=b||0};box2d.b2Vec2.prototype.x=0;box2d.b2Vec2.prototype.y=0;box2d.b2Vec2_zero=new box2d.b2Vec2;
box2d.b2Vec2.ZERO=new box2d.b2Vec2;box2d.b2Vec2.UNITX=new box2d.b2Vec2(1,0);box2d.b2Vec2.UNITY=new box2d.b2Vec2(0,1);box2d.b2Vec2.s_t0=new box2d.b2Vec2;box2d.b2Vec2.s_t1=new box2d.b2Vec2;box2d.b2Vec2.s_t2=new box2d.b2Vec2;box2d.b2Vec2.s_t3=new box2d.b2Vec2;box2d.b2Vec2.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2Vec2})};box2d.b2Vec2.prototype.Clone=function(){return new box2d.b2Vec2(this.x,this.y)};box2d.b2Vec2.prototype.SetZero=function(){this.y=this.x=0;return this};
box2d.b2Vec2.prototype.SetXY=function(a,b){this.x=a;this.y=b;return this};box2d.b2Vec2.prototype.Copy=function(a){this.x=a.x;this.y=a.y;return this};box2d.b2Vec2.prototype.SelfAdd=function(a){this.x+=a.x;this.y+=a.y;return this};box2d.b2Vec2.prototype.SelfAddXY=function(a,b){this.x+=a;this.y+=b;return this};box2d.b2Vec2.prototype.SelfSub=function(a){this.x-=a.x;this.y-=a.y;return this};box2d.b2Vec2.prototype.SelfSubXY=function(a,b){this.x-=a;this.y-=b;return this};
box2d.b2Vec2.prototype.SelfMul=function(a){this.x*=a;this.y*=a;return this};box2d.b2Vec2.prototype.SelfMulAdd=function(a,b){this.x+=a*b.x;this.y+=a*b.y;return this};box2d.b2Vec2.prototype.SelfMulSub=function(a,b){this.x-=a*b.x;this.y-=a*b.y;return this};box2d.b2Vec2.prototype.Dot=function(a){return this.x*a.x+this.y*a.y};box2d.b2Vec2.prototype.Cross=function(a){return this.x*a.y-this.y*a.x};box2d.b2Vec2.prototype.Length=function(){var a=this.x,b=this.y;return Math.sqrt(a*a+b*b)};
box2d.b2Vec2.prototype.GetLength=box2d.b2Vec2.prototype.Length;box2d.b2Vec2.prototype.LengthSquared=function(){var a=this.x,b=this.y;return a*a+b*b};box2d.b2Vec2.prototype.GetLengthSquared=box2d.b2Vec2.prototype.LengthSquared;box2d.b2Vec2.prototype.Normalize=function(){var a=this.GetLength();if(a>=box2d.b2_epsilon){var b=1/a;this.x*=b;this.y*=b}return a};box2d.b2Vec2.prototype.SelfNormalize=function(){var a=this.GetLength();a>=box2d.b2_epsilon&&(a=1/a,this.x*=a,this.y*=a);return this};
box2d.b2Vec2.prototype.SelfRotate=function(a,b){var c=this.x,d=this.y;this.x=a*c-b*d;this.y=b*c+a*d;return this};box2d.b2Vec2.prototype.SelfRotateRadians=function(a){return this.SelfRotate(Math.cos(a),Math.sin(a))};box2d.b2Vec2.prototype.SelfRotateDegrees=function(a){return this.SelfRotateRadians(box2d.b2DegToRad(a))};box2d.b2Vec2.prototype.IsValid=function(){return isFinite(this.x)&&isFinite(this.y)};box2d.b2Vec2.prototype.SelfCrossVS=function(a){var b=this.x;this.x=a*this.y;this.y=-a*b;return this};
box2d.b2Vec2.prototype.SelfCrossSV=function(a){var b=this.x;this.x=-a*this.y;this.y=a*b;return this};box2d.b2Vec2.prototype.SelfMinV=function(a){this.x=box2d.b2Min(this.x,a.x);this.y=box2d.b2Min(this.y,a.y);return this};box2d.b2Vec2.prototype.SelfMaxV=function(a){this.x=box2d.b2Max(this.x,a.x);this.y=box2d.b2Max(this.y,a.y);return this};box2d.b2Vec2.prototype.SelfAbs=function(){this.x=box2d.b2Abs(this.x);this.y=box2d.b2Abs(this.y);return this};
box2d.b2Vec2.prototype.SelfNeg=function(){this.x=-this.x;this.y=-this.y;return this};box2d.b2Vec2.prototype.SelfSkew=function(){var a=this.x;this.x=-this.y;this.y=a;return this};box2d.b2AbsV=function(a,b){b.x=box2d.b2Abs(a.x);b.y=box2d.b2Abs(a.y);return b};box2d.b2MinV=function(a,b,c){c.x=box2d.b2Min(a.x,b.x);c.y=box2d.b2Min(a.y,b.y);return c};box2d.b2MaxV=function(a,b,c){c.x=box2d.b2Max(a.x,b.x);c.y=box2d.b2Max(a.y,b.y);return c};
box2d.b2ClampV=function(a,b,c,d){d.x=box2d.b2Clamp(a.x,b.x,c.x);d.y=box2d.b2Clamp(a.y,b.y,c.y);return d};box2d.b2RotateV=function(a,b,c,d){var e=a.x;a=a.y;d.x=b*e-c*a;d.y=c*e+b*a;return d};box2d.b2RotateRadiansV=function(a,b,c){return box2d.b2RotateV(a,Math.cos(b),Math.sin(b),c)};box2d.b2RotateDegreesV=function(a,b,c){return box2d.b2RotateRadiansV(a,box2d.b2DegToRad(b),c)};box2d.b2DotVV=function(a,b){return a.x*b.x+a.y*b.y};box2d.b2CrossVV=function(a,b){return a.x*b.y-a.y*b.x};
box2d.b2CrossVS=function(a,b,c){var d=a.x;c.x=b*a.y;c.y=-b*d;return c};box2d.b2CrossVOne=function(a,b){var c=a.x;b.x=a.y;b.y=-c;return b};box2d.b2CrossSV=function(a,b,c){var d=b.x;c.x=-a*b.y;c.y=a*d;return c};box2d.b2CrossOneV=function(a,b){var c=a.x;b.x=-a.y;b.y=c;return b};box2d.b2AddVV=function(a,b,c){c.x=a.x+b.x;c.y=a.y+b.y;return c};box2d.b2SubVV=function(a,b,c){c.x=a.x-b.x;c.y=a.y-b.y;return c};box2d.b2MulSV=function(a,b,c){c.x=b.x*a;c.y=b.y*a;return c};
box2d.b2AddVMulSV=function(a,b,c,d){d.x=a.x+b*c.x;d.y=a.y+b*c.y;return d};box2d.b2SubVMulSV=function(a,b,c,d){d.x=a.x-b*c.x;d.y=a.y-b*c.y;return d};box2d.b2AddVCrossSV=function(a,b,c,d){var e=c.x;d.x=a.x-b*c.y;d.y=a.y+b*e;return d};box2d.b2MidVV=function(a,b,c){c.x=.5*(a.x+b.x);c.y=.5*(a.y+b.y);return c};box2d.b2ExtVV=function(a,b,c){c.x=.5*(b.x-a.x);c.y=.5*(b.y-a.y);return c};box2d.b2IsEqualToV=function(a,b){return a.x===b.x&&a.y===b.y};
box2d.b2DistanceVV=function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)};box2d.b2DistanceSquaredVV=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d};box2d.b2NegV=function(a,b){b.x=-a.x;b.y=-a.y;return b};box2d.b2Vec3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};box2d.b2Vec3.prototype.x=0;box2d.b2Vec3.prototype.y=0;box2d.b2Vec3.prototype.z=0;box2d.b2Vec3.ZERO=new box2d.b2Vec3;box2d.b2Vec3.s_t0=new box2d.b2Vec3;
box2d.b2Vec3.prototype.Clone=function(){return new box2d.b2Vec3(this.x,this.y,this.z)};box2d.b2Vec3.prototype.SetZero=function(){this.z=this.y=this.x=0;return this};box2d.b2Vec3.prototype.SetXYZ=function(a,b,c){this.x=a;this.y=b;this.z=c;return this};box2d.b2Vec3.prototype.Copy=function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this};box2d.b2Vec3.prototype.SelfNeg=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this};
box2d.b2Vec3.prototype.SelfAdd=function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this};box2d.b2Vec3.prototype.SelfAddXYZ=function(a,b,c){this.x+=a;this.y+=b;this.z+=c;return this};box2d.b2Vec3.prototype.SelfSub=function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this};box2d.b2Vec3.prototype.SelfSubXYZ=function(a,b,c){this.x-=a;this.y-=b;this.z-=c;return this};box2d.b2Vec3.prototype.SelfMul=function(a){this.x*=a;this.y*=a;this.z*=a;return this};
box2d.b2DotV3V3=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z};box2d.b2CrossV3V3=function(a,b,c){var d=a.x,e=a.y;a=a.z;var f=b.x,g=b.y;b=b.z;c.x=e*b-a*g;c.y=a*f-d*b;c.z=d*g-e*f;return c};box2d.b2Mat22=function(){this.ex=new box2d.b2Vec2(1,0);this.ey=new box2d.b2Vec2(0,1)};box2d.b2Mat22.prototype.ex=null;box2d.b2Mat22.prototype.ey=null;box2d.b2Mat22.IDENTITY=new box2d.b2Mat22;box2d.b2Mat22.prototype.Clone=function(){return(new box2d.b2Mat22).Copy(this)};
box2d.b2Mat22.FromVV=function(a,b){return(new box2d.b2Mat22).SetVV(a,b)};box2d.b2Mat22.FromSSSS=function(a,b,c,d){return(new box2d.b2Mat22).SetSSSS(a,b,c,d)};box2d.b2Mat22.FromAngleRadians=function(a){return(new box2d.b2Mat22).SetAngleRadians(a)};box2d.b2Mat22.prototype.SetSSSS=function(a,b,c,d){this.ex.SetXY(a,c);this.ey.SetXY(b,d);return this};box2d.b2Mat22.prototype.SetVV=function(a,b){this.ex.Copy(a);this.ey.Copy(b);return this};
box2d.b2Mat22.prototype.SetAngle=function(a){var b=Math.cos(a);a=Math.sin(a);this.ex.SetXY(b,a);this.ey.SetXY(-a,b);return this};box2d.b2Mat22.prototype.SetAngleRadians=box2d.b2Mat22.prototype.SetAngle;box2d.b2Mat22.prototype.SetAngleDegrees=function(a){return this.SetAngle(box2d.b2DegToRad(a))};box2d.b2Mat22.prototype.Copy=function(a){this.ex.Copy(a.ex);this.ey.Copy(a.ey);return this};box2d.b2Mat22.prototype.SetIdentity=function(){this.ex.SetXY(1,0);this.ey.SetXY(0,1);return this};
box2d.b2Mat22.prototype.SetZero=function(){this.ex.SetZero();this.ey.SetZero();return this};box2d.b2Mat22.prototype.GetAngle=function(){return Math.atan2(this.ex.y,this.ex.x)};box2d.b2Mat22.prototype.GetAngleRadians=box2d.b2Mat22.prototype.GetAngle;box2d.b2Mat22.prototype.GetInverse=function(a){var b=this.ex.x,c=this.ey.x,d=this.ex.y,e=this.ey.y,f=b*e-c*d;0!==f&&(f=1/f);a.ex.x=f*e;a.ey.x=-f*c;a.ex.y=-f*d;a.ey.y=f*b;return a};
box2d.b2Mat22.prototype.Solve=function(a,b,c){var d=this.ex.x,e=this.ey.x,f=this.ex.y,g=this.ey.y,h=d*g-e*f;0!==h&&(h=1/h);c.x=h*(g*a-e*b);c.y=h*(d*b-f*a);return c};box2d.b2Mat22.prototype.SelfAbs=function(){this.ex.SelfAbs();this.ey.SelfAbs();return this};box2d.b2Mat22.prototype.SelfInv=function(){return this.GetInverse(this)};box2d.b2Mat22.prototype.SelfAddM=function(a){this.ex.SelfAdd(a.ex);this.ey.SelfAdd(a.ey);return this};
box2d.b2Mat22.prototype.SelfSubM=function(a){this.ex.SelfSub(a.ex);this.ey.SelfSub(a.ey);return this};box2d.b2AbsM=function(a,b){var c=a.ex,d=a.ey;b.ex.x=box2d.b2Abs(c.x);b.ex.y=box2d.b2Abs(c.y);b.ey.x=box2d.b2Abs(d.x);b.ey.y=box2d.b2Abs(d.y);return b};box2d.b2MulMV=function(a,b,c){var d=a.ex;a=a.ey;var e=b.x;b=b.y;c.x=d.x*e+a.x*b;c.y=d.y*e+a.y*b;return c};box2d.b2MulTMV=function(a,b,c){var d=a.ex;a=a.ey;var e=b.x;b=b.y;c.x=d.x*e+d.y*b;c.y=a.x*e+a.y*b;return c};
box2d.b2AddMM=function(a,b,c){var d=a.ex;a=a.ey;var e=b.ex;b=b.ey;c.ex.x=d.x+e.x;c.ex.y=d.y+e.y;c.ey.x=a.x+b.x;c.ey.y=a.y+b.y;return c};box2d.b2MulMM=function(a,b,c){var d=a.ex.x,e=a.ex.y,f=a.ey.x;a=a.ey.y;var g=b.ex.x,h=b.ex.y,k=b.ey.x;b=b.ey.y;c.ex.x=d*g+f*h;c.ex.y=e*g+a*h;c.ey.x=d*k+f*b;c.ey.y=e*k+a*b;return c};box2d.b2MulTMM=function(a,b,c){var d=a.ex.x,e=a.ex.y,f=a.ey.x;a=a.ey.y;var g=b.ex.x,h=b.ex.y,k=b.ey.x;b=b.ey.y;c.ex.x=d*g+e*h;c.ex.y=f*g+a*h;c.ey.x=d*k+e*b;c.ey.y=f*k+a*b;return c};
box2d.b2Mat33=function(){this.ex=new box2d.b2Vec3(1,0,0);this.ey=new box2d.b2Vec3(0,1,0);this.ez=new box2d.b2Vec3(0,0,1)};box2d.b2Mat33.prototype.ex=null;box2d.b2Mat33.prototype.ey=null;box2d.b2Mat33.prototype.ez=null;box2d.b2Mat33.IDENTITY=new box2d.b2Mat33;box2d.b2Mat33.prototype.Clone=function(){return(new box2d.b2Mat33).Copy(this)};box2d.b2Mat33.prototype.SetVVV=function(a,b,c){this.ex.Copy(a);this.ey.Copy(b);this.ez.Copy(c);return this};
box2d.b2Mat33.prototype.Copy=function(a){this.ex.Copy(a.ex);this.ey.Copy(a.ey);this.ez.Copy(a.ez);return this};box2d.b2Mat33.prototype.SetIdentity=function(){this.ex.SetXYZ(1,0,0);this.ey.SetXYZ(0,1,0);this.ez.SetXYZ(0,0,1);return this};box2d.b2Mat33.prototype.SetZero=function(){this.ex.SetZero();this.ey.SetZero();this.ez.SetZero();return this};box2d.b2Mat33.prototype.SelfAddM=function(a){this.ex.SelfAdd(a.ex);this.ey.SelfAdd(a.ey);this.ez.SelfAdd(a.ez);return this};
box2d.b2Mat33.prototype.Solve33=function(a,b,c,d){var e=this.ex.x,f=this.ex.y,g=this.ex.z,h=this.ey.x,k=this.ey.y,l=this.ey.z,m=this.ez.x,n=this.ez.y,p=this.ez.z,q=e*(k*p-l*n)+f*(l*m-h*p)+g*(h*n-k*m);0!==q&&(q=1/q);d.x=q*(a*(k*p-l*n)+b*(l*m-h*p)+c*(h*n-k*m));d.y=q*(e*(b*p-c*n)+f*(c*m-a*p)+g*(a*n-b*m));d.z=q*(e*(k*c-l*b)+f*(l*a-h*c)+g*(h*b-k*a));return d};
box2d.b2Mat33.prototype.Solve22=function(a,b,c){var d=this.ex.x,e=this.ey.x,f=this.ex.y,g=this.ey.y,h=d*g-e*f;0!==h&&(h=1/h);c.x=h*(g*a-e*b);c.y=h*(d*b-f*a);return c};box2d.b2Mat33.prototype.GetInverse22=function(a){var b=this.ex.x,c=this.ey.x,d=this.ex.y,e=this.ey.y,f=b*e-c*d;0!==f&&(f=1/f);a.ex.x=f*e;a.ey.x=-f*c;a.ex.z=0;a.ex.y=-f*d;a.ey.y=f*b;a.ey.z=0;a.ez.x=0;a.ez.y=0;a.ez.z=0};
box2d.b2Mat33.prototype.GetSymInverse33=function(a){var b=box2d.b2DotV3V3(this.ex,box2d.b2CrossV3V3(this.ey,this.ez,box2d.b2Vec3.s_t0));0!==b&&(b=1/b);var c=this.ex.x,d=this.ey.x,e=this.ez.x,f=this.ey.y,g=this.ez.y,h=this.ez.z;a.ex.x=b*(f*h-g*g);a.ex.y=b*(e*g-d*h);a.ex.z=b*(d*g-e*f);a.ey.x=a.ex.y;a.ey.y=b*(c*h-e*e);a.ey.z=b*(e*d-c*g);a.ez.x=a.ex.z;a.ez.y=a.ey.z;a.ez.z=b*(c*f-d*d)};
box2d.b2MulM33V3=function(a,b,c){var d=b.x,e=b.y;b=b.z;c.x=a.ex.x*d+a.ey.x*e+a.ez.x*b;c.y=a.ex.y*d+a.ey.y*e+a.ez.y*b;c.z=a.ex.z*d+a.ey.z*e+a.ez.z*b;return c};box2d.b2MulM33XYZ=function(a,b,c,d,e){e.x=a.ex.x*b+a.ey.x*c+a.ez.x*d;e.y=a.ex.y*b+a.ey.y*c+a.ez.y*d;e.z=a.ex.z*b+a.ey.z*c+a.ez.z*d;return e};box2d.b2MulM33V2=function(a,b,c){var d=b.x;b=b.y;c.x=a.ex.x*d+a.ey.x*b;c.y=a.ex.y*d+a.ey.y*b;return c};box2d.b2MulM33XY=function(a,b,c,d){d.x=a.ex.x*b+a.ey.x*c;d.y=a.ex.y*b+a.ey.y*c;return d};
box2d.b2Rot=function(a){a&&(this.angle=a,this.s=Math.sin(a),this.c=Math.cos(a))};box2d.b2Rot.prototype.angle=0;box2d.b2Rot.prototype.s=0;box2d.b2Rot.prototype.c=1;box2d.b2Rot.IDENTITY=new box2d.b2Rot;box2d.b2Rot.prototype.Clone=function(){return(new box2d.b2Rot).Copy(this)};box2d.b2Rot.prototype.Copy=function(a){this.angle=a.angle;this.s=a.s;this.c=a.c;return this};box2d.b2Rot.prototype.SetAngle=function(a){this.angle!==a&&(this.angle=a,this.s=Math.sin(a),this.c=Math.cos(a));return this};
box2d.b2Rot.prototype.SetAngleRadians=box2d.b2Rot.prototype.SetAngle;box2d.b2Rot.prototype.SetAngleDegrees=function(a){return this.SetAngle(box2d.b2DegToRad(a))};box2d.b2Rot.prototype.SetIdentity=function(){this.s=this.angle=0;this.c=1;return this};box2d.b2Rot.prototype.GetAngle=function(){return this.angle};box2d.b2Rot.prototype.GetAngleRadians=box2d.b2Rot.prototype.GetAngle;box2d.b2Rot.prototype.GetAngleDegrees=function(){return box2d.b2RadToDeg(this.GetAngle())};
box2d.b2Rot.prototype.GetXAxis=function(a){a.x=this.c;a.y=this.s;return a};box2d.b2Rot.prototype.GetYAxis=function(a){a.x=-this.s;a.y=this.c;return a};box2d.b2MulRR=function(a,b,c){var d=a.c,e=a.s,f=b.c,g=b.s;c.s=e*f+d*g;c.c=d*f-e*g;for(c.angle=a.angle+b.angle;c.angle<-box2d.b2_pi;)c.angle+=box2d.b2_two_pi;for(;c.angle>=box2d.b2_pi;)c.angle-=box2d.b2_two_pi;return c};
box2d.b2MulTRR=function(a,b,c){var d=a.c,e=a.s,f=b.c,g=b.s;c.s=d*g-e*f;c.c=d*f+e*g;for(c.angle=a.angle-b.angle;c.angle<-box2d.b2_pi;)c.angle+=box2d.b2_two_pi;for(;c.angle>=box2d.b2_pi;)c.angle-=box2d.b2_two_pi;return c};box2d.b2MulRV=function(a,b,c){var d=a.c;a=a.s;var e=b.x;b=b.y;c.x=d*e-a*b;c.y=a*e+d*b;return c};box2d.b2MulTRV=function(a,b,c){var d=a.c;a=a.s;var e=b.x;b=b.y;c.x=d*e+a*b;c.y=-a*e+d*b;return c};box2d.b2Transform=function(){this.p=new box2d.b2Vec2;this.q=new box2d.b2Rot};
box2d.b2Transform.prototype.p=null;box2d.b2Transform.prototype.q=null;box2d.b2Transform.IDENTITY=new box2d.b2Transform;box2d.b2Transform.prototype.Clone=function(){return(new box2d.b2Transform).Copy(this)};box2d.b2Transform.prototype.Copy=function(a){this.p.Copy(a.p);this.q.Copy(a.q);return this};box2d.b2Transform.prototype.SetIdentity=function(){this.p.SetZero();this.q.SetIdentity();return this};box2d.b2Transform.prototype.SetPositionRotation=function(a,b){this.p.Copy(a);this.q.Copy(b);return this};
box2d.b2Transform.prototype.SetPositionAngleRadians=function(a,b){this.p.Copy(a);this.q.SetAngleRadians(b);return this};box2d.b2Transform.prototype.SetPosition=function(a){this.p.Copy(a);return this};box2d.b2Transform.prototype.SetPositionXY=function(a,b){this.p.SetXY(a,b);return this};box2d.b2Transform.prototype.SetRotation=function(a){this.q.Copy(a);return this};box2d.b2Transform.prototype.SetRotationAngleRadians=function(a){this.q.SetAngleRadians(a);return this};
box2d.b2Transform.prototype.GetPosition=function(){return this.p};box2d.b2Transform.prototype.GetRotation=function(){return this.q};box2d.b2Transform.prototype.GetRotationAngle=function(){return this.q.GetAngle()};box2d.b2Transform.prototype.GetRotationAngleRadians=box2d.b2Transform.prototype.GetRotationAngle;box2d.b2Transform.prototype.GetAngle=function(){return this.q.GetAngle()};box2d.b2Transform.prototype.GetAngleRadians=box2d.b2Transform.prototype.GetAngle;
box2d.b2MulXV=function(a,b,c){var d=a.q.c,e=a.q.s,f=b.x;b=b.y;c.x=d*f-e*b+a.p.x;c.y=e*f+d*b+a.p.y;return c};box2d.b2MulTXV=function(a,b,c){var d=a.q.c,e=a.q.s,f=b.x-a.p.x;a=b.y-a.p.y;c.x=d*f+e*a;c.y=-e*f+d*a;return c};box2d.b2MulXX=function(a,b,c){box2d.b2MulRR(a.q,b.q,c.q);box2d.b2AddVV(box2d.b2MulRV(a.q,b.p,c.p),a.p,c.p);return c};box2d.b2MulTXX=function(a,b,c){box2d.b2MulTRR(a.q,b.q,c.q);box2d.b2MulTRV(a.q,box2d.b2SubVV(b.p,a.p,c.p),c.p);return c};
box2d.b2Sweep=function(){this.localCenter=new box2d.b2Vec2;this.c0=new box2d.b2Vec2;this.c=new box2d.b2Vec2};box2d.b2Sweep.prototype.localCenter=null;box2d.b2Sweep.prototype.c0=null;box2d.b2Sweep.prototype.c=null;box2d.b2Sweep.prototype.a0=0;box2d.b2Sweep.prototype.a=0;box2d.b2Sweep.prototype.alpha0=0;box2d.b2Sweep.prototype.Clone=function(){return(new box2d.b2Sweep).Copy(this)};
box2d.b2Sweep.prototype.Copy=function(a){this.localCenter.Copy(a.localCenter);this.c0.Copy(a.c0);this.c.Copy(a.c);this.a0=a.a0;this.a=a.a;this.alpha0=a.alpha0;return this};box2d.b2Sweep.prototype.GetTransform=function(a,b){var c=1-b;a.p.x=c*this.c0.x+b*this.c.x;a.p.y=c*this.c0.y+b*this.c.y;a.q.SetAngleRadians(c*this.a0+b*this.a);a.p.SelfSub(box2d.b2MulRV(a.q,this.localCenter,box2d.b2Vec2.s_t0));return a};
box2d.b2Sweep.prototype.Advance=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(1>this.alpha0);var b=(a-this.alpha0)/(1-this.alpha0);this.c0.x+=b*(this.c.x-this.c0.x);this.c0.y+=b*(this.c.y-this.c0.y);this.a0+=b*(this.a-this.a0);this.alpha0=a};box2d.b2Sweep.prototype.Normalize=function(){var a=box2d.b2_two_pi*Math.floor(this.a0/box2d.b2_two_pi);this.a0-=a;this.a-=a};box2d.b2ControllerEdge=function(){};box2d.b2ControllerEdge.prototype.controller=null;box2d.b2ControllerEdge.prototype.body=null;
box2d.b2ControllerEdge.prototype.prevBody=null;box2d.b2ControllerEdge.prototype.nextBody=null;box2d.b2ControllerEdge.prototype.prevController=null;box2d.b2ControllerEdge.prototype.nextController=null;box2d.b2Controller=function(){};box2d.b2Controller.prototype.m_world=null;box2d.b2Controller.prototype.m_bodyList=null;box2d.b2Controller.prototype.m_bodyCount=0;box2d.b2Controller.prototype.m_prev=null;box2d.b2Controller.prototype.m_next=null;box2d.b2Controller.prototype.Step=function(a){};
box2d.b2Controller.prototype.Draw=function(a){};box2d.b2Controller.prototype.GetNext=function(){return this.m_next};box2d.b2Controller.prototype.GetPrev=function(){return this.m_prev};box2d.b2Controller.prototype.GetWorld=function(){return this.m_world};box2d.b2Controller.prototype.GetBodyList=function(){return this.m_bodyList};
box2d.b2Controller.prototype.AddBody=function(a){var b=new box2d.b2ControllerEdge;b.body=a;b.controller=this;b.nextBody=this.m_bodyList;b.prevBody=null;this.m_bodyList&&(this.m_bodyList.prevBody=b);this.m_bodyList=b;++this.m_bodyCount;b.nextController=a.m_controllerList;b.prevController=null;a.m_controllerList&&(a.m_controllerList.prevController=b);a.m_controllerList=b;++a.m_controllerCount};
box2d.b2Controller.prototype.RemoveBody=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_bodyCount);for(var b=this.m_bodyList;b&&b.body!==a;)b=b.nextBody;box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==b);b.prevBody&&(b.prevBody.nextBody=b.nextBody);b.nextBody&&(b.nextBody.prevBody=b.prevBody);this.m_bodyList===b&&(this.m_bodyList=b.nextBody);--this.m_bodyCount;b.nextController&&(b.nextController.prevController=b.prevController);b.prevController&&(b.prevController.nextController=b.nextController);
a.m_controllerList===b&&(a.m_controllerList=b.nextController);--a.m_controllerCount};box2d.b2Controller.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body);this.m_bodyCount=0};box2d.b2ConstantAccelController=function(){box2d.b2Controller.call(this);this.A=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2ConstantAccelController,box2d.b2Controller);box2d.b2ConstantAccelController.prototype.A=null;
box2d.b2ConstantAccelController.prototype.Step=function(a){a=box2d.b2MulSV(a.dt,this.A,box2d.b2ConstantAccelController.prototype.Step.s_dtA);for(var b=this.m_bodyList;b;b=b.nextBody){var c=b.body;c.IsAwake()&&c.SetLinearVelocity(box2d.b2AddVV(c.GetLinearVelocity(),a,box2d.b2Vec2.s_t0))}};box2d.b2ConstantAccelController.prototype.Step.s_dtA=new box2d.b2Vec2;
box2d.b2JointType={e_unknownJoint:0,e_revoluteJoint:1,e_prismaticJoint:2,e_distanceJoint:3,e_pulleyJoint:4,e_mouseJoint:5,e_gearJoint:6,e_wheelJoint:7,e_weldJoint:8,e_frictionJoint:9,e_ropeJoint:10,e_motorJoint:11,e_areaJoint:12};goog.exportProperty(box2d.b2JointType,"e_unknownJoint",box2d.b2JointType.e_unknownJoint);goog.exportProperty(box2d.b2JointType,"e_revoluteJoint",box2d.b2JointType.e_revoluteJoint);goog.exportProperty(box2d.b2JointType,"e_prismaticJoint",box2d.b2JointType.e_prismaticJoint);
goog.exportProperty(box2d.b2JointType,"e_distanceJoint",box2d.b2JointType.e_distanceJoint);goog.exportProperty(box2d.b2JointType,"e_pulleyJoint",box2d.b2JointType.e_pulleyJoint);goog.exportProperty(box2d.b2JointType,"e_mouseJoint",box2d.b2JointType.e_mouseJoint);goog.exportProperty(box2d.b2JointType,"e_gearJoint",box2d.b2JointType.e_gearJoint);goog.exportProperty(box2d.b2JointType,"e_wheelJoint",box2d.b2JointType.e_wheelJoint);goog.exportProperty(box2d.b2JointType,"e_weldJoint",box2d.b2JointType.e_weldJoint);
goog.exportProperty(box2d.b2JointType,"e_frictionJoint",box2d.b2JointType.e_frictionJoint);goog.exportProperty(box2d.b2JointType,"e_ropeJoint",box2d.b2JointType.e_ropeJoint);goog.exportProperty(box2d.b2JointType,"e_motorJoint",box2d.b2JointType.e_motorJoint);goog.exportProperty(box2d.b2JointType,"e_areaJoint",box2d.b2JointType.e_areaJoint);box2d.b2LimitState={e_inactiveLimit:0,e_atLowerLimit:1,e_atUpperLimit:2,e_equalLimits:3};goog.exportProperty(box2d.b2LimitState,"e_inactiveLimit",box2d.b2LimitState.e_inactiveLimit);
goog.exportProperty(box2d.b2LimitState,"e_atLowerLimit",box2d.b2LimitState.e_atLowerLimit);goog.exportProperty(box2d.b2LimitState,"e_atUpperLimit",box2d.b2LimitState.e_atUpperLimit);goog.exportProperty(box2d.b2LimitState,"e_equalLimits",box2d.b2LimitState.e_equalLimits);box2d.b2Jacobian=function(){this.linear=new box2d.b2Vec2};box2d.b2Jacobian.prototype.linear=null;box2d.b2Jacobian.prototype.angularA=0;box2d.b2Jacobian.prototype.angularB=0;
box2d.b2Jacobian.prototype.SetZero=function(){this.linear.SetZero();this.angularB=this.angularA=0;return this};box2d.b2Jacobian.prototype.Set=function(a,b,c){this.linear.Copy(a);this.angularA=b;this.angularB=c;return this};box2d.b2JointEdge=function(){};box2d.b2JointEdge.prototype.other=null;box2d.b2JointEdge.prototype.joint=null;box2d.b2JointEdge.prototype.prev=null;box2d.b2JointEdge.prototype.next=null;box2d.b2JointDef=function(a){this.type=a};box2d.b2JointDef.prototype.type=box2d.b2JointType.e_unknownJoint;
box2d.b2JointDef.prototype.userData=null;box2d.b2JointDef.prototype.bodyA=null;box2d.b2JointDef.prototype.bodyB=null;box2d.b2JointDef.prototype.collideConnected=!1;box2d.b2Joint=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.bodyA!==a.bodyB);this.m_type=a.type;this.m_edgeA=new box2d.b2JointEdge;this.m_edgeB=new box2d.b2JointEdge;this.m_bodyA=a.bodyA;this.m_bodyB=a.bodyB;this.m_collideConnected=a.collideConnected;this.m_userData=a.userData};box2d.b2Joint.prototype.m_type=box2d.b2JointType.e_unknownJoint;
box2d.b2Joint.prototype.m_prev=null;box2d.b2Joint.prototype.m_next=null;box2d.b2Joint.prototype.m_edgeA=null;box2d.b2Joint.prototype.m_edgeB=null;box2d.b2Joint.prototype.m_bodyA=null;box2d.b2Joint.prototype.m_bodyB=null;box2d.b2Joint.prototype.m_index=0;box2d.b2Joint.prototype.m_islandFlag=!1;box2d.b2Joint.prototype.m_collideConnected=!1;box2d.b2Joint.prototype.m_userData=null;box2d.b2Joint.prototype.GetAnchorA=function(a){return a.SetZero()};box2d.b2Joint.prototype.GetAnchorB=function(a){return a.SetZero()};
box2d.b2Joint.prototype.GetReactionForce=function(a,b){return b.SetZero()};box2d.b2Joint.prototype.GetReactionTorque=function(a){return 0};box2d.b2Joint.prototype.InitVelocityConstraints=function(a){};box2d.b2Joint.prototype.SolveVelocityConstraints=function(a){};box2d.b2Joint.prototype.SolvePositionConstraints=function(a){return!1};box2d.b2Joint.prototype.GetType=function(){return this.m_type};box2d.b2Joint.prototype.GetBodyA=function(){return this.m_bodyA};box2d.b2Joint.prototype.GetBodyB=function(){return this.m_bodyB};
box2d.b2Joint.prototype.GetNext=function(){return this.m_next};box2d.b2Joint.prototype.GetUserData=function(){return this.m_userData};box2d.b2Joint.prototype.SetUserData=function(a){this.m_userData=a};box2d.b2Joint.prototype.GetCollideConnected=function(){return this.m_collideConnected};box2d.b2Joint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("// Dump is not supported for this joint type.\n")};box2d.b2Joint.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()};
box2d.b2Joint.prototype.ShiftOrigin=function(a){};box2d.b2RevoluteJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_revoluteJoint);this.localAnchorA=new box2d.b2Vec2(0,0);this.localAnchorB=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2RevoluteJointDef,box2d.b2JointDef);box2d.b2RevoluteJointDef.prototype.localAnchorA=null;box2d.b2RevoluteJointDef.prototype.localAnchorB=null;box2d.b2RevoluteJointDef.prototype.referenceAngle=0;box2d.b2RevoluteJointDef.prototype.enableLimit=!1;
box2d.b2RevoluteJointDef.prototype.lowerAngle=0;box2d.b2RevoluteJointDef.prototype.upperAngle=0;box2d.b2RevoluteJointDef.prototype.enableMotor=!1;box2d.b2RevoluteJointDef.prototype.motorSpeed=0;box2d.b2RevoluteJointDef.prototype.maxMotorTorque=0;box2d.b2RevoluteJointDef.prototype.Initialize=function(a,b,c){this.bodyA=a;this.bodyB=b;this.bodyA.GetLocalPoint(c,this.localAnchorA);this.bodyB.GetLocalPoint(c,this.localAnchorB);this.referenceAngle=this.bodyB.GetAngleRadians()-this.bodyA.GetAngleRadians()};
box2d.b2RevoluteJoint=function(a){box2d.b2Joint.call(this,a);this.m_localAnchorA=new box2d.b2Vec2;this.m_localAnchorB=new box2d.b2Vec2;this.m_impulse=new box2d.b2Vec3;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_mass=new box2d.b2Mat33;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat22;this.m_localAnchorA.Copy(a.localAnchorA);
this.m_localAnchorB.Copy(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=0;this.m_lowerAngle=a.lowerAngle;this.m_upperAngle=a.upperAngle;this.m_maxMotorTorque=a.maxMotorTorque;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=box2d.b2LimitState.e_inactiveLimit};goog.inherits(box2d.b2RevoluteJoint,box2d.b2Joint);box2d.b2RevoluteJoint.prototype.m_localAnchorA=null;
box2d.b2RevoluteJoint.prototype.m_localAnchorB=null;box2d.b2RevoluteJoint.prototype.m_impulse=null;box2d.b2RevoluteJoint.prototype.m_motorImpulse=0;box2d.b2RevoluteJoint.prototype.m_enableMotor=!1;box2d.b2RevoluteJoint.prototype.m_maxMotorTorque=0;box2d.b2RevoluteJoint.prototype.m_motorSpeed=0;box2d.b2RevoluteJoint.prototype.m_enableLimit=!1;box2d.b2RevoluteJoint.prototype.m_referenceAngle=0;box2d.b2RevoluteJoint.prototype.m_lowerAngle=0;box2d.b2RevoluteJoint.prototype.m_upperAngle=0;
box2d.b2RevoluteJoint.prototype.m_indexA=0;box2d.b2RevoluteJoint.prototype.m_indexB=0;box2d.b2RevoluteJoint.prototype.m_rA=null;box2d.b2RevoluteJoint.prototype.m_rB=null;box2d.b2RevoluteJoint.prototype.m_localCenterA=null;box2d.b2RevoluteJoint.prototype.m_localCenterB=null;box2d.b2RevoluteJoint.prototype.m_invMassA=0;box2d.b2RevoluteJoint.prototype.m_invMassB=0;box2d.b2RevoluteJoint.prototype.m_invIA=0;box2d.b2RevoluteJoint.prototype.m_invIB=0;box2d.b2RevoluteJoint.prototype.m_mass=null;
box2d.b2RevoluteJoint.prototype.m_motorMass=0;box2d.b2RevoluteJoint.prototype.m_limitState=box2d.b2LimitState.e_inactiveLimit;box2d.b2RevoluteJoint.prototype.m_qA=null;box2d.b2RevoluteJoint.prototype.m_qB=null;box2d.b2RevoluteJoint.prototype.m_lalcA=null;box2d.b2RevoluteJoint.prototype.m_lalcB=null;box2d.b2RevoluteJoint.prototype.m_K=null;
box2d.b2RevoluteJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexA].a,c=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,
e=a.positions[this.m_indexB].a,f=a.velocities[this.m_indexB].v,g=a.velocities[this.m_indexB].w,h=this.m_qA.SetAngleRadians(b),k=this.m_qB.SetAngleRadians(e);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2MulRV(h,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2MulRV(k,this.m_lalcB,this.m_rB);h=this.m_invMassA;k=this.m_invMassB;var l=this.m_invIA,m=this.m_invIB,n=0===l+m;this.m_mass.ex.x=h+k+this.m_rA.y*this.m_rA.y*l+this.m_rB.y*
this.m_rB.y*m;this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*l-this.m_rB.y*this.m_rB.x*m;this.m_mass.ez.x=-this.m_rA.y*l-this.m_rB.y*m;this.m_mass.ex.y=this.m_mass.ey.x;this.m_mass.ey.y=h+k+this.m_rA.x*this.m_rA.x*l+this.m_rB.x*this.m_rB.x*m;this.m_mass.ez.y=this.m_rA.x*l+this.m_rB.x*m;this.m_mass.ex.z=this.m_mass.ez.x;this.m_mass.ey.z=this.m_mass.ez.y;this.m_mass.ez.z=l+m;this.m_motorMass=l+m;0<this.m_motorMass&&(this.m_motorMass=1/this.m_motorMass);if(!1===this.m_enableMotor||n)this.m_motorImpulse=0;
this.m_enableLimit&&!1===n?(b=e-b-this.m_referenceAngle,box2d.b2Abs(this.m_upperAngle-this.m_lowerAngle)<2*box2d.b2_angularSlop?this.m_limitState=box2d.b2LimitState.e_equalLimits:b<=this.m_lowerAngle?(this.m_limitState!==box2d.b2LimitState.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=box2d.b2LimitState.e_atLowerLimit):b>=this.m_upperAngle?(this.m_limitState!==box2d.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=box2d.b2LimitState.e_atUpperLimit):(this.m_limitState=box2d.b2LimitState.e_inactiveLimit,
this.m_impulse.z=0)):this.m_limitState=box2d.b2LimitState.e_inactiveLimit;a.step.warmStarting?(this.m_impulse.SelfMul(a.step.dtRatio),this.m_motorImpulse*=a.step.dtRatio,b=box2d.b2RevoluteJoint.prototype.InitVelocityConstraints.s_P.SetXY(this.m_impulse.x,this.m_impulse.y),c.SelfMulSub(h,b),d-=l*(box2d.b2CrossVV(this.m_rA,b)+this.m_motorImpulse+this.m_impulse.z),f.SelfMulAdd(k,b),g+=m*(box2d.b2CrossVV(this.m_rB,b)+this.m_motorImpulse+this.m_impulse.z)):(this.m_impulse.SetZero(),this.m_motorImpulse=
0);a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=g};box2d.b2RevoluteJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,c=a.velocities[this.m_indexA].w,d=a.velocities[this.m_indexB].v,e=a.velocities[this.m_indexB].w,f=this.m_invMassA,g=this.m_invMassB,h=this.m_invIA,k=this.m_invIB,l=0===h+k;if(this.m_enableMotor&&this.m_limitState!==box2d.b2LimitState.e_equalLimits&&!1===l){var m=e-c-this.m_motorSpeed;m*=-this.m_motorMass;var n=this.m_motorImpulse,p=a.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+
m,-p,p);m=this.m_motorImpulse-n;c-=h*m;e+=k*m}this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit&&!1===l?(l=box2d.b2SubVV(box2d.b2AddVCrossSV(d,e,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(b,c,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot1),m=this.m_mass.Solve33(l.x,l.y,e-c,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse3).SelfNeg(),this.m_limitState===box2d.b2LimitState.e_equalLimits?this.m_impulse.SelfAdd(m):
this.m_limitState===box2d.b2LimitState.e_atLowerLimit?(n=this.m_impulse.z+m.z,0>n?(n=-l.x+this.m_impulse.z*this.m_mass.ez.x,l=-l.y+this.m_impulse.z*this.m_mass.ez.y,l=this.m_mass.Solve22(n,l,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced),m.x=l.x,m.y=l.y,m.z=-this.m_impulse.z,this.m_impulse.x+=l.x,this.m_impulse.y+=l.y,this.m_impulse.z=0):this.m_impulse.SelfAdd(m)):this.m_limitState===box2d.b2LimitState.e_atUpperLimit&&(n=this.m_impulse.z+m.z,0<n?(n=-l.x+this.m_impulse.z*this.m_mass.ez.x,
l=-l.y+this.m_impulse.z*this.m_mass.ez.y,l=this.m_mass.Solve22(n,l,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced),m.x=l.x,m.y=l.y,m.z=-this.m_impulse.z,this.m_impulse.x+=l.x,this.m_impulse.y+=l.y,this.m_impulse.z=0):this.m_impulse.SelfAdd(m)),l=box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_P.SetXY(m.x,m.y),b.SelfMulSub(f,l),c-=h*(box2d.b2CrossVV(this.m_rA,l)+m.z),d.SelfMulAdd(g,l),e+=k*(box2d.b2CrossVV(this.m_rB,l)+m.z)):(m=box2d.b2SubVV(box2d.b2AddVCrossSV(d,e,this.m_rB,
box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(b,c,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot),m=this.m_mass.Solve22(-m.x,-m.y,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse2),this.m_impulse.x+=m.x,this.m_impulse.y+=m.y,b.SelfMulSub(f,m),c-=h*box2d.b2CrossVV(this.m_rA,m),d.SelfMulAdd(g,m),e+=k*box2d.b2CrossVV(this.m_rB,m));a.velocities[this.m_indexA].w=c;a.velocities[this.m_indexB].w=e};
box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot1=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse3=new box2d.b2Vec3;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse2=new box2d.b2Vec2;
box2d.b2RevoluteJoint.prototype.SolvePositionConstraints=function(a){var b=a.positions[this.m_indexA].c,c=a.positions[this.m_indexA].a,d=a.positions[this.m_indexB].c,e=a.positions[this.m_indexB].a,f=this.m_qA.SetAngleRadians(c),g=this.m_qB.SetAngleRadians(e),h=0,k=0===this.m_invIA+this.m_invIB;if(this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit&&!1===k){k=e-c-this.m_referenceAngle;var l=0;this.m_limitState===box2d.b2LimitState.e_equalLimits?(k=box2d.b2Clamp(k-this.m_lowerAngle,
-box2d.b2_maxAngularCorrection,box2d.b2_maxAngularCorrection),l=-this.m_motorMass*k,h=box2d.b2Abs(k)):this.m_limitState===box2d.b2LimitState.e_atLowerLimit?(k-=this.m_lowerAngle,h=-k,k=box2d.b2Clamp(k+box2d.b2_angularSlop,-box2d.b2_maxAngularCorrection,0),l=-this.m_motorMass*k):this.m_limitState===box2d.b2LimitState.e_atUpperLimit&&(h=k-=this.m_upperAngle,k=box2d.b2Clamp(k-box2d.b2_angularSlop,0,box2d.b2_maxAngularCorrection),l=-this.m_motorMass*k);c-=this.m_invIA*l;e+=this.m_invIB*l}f.SetAngleRadians(c);
g.SetAngleRadians(e);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);f=box2d.b2MulRV(f,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);l=box2d.b2MulRV(g,this.m_lalcB,this.m_rB);k=box2d.b2SubVV(box2d.b2AddVV(d,l,box2d.b2Vec2.s_t0),box2d.b2AddVV(b,f,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_C);g=k.GetLength();var m=this.m_invMassA,n=this.m_invMassB,p=this.m_invIA,q=this.m_invIB,r=this.m_K;r.ex.x=m+n+
p*f.y*f.y+q*l.y*l.y;r.ex.y=-p*f.x*f.y-q*l.x*l.y;r.ey.x=r.ex.y;r.ey.y=m+n+p*f.x*f.x+q*l.x*l.x;k=r.Solve(k.x,k.y,box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_impulse).SelfNeg();b.SelfMulSub(m,k);c-=p*box2d.b2CrossVV(f,k);d.SelfMulAdd(n,k);e+=q*box2d.b2CrossVV(l,k);a.positions[this.m_indexA].a=c;a.positions[this.m_indexB].a=e;return g<=box2d.b2_linearSlop&&h<=box2d.b2_angularSlop};box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_C=new box2d.b2Vec2;
box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};box2d.b2RevoluteJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};box2d.b2RevoluteJoint.prototype.GetReactionForce=function(a,b){return b.SetXY(a*this.m_impulse.x,a*this.m_impulse.y)};box2d.b2RevoluteJoint.prototype.GetReactionTorque=function(a){return a*this.m_impulse.z};
box2d.b2RevoluteJoint.prototype.GetLocalAnchorA=function(a){return a.Copy(this.m_localAnchorA)};box2d.b2RevoluteJoint.prototype.GetLocalAnchorB=function(a){return a.Copy(this.m_localAnchorB)};box2d.b2RevoluteJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle};box2d.b2RevoluteJoint.prototype.GetJointAngleRadians=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle};
box2d.b2RevoluteJoint.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity};box2d.b2RevoluteJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor};box2d.b2RevoluteJoint.prototype.EnableMotor=function(a){this.m_enableMotor!==a&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=a)};box2d.b2RevoluteJoint.prototype.GetMotorTorque=function(a){return a*this.m_motorImpulse};
box2d.b2RevoluteJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};box2d.b2RevoluteJoint.prototype.SetMaxMotorTorque=function(a){this.m_maxMotorTorque=a};box2d.b2RevoluteJoint.prototype.GetMaxMotorTorque=function(){return this.m_maxMotorTorque};box2d.b2RevoluteJoint.prototype.IsLimitEnabled=function(){return this.m_enableLimit};
box2d.b2RevoluteJoint.prototype.EnableLimit=function(a){a!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=a,this.m_impulse.z=0)};box2d.b2RevoluteJoint.prototype.GetLowerLimit=function(){return this.m_lowerAngle};box2d.b2RevoluteJoint.prototype.GetUpperLimit=function(){return this.m_upperAngle};
box2d.b2RevoluteJoint.prototype.SetLimits=function(a,b){if(a!==this.m_lowerAngle||b!==this.m_upperAngle)this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=a,this.m_upperAngle=b};box2d.b2RevoluteJoint.prototype.SetMotorSpeed=function(a){this.m_motorSpeed!==a&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=a)};
box2d.b2RevoluteJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2RevoluteJointDef*/ var jd = new box2d.b2RevoluteJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",
this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle);box2d.b2Log("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false");box2d.b2Log("  jd.lowerAngle = %.15f;\n",this.m_lowerAngle);box2d.b2Log("  jd.upperAngle = %.15f;\n",this.m_upperAngle);box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false");box2d.b2Log("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed);box2d.b2Log("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque);
box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};box2d.b2PrismaticJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_prismaticJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2;this.localAxisA=new box2d.b2Vec2(1,0)};goog.inherits(box2d.b2PrismaticJointDef,box2d.b2JointDef);box2d.b2PrismaticJointDef.prototype.localAnchorA=null;box2d.b2PrismaticJointDef.prototype.localAnchorB=null;box2d.b2PrismaticJointDef.prototype.localAxisA=null;
box2d.b2PrismaticJointDef.prototype.referenceAngle=0;box2d.b2PrismaticJointDef.prototype.enableLimit=!1;box2d.b2PrismaticJointDef.prototype.lowerTranslation=0;box2d.b2PrismaticJointDef.prototype.upperTranslation=0;box2d.b2PrismaticJointDef.prototype.enableMotor=!1;box2d.b2PrismaticJointDef.prototype.maxMotorForce=0;box2d.b2PrismaticJointDef.prototype.motorSpeed=0;
box2d.b2PrismaticJointDef.prototype.Initialize=function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.bodyA.GetLocalPoint(c,this.localAnchorA);this.bodyB.GetLocalPoint(c,this.localAnchorB);this.bodyA.GetLocalVector(d,this.localAxisA);this.referenceAngle=this.bodyB.GetAngleRadians()-this.bodyA.GetAngleRadians()};
box2d.b2PrismaticJoint=function(a){box2d.b2Joint.call(this,a);this.m_localAnchorA=a.localAnchorA.Clone();this.m_localAnchorB=a.localAnchorB.Clone();this.m_localXAxisA=a.localAxisA.Clone().SelfNormalize();this.m_localYAxisA=box2d.b2CrossOneV(this.m_localXAxisA,new box2d.b2Vec2);this.m_referenceAngle=a.referenceAngle;this.m_impulse=new box2d.b2Vec3(0,0,0);this.m_lowerTranslation=a.lowerTranslation;this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;
this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_axis=new box2d.b2Vec2(0,0);this.m_perp=new box2d.b2Vec2(0,0);this.m_K=new box2d.b2Mat33;this.m_K3=new box2d.b2Mat33;this.m_K2=new box2d.b2Mat22;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2};goog.inherits(box2d.b2PrismaticJoint,box2d.b2Joint);
box2d.b2PrismaticJoint.prototype.m_localAnchorA=null;box2d.b2PrismaticJoint.prototype.m_localAnchorB=null;box2d.b2PrismaticJoint.prototype.m_localXAxisA=null;box2d.b2PrismaticJoint.prototype.m_localYAxisA=null;box2d.b2PrismaticJoint.prototype.m_referenceAngle=0;box2d.b2PrismaticJoint.prototype.m_impulse=null;box2d.b2PrismaticJoint.prototype.m_motorImpulse=0;box2d.b2PrismaticJoint.prototype.m_lowerTranslation=0;box2d.b2PrismaticJoint.prototype.m_upperTranslation=0;
box2d.b2PrismaticJoint.prototype.m_maxMotorForce=0;box2d.b2PrismaticJoint.prototype.m_motorSpeed=0;box2d.b2PrismaticJoint.prototype.m_enableLimit=!1;box2d.b2PrismaticJoint.prototype.m_enableMotor=!1;box2d.b2PrismaticJoint.prototype.m_limitState=box2d.b2LimitState.e_inactiveLimit;box2d.b2PrismaticJoint.prototype.m_indexA=0;box2d.b2PrismaticJoint.prototype.m_indexB=0;box2d.b2PrismaticJoint.prototype.m_localCenterA=null;box2d.b2PrismaticJoint.prototype.m_localCenterB=null;
box2d.b2PrismaticJoint.prototype.m_invMassA=0;box2d.b2PrismaticJoint.prototype.m_invMassB=0;box2d.b2PrismaticJoint.prototype.m_invIA=0;box2d.b2PrismaticJoint.prototype.m_invIB=0;box2d.b2PrismaticJoint.prototype.m_axis=null;box2d.b2PrismaticJoint.prototype.m_perp=null;box2d.b2PrismaticJoint.prototype.m_s1=0;box2d.b2PrismaticJoint.prototype.m_s2=0;box2d.b2PrismaticJoint.prototype.m_a1=0;box2d.b2PrismaticJoint.prototype.m_a2=0;box2d.b2PrismaticJoint.prototype.m_K=null;
box2d.b2PrismaticJoint.prototype.m_K3=null;box2d.b2PrismaticJoint.prototype.m_K2=null;box2d.b2PrismaticJoint.prototype.m_motorMass=0;box2d.b2PrismaticJoint.prototype.m_qA=null;box2d.b2PrismaticJoint.prototype.m_qB=null;box2d.b2PrismaticJoint.prototype.m_lalcA=null;box2d.b2PrismaticJoint.prototype.m_lalcB=null;box2d.b2PrismaticJoint.prototype.m_rA=null;box2d.b2PrismaticJoint.prototype.m_rB=null;
box2d.b2PrismaticJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexA].c,c=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,
e=a.positions[this.m_indexB].c,f=a.positions[this.m_indexB].a,g=a.velocities[this.m_indexB].v,h=a.velocities[this.m_indexB].w,k=this.m_qA.SetAngleRadians(a.positions[this.m_indexA].a);f=this.m_qB.SetAngleRadians(f);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var l=box2d.b2MulRV(k,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var m=box2d.b2MulRV(f,this.m_lalcB,this.m_rB),n=box2d.b2AddVV(box2d.b2SubVV(e,b,box2d.b2Vec2.s_t0),box2d.b2SubVV(m,
l,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_d);b=this.m_invMassA;e=this.m_invMassB;f=this.m_invIA;var p=this.m_invIB;box2d.b2MulRV(k,this.m_localXAxisA,this.m_axis);this.m_a1=box2d.b2CrossVV(box2d.b2AddVV(n,l,box2d.b2Vec2.s_t0),this.m_axis);this.m_a2=box2d.b2CrossVV(m,this.m_axis);this.m_motorMass=b+e+f*this.m_a1*this.m_a1+p*this.m_a2*this.m_a2;0<this.m_motorMass&&(this.m_motorMass=1/this.m_motorMass);box2d.b2MulRV(k,this.m_localYAxisA,this.m_perp);this.m_s1=box2d.b2CrossVV(box2d.b2AddVV(n,
l,box2d.b2Vec2.s_t0),this.m_perp);this.m_s2=box2d.b2CrossVV(m,this.m_perp);this.m_K.ex.x=b+e+f*this.m_s1*this.m_s1+p*this.m_s2*this.m_s2;this.m_K.ex.y=f*this.m_s1+p*this.m_s2;this.m_K.ex.z=f*this.m_s1*this.m_a1+p*this.m_s2*this.m_a2;this.m_K.ey.x=this.m_K.ex.y;this.m_K.ey.y=f+p;0===this.m_K.ey.y&&(this.m_K.ey.y=1);this.m_K.ey.z=f*this.m_a1+p*this.m_a2;this.m_K.ez.x=this.m_K.ex.z;this.m_K.ez.y=this.m_K.ey.z;this.m_K.ez.z=b+e+f*this.m_a1*this.m_a1+p*this.m_a2*this.m_a2;this.m_enableLimit?(k=box2d.b2DotVV(this.m_axis,
n),box2d.b2Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*box2d.b2_linearSlop?this.m_limitState=box2d.b2LimitState.e_equalLimits:k<=this.m_lowerTranslation?this.m_limitState!==box2d.b2LimitState.e_atLowerLimit&&(this.m_limitState=box2d.b2LimitState.e_atLowerLimit,this.m_impulse.z=0):k>=this.m_upperTranslation?this.m_limitState!==box2d.b2LimitState.e_atUpperLimit&&(this.m_limitState=box2d.b2LimitState.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=box2d.b2LimitState.e_inactiveLimit,
this.m_impulse.z=0)):(this.m_limitState=box2d.b2LimitState.e_inactiveLimit,this.m_impulse.z=0);!1===this.m_enableMotor&&(this.m_motorImpulse=0);a.step.warmStarting?(this.m_impulse.SelfMul(a.step.dtRatio),this.m_motorImpulse*=a.step.dtRatio,k=box2d.b2AddVV(box2d.b2MulSV(this.m_impulse.x,this.m_perp,box2d.b2Vec2.s_t0),box2d.b2MulSV(this.m_motorImpulse+this.m_impulse.z,this.m_axis,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_P),l=this.m_impulse.x*this.m_s1+this.m_impulse.y+
(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,m=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2,c.SelfMulSub(b,k),d-=f*l,g.SelfMulAdd(e,k),h+=p*m):(this.m_impulse.SetZero(),this.m_motorImpulse=0);a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=h};box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_d=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,c=a.velocities[this.m_indexA].w,d=a.velocities[this.m_indexB].v,e=a.velocities[this.m_indexB].w,f=this.m_invMassA,g=this.m_invMassB,h=this.m_invIA,k=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!==box2d.b2LimitState.e_equalLimits){var l=box2d.b2DotVV(this.m_axis,box2d.b2SubVV(d,b,box2d.b2Vec2.s_t0))+this.m_a2*e-this.m_a1*c;l=this.m_motorMass*(this.m_motorSpeed-l);var m=this.m_motorImpulse,
n=a.step.dt*this.m_maxMotorForce;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+l,-n,n);l=this.m_motorImpulse-m;m=box2d.b2MulSV(l,this.m_axis,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P);n=l*this.m_a1;l*=this.m_a2;b.SelfMulSub(f,m);c-=h*n;d.SelfMulAdd(g,m);e+=k*l}n=box2d.b2DotVV(this.m_perp,box2d.b2SubVV(d,b,box2d.b2Vec2.s_t0))+this.m_s2*e-this.m_s1*c;var p=e-c;this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit?(l=box2d.b2DotVV(this.m_axis,box2d.b2SubVV(d,
b,box2d.b2Vec2.s_t0))+this.m_a2*e-this.m_a1*c,m=box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f1.Copy(this.m_impulse),l=this.m_K.Solve33(-n,-p,-l,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df3),this.m_impulse.SelfAdd(l),this.m_limitState===box2d.b2LimitState.e_atLowerLimit?this.m_impulse.z=box2d.b2Max(this.m_impulse.z,0):this.m_limitState===box2d.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=box2d.b2Min(this.m_impulse.z,0)),n=this.m_K.Solve22(-n-(this.m_impulse.z-m.z)*
this.m_K.ez.x,-p-(this.m_impulse.z-m.z)*this.m_K.ez.y,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f2r),n.x+=m.x,n.y+=m.y,this.m_impulse.x=n.x,this.m_impulse.y=n.y,l.x=this.m_impulse.x-m.x,l.y=this.m_impulse.y-m.y,l.z=this.m_impulse.z-m.z,m=box2d.b2AddVV(box2d.b2MulSV(l.x,this.m_perp,box2d.b2Vec2.s_t0),box2d.b2MulSV(l.z,this.m_axis,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P),n=l.x*this.m_s1+l.y+l.z*this.m_a1,l=l.x*this.m_s2+l.y+l.z*this.m_a2):(l=
this.m_K.Solve22(-n,-p,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df2),this.m_impulse.x+=l.x,this.m_impulse.y+=l.y,m=box2d.b2MulSV(l.x,this.m_perp,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P),n=l.x*this.m_s1+l.y,l=l.x*this.m_s2+l.y);b.SelfMulSub(f,m);c-=h*n;d.SelfMulAdd(g,m);a.velocities[this.m_indexA].w=c;a.velocities[this.m_indexB].w=e+k*l};box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f2r=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f1=new box2d.b2Vec3;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df3=new box2d.b2Vec3;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df2=new box2d.b2Vec2;
box2d.b2PrismaticJoint.prototype.SolvePositionConstraints=function(a){var b=a.positions[this.m_indexA].c,c=a.positions[this.m_indexA].a,d=a.positions[this.m_indexB].c,e=a.positions[this.m_indexB].a,f=this.m_qA.SetAngleRadians(c),g=this.m_qB.SetAngleRadians(e),h=this.m_invMassA,k=this.m_invMassB,l=this.m_invIA,m=this.m_invIB,n=box2d.b2MulRV(f,this.m_lalcA,this.m_rA),p=box2d.b2MulRV(g,this.m_lalcB,this.m_rB),q=box2d.b2SubVV(box2d.b2AddVV(d,p,box2d.b2Vec2.s_t0),box2d.b2AddVV(b,n,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_d),
r=box2d.b2MulRV(f,this.m_localXAxisA,this.m_axis),t=box2d.b2CrossVV(box2d.b2AddVV(q,n,box2d.b2Vec2.s_t0),r);g=box2d.b2CrossVV(p,r);f=box2d.b2MulRV(f,this.m_localYAxisA,this.m_perp);var u=box2d.b2CrossVV(box2d.b2AddVV(q,n,box2d.b2Vec2.s_t0),f),w=box2d.b2CrossVV(p,f),x=box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse,A=box2d.b2DotVV(f,q),B=e-c-this.m_referenceAngle;n=box2d.b2Abs(A);p=box2d.b2Abs(B);var v=!1,y=0;this.m_enableLimit&&(q=box2d.b2DotVV(r,q),box2d.b2Abs(this.m_upperTranslation-
this.m_lowerTranslation)<2*box2d.b2_linearSlop?(y=box2d.b2Clamp(q,-box2d.b2_maxLinearCorrection,box2d.b2_maxLinearCorrection),n=box2d.b2Max(n,box2d.b2Abs(q)),v=!0):q<=this.m_lowerTranslation?(y=box2d.b2Clamp(q-this.m_lowerTranslation+box2d.b2_linearSlop,-box2d.b2_maxLinearCorrection,0),n=box2d.b2Max(n,this.m_lowerTranslation-q),v=!0):q>=this.m_upperTranslation&&(y=box2d.b2Clamp(q-this.m_upperTranslation-box2d.b2_linearSlop,0,box2d.b2_maxLinearCorrection),n=box2d.b2Max(n,q-this.m_upperTranslation),
v=!0));if(v){q=l*u+m*w;var E=l*u*t+m*w*g;v=l+m;0===v&&(v=1);var F=l*t+m*g,D=h+k+l*t*t+m*g*g,z=this.m_K3;z.ex.SetXYZ(h+k+l*u*u+m*w*w,q,E);z.ey.SetXYZ(q,v,F);z.ez.SetXYZ(E,F,D);x=z.Solve33(-A,-B,-y,x)}else q=l*u+m*w,v=l+m,0===v&&(v=1),y=this.m_K2,y.ex.SetXY(h+k+l*u*u+m*w*w,q),y.ey.SetXY(q,v),A=y.Solve(-A,-B,box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse1),x.x=A.x,x.y=A.y,x.z=0;r=box2d.b2AddVV(box2d.b2MulSV(x.x,f,box2d.b2Vec2.s_t0),box2d.b2MulSV(x.z,r,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_P);
t=x.x*u+x.y+x.z*t;g=x.x*w+x.y+x.z*g;b.SelfMulSub(h,r);c-=l*t;d.SelfMulAdd(k,r);a.positions[this.m_indexA].a=c;a.positions[this.m_indexB].a=e+m*g;return n<=box2d.b2_linearSlop&&p<=box2d.b2_angularSlop};box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_d=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec3;box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse1=new box2d.b2Vec2;
box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};box2d.b2PrismaticJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};
box2d.b2PrismaticJoint.prototype.GetReactionForce=function(a,b){return b.SetXY(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))};box2d.b2PrismaticJoint.prototype.GetReactionTorque=function(a){return a*this.m_impulse.y};box2d.b2PrismaticJoint.prototype.GetLocalAnchorA=function(a){return a.Copy(this.m_localAnchorA)};box2d.b2PrismaticJoint.prototype.GetLocalAnchorB=function(a){return a.Copy(this.m_localAnchorB)};
box2d.b2PrismaticJoint.prototype.GetLocalAxisA=function(a){return a.Copy(this.m_localXAxisA)};box2d.b2PrismaticJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle};
box2d.b2PrismaticJoint.prototype.GetJointTranslation=function(){var a=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pA),b=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pB);a=box2d.b2SubVV(b,a,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_d);b=this.m_bodyA.GetWorldVector(this.m_localXAxisA,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_axis);return box2d.b2DotVV(a,b)};
box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pA=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pB=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_d=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_axis=new box2d.b2Vec2;
box2d.b2PrismaticJoint.prototype.GetJointSpeed=function(){var a=this.m_bodyA,b=this.m_bodyB;box2d.b2SubVV(this.m_localAnchorA,a.m_sweep.localCenter,this.m_lalcA);var c=box2d.b2MulRV(a.m_xf.q,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,b.m_sweep.localCenter,this.m_lalcB);var d=box2d.b2MulRV(b.m_xf.q,this.m_lalcB,this.m_rB),e=box2d.b2AddVV(a.m_sweep.c,c,box2d.b2Vec2.s_t0),f=box2d.b2AddVV(b.m_sweep.c,d,box2d.b2Vec2.s_t1);e=box2d.b2SubVV(f,e,box2d.b2Vec2.s_t2);f=a.GetWorldVector(this.m_localXAxisA,
this.m_axis);var g=a.m_linearVelocity,h=b.m_linearVelocity;a=a.m_angularVelocity;b=b.m_angularVelocity;return box2d.b2DotVV(e,box2d.b2CrossSV(a,f,box2d.b2Vec2.s_t0))+box2d.b2DotVV(f,box2d.b2SubVV(box2d.b2AddVCrossSV(h,b,d,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(g,a,c,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0))};box2d.b2PrismaticJoint.prototype.IsLimitEnabled=function(){return this.m_enableLimit};
box2d.b2PrismaticJoint.prototype.EnableLimit=function(a){a!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=a,this.m_impulse.z=0)};box2d.b2PrismaticJoint.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};box2d.b2PrismaticJoint.prototype.GetUpperLimit=function(){return this.m_upperTranslation};
box2d.b2PrismaticJoint.prototype.SetLimits=function(a,b){if(a!==this.m_lowerTranslation||b!==this.m_upperTranslation)this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=a,this.m_upperTranslation=b,this.m_impulse.z=0};box2d.b2PrismaticJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor};box2d.b2PrismaticJoint.prototype.EnableMotor=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=a};
box2d.b2PrismaticJoint.prototype.SetMotorSpeed=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=a};box2d.b2PrismaticJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};box2d.b2PrismaticJoint.prototype.SetMaxMotorForce=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorForce=a};box2d.b2PrismaticJoint.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce};
box2d.b2PrismaticJoint.prototype.GetMotorForce=function(a){return a*this.m_motorImpulse};
box2d.b2PrismaticJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2PrismaticJointDef*/ var jd = new box2d.b2PrismaticJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",
this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.localAxisA.SetXY(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y);box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle);box2d.b2Log("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false");box2d.b2Log("  jd.lowerTranslation = %.15f;\n",this.m_lowerTranslation);box2d.b2Log("  jd.upperTranslation = %.15f;\n",this.m_upperTranslation);box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false");
box2d.b2Log("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed);box2d.b2Log("  jd.maxMotorForce = %.15f;\n",this.m_maxMotorForce);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};box2d.b2GearJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_gearJoint)};goog.inherits(box2d.b2GearJointDef,box2d.b2JointDef);box2d.b2GearJointDef.prototype.joint1=null;box2d.b2GearJointDef.prototype.joint2=null;box2d.b2GearJointDef.prototype.ratio=1;
box2d.b2GearJoint=function(a){box2d.b2Joint.call(this,a);this.m_joint1=a.joint1;this.m_joint2=a.joint2;this.m_localAnchorA=new box2d.b2Vec2;this.m_localAnchorB=new box2d.b2Vec2;this.m_localAnchorC=new box2d.b2Vec2;this.m_localAnchorD=new box2d.b2Vec2;this.m_localAxisC=new box2d.b2Vec2;this.m_localAxisD=new box2d.b2Vec2;this.m_lcA=new box2d.b2Vec2;this.m_lcB=new box2d.b2Vec2;this.m_lcC=new box2d.b2Vec2;this.m_lcD=new box2d.b2Vec2;this.m_JvAC=new box2d.b2Vec2;this.m_JvBD=new box2d.b2Vec2;this.m_qA=
new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_qC=new box2d.b2Rot;this.m_qD=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_lalcC=new box2d.b2Vec2;this.m_lalcD=new box2d.b2Vec2;this.m_typeA=this.m_joint1.GetType();this.m_typeB=this.m_joint2.GetType();box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_typeA===box2d.b2JointType.e_revoluteJoint||this.m_typeA===box2d.b2JointType.e_prismaticJoint);box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_typeB===box2d.b2JointType.e_revoluteJoint||
this.m_typeB===box2d.b2JointType.e_prismaticJoint);this.m_bodyC=this.m_joint1.GetBodyA();this.m_bodyA=this.m_joint1.GetBodyB();var b=this.m_bodyA.m_xf;var c=this.m_bodyA.m_sweep.a;var d=this.m_bodyC.m_xf;var e=this.m_bodyC.m_sweep.a;this.m_typeA===box2d.b2JointType.e_revoluteJoint?(d=a.joint1,this.m_localAnchorC.Copy(d.m_localAnchorA),this.m_localAnchorA.Copy(d.m_localAnchorB),this.m_referenceAngleA=d.m_referenceAngle,this.m_localAxisC.SetZero(),b=c-e-this.m_referenceAngleA):(e=a.joint1,this.m_localAnchorC.Copy(e.m_localAnchorA),
this.m_localAnchorA.Copy(e.m_localAnchorB),this.m_referenceAngleA=e.m_referenceAngle,this.m_localAxisC.Copy(e.m_localXAxisA),c=this.m_localAnchorC,b=box2d.b2MulTRV(d.q,box2d.b2AddVV(box2d.b2MulRV(b.q,this.m_localAnchorA,box2d.b2Vec2.s_t0),box2d.b2SubVV(b.p,d.p,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),b=box2d.b2DotVV(box2d.b2SubVV(b,c,box2d.b2Vec2.s_t0),this.m_localAxisC));this.m_bodyD=this.m_joint2.GetBodyA();this.m_bodyB=this.m_joint2.GetBodyB();d=this.m_bodyB.m_xf;e=this.m_bodyB.m_sweep.a;
c=this.m_bodyD.m_xf;var f=this.m_bodyD.m_sweep.a;this.m_typeB===box2d.b2JointType.e_revoluteJoint?(d=a.joint2,this.m_localAnchorD.Copy(d.m_localAnchorA),this.m_localAnchorB.Copy(d.m_localAnchorB),this.m_referenceAngleB=d.m_referenceAngle,this.m_localAxisD.SetZero(),d=e-f-this.m_referenceAngleB):(e=a.joint2,this.m_localAnchorD.Copy(e.m_localAnchorA),this.m_localAnchorB.Copy(e.m_localAnchorB),this.m_referenceAngleB=e.m_referenceAngle,this.m_localAxisD.Copy(e.m_localXAxisA),e=this.m_localAnchorD,d=box2d.b2MulTRV(c.q,
box2d.b2AddVV(box2d.b2MulRV(d.q,this.m_localAnchorB,box2d.b2Vec2.s_t0),box2d.b2SubVV(d.p,c.p,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),d=box2d.b2DotVV(box2d.b2SubVV(d,e,box2d.b2Vec2.s_t0),this.m_localAxisD));this.m_ratio=a.ratio;this.m_constant=b+this.m_ratio*d;this.m_impulse=0};goog.inherits(box2d.b2GearJoint,box2d.b2Joint);box2d.b2GearJoint.prototype.m_joint1=null;box2d.b2GearJoint.prototype.m_joint2=null;box2d.b2GearJoint.prototype.m_typeA=box2d.b2JointType.e_unknownJoint;
box2d.b2GearJoint.prototype.m_typeB=box2d.b2JointType.e_unknownJoint;box2d.b2GearJoint.prototype.m_bodyC=null;box2d.b2GearJoint.prototype.m_bodyD=null;box2d.b2GearJoint.prototype.m_localAnchorA=null;box2d.b2GearJoint.prototype.m_localAnchorB=null;box2d.b2GearJoint.prototype.m_localAnchorC=null;box2d.b2GearJoint.prototype.m_localAnchorD=null;box2d.b2GearJoint.prototype.m_localAxisC=null;box2d.b2GearJoint.prototype.m_localAxisD=null;box2d.b2GearJoint.prototype.m_referenceAngleA=0;
box2d.b2GearJoint.prototype.m_referenceAngleB=0;box2d.b2GearJoint.prototype.m_constant=0;box2d.b2GearJoint.prototype.m_ratio=0;box2d.b2GearJoint.prototype.m_impulse=0;box2d.b2GearJoint.prototype.m_indexA=0;box2d.b2GearJoint.prototype.m_indexB=0;box2d.b2GearJoint.prototype.m_indexC=0;box2d.b2GearJoint.prototype.m_indexD=0;box2d.b2GearJoint.prototype.m_lcA=null;box2d.b2GearJoint.prototype.m_lcB=null;box2d.b2GearJoint.prototype.m_lcC=null;box2d.b2GearJoint.prototype.m_lcD=null;
box2d.b2GearJoint.prototype.m_mA=0;box2d.b2GearJoint.prototype.m_mB=0;box2d.b2GearJoint.prototype.m_mC=0;box2d.b2GearJoint.prototype.m_mD=0;box2d.b2GearJoint.prototype.m_iA=0;box2d.b2GearJoint.prototype.m_iB=0;box2d.b2GearJoint.prototype.m_iC=0;box2d.b2GearJoint.prototype.m_iD=0;box2d.b2GearJoint.prototype.m_JvAC=null;box2d.b2GearJoint.prototype.m_JvBD=null;box2d.b2GearJoint.prototype.m_JwA=0;box2d.b2GearJoint.prototype.m_JwB=0;box2d.b2GearJoint.prototype.m_JwC=0;
box2d.b2GearJoint.prototype.m_JwD=0;box2d.b2GearJoint.prototype.m_mass=0;box2d.b2GearJoint.prototype.m_qA=null;box2d.b2GearJoint.prototype.m_qB=null;box2d.b2GearJoint.prototype.m_qC=null;box2d.b2GearJoint.prototype.m_qD=null;box2d.b2GearJoint.prototype.m_lalcA=null;box2d.b2GearJoint.prototype.m_lalcB=null;box2d.b2GearJoint.prototype.m_lalcC=null;box2d.b2GearJoint.prototype.m_lalcD=null;
box2d.b2GearJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_indexC=this.m_bodyC.m_islandIndex;this.m_indexD=this.m_bodyD.m_islandIndex;this.m_lcA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_lcB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_lcC.Copy(this.m_bodyC.m_sweep.localCenter);this.m_lcD.Copy(this.m_bodyD.m_sweep.localCenter);this.m_mA=this.m_bodyA.m_invMass;this.m_mB=this.m_bodyB.m_invMass;this.m_mC=
this.m_bodyC.m_invMass;this.m_mD=this.m_bodyD.m_invMass;this.m_iA=this.m_bodyA.m_invI;this.m_iB=this.m_bodyB.m_invI;this.m_iC=this.m_bodyC.m_invI;this.m_iD=this.m_bodyD.m_invI;var b=a.velocities[this.m_indexA].v,c=a.velocities[this.m_indexA].w,d=a.positions[this.m_indexB].a,e=a.velocities[this.m_indexB].v,f=a.velocities[this.m_indexB].w,g=a.positions[this.m_indexC].a,h=a.velocities[this.m_indexC].v,k=a.velocities[this.m_indexC].w,l=a.positions[this.m_indexD].a,m=a.velocities[this.m_indexD].v,n=a.velocities[this.m_indexD].w,
p=this.m_qA.SetAngleRadians(a.positions[this.m_indexA].a);d=this.m_qB.SetAngleRadians(d);var q=this.m_qC.SetAngleRadians(g);g=this.m_qD.SetAngleRadians(l);this.m_mass=0;this.m_typeA===box2d.b2JointType.e_revoluteJoint?(this.m_JvAC.SetZero(),this.m_JwC=this.m_JwA=1,this.m_mass+=this.m_iA+this.m_iC):(l=box2d.b2MulRV(q,this.m_localAxisC,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u),box2d.b2SubVV(this.m_localAnchorC,this.m_lcC,this.m_lalcC),q=box2d.b2MulRV(q,this.m_lalcC,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rC),
box2d.b2SubVV(this.m_localAnchorA,this.m_lcA,this.m_lalcA),p=box2d.b2MulRV(p,this.m_lalcA,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rA),this.m_JvAC.Copy(l),this.m_JwC=box2d.b2CrossVV(q,l),this.m_JwA=box2d.b2CrossVV(p,l),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA);this.m_typeB===box2d.b2JointType.e_revoluteJoint?(this.m_JvBD.SetZero(),this.m_JwD=this.m_JwB=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD)):(l=
box2d.b2MulRV(g,this.m_localAxisD,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u),box2d.b2SubVV(this.m_localAnchorD,this.m_lcD,this.m_lalcD),p=box2d.b2MulRV(g,this.m_lalcD,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rD),box2d.b2SubVV(this.m_localAnchorB,this.m_lcB,this.m_lalcB),d=box2d.b2MulRV(d,this.m_lalcB,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rB),box2d.b2MulSV(this.m_ratio,l,this.m_JvBD),this.m_JwD=this.m_ratio*box2d.b2CrossVV(p,l),this.m_JwB=this.m_ratio*box2d.b2CrossVV(d,
l),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB);this.m_mass=0<this.m_mass?1/this.m_mass:0;a.step.warmStarting?(b.SelfMulAdd(this.m_mA*this.m_impulse,this.m_JvAC),c+=this.m_iA*this.m_impulse*this.m_JwA,e.SelfMulAdd(this.m_mB*this.m_impulse,this.m_JvBD),f+=this.m_iB*this.m_impulse*this.m_JwB,h.SelfMulSub(this.m_mC*this.m_impulse,this.m_JvAC),k-=this.m_iC*this.m_impulse*this.m_JwC,m.SelfMulSub(this.m_mD*this.m_impulse,this.m_JvBD),
n-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0;a.velocities[this.m_indexA].w=c;a.velocities[this.m_indexB].w=f;a.velocities[this.m_indexC].w=k;a.velocities[this.m_indexD].w=n};box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u=new box2d.b2Vec2;box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rA=new box2d.b2Vec2;box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rB=new box2d.b2Vec2;box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rC=new box2d.b2Vec2;
box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rD=new box2d.b2Vec2;
box2d.b2GearJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,c=a.velocities[this.m_indexA].w,d=a.velocities[this.m_indexB].v,e=a.velocities[this.m_indexB].w,f=a.velocities[this.m_indexC].v,g=a.velocities[this.m_indexC].w,h=a.velocities[this.m_indexD].v,k=a.velocities[this.m_indexD].w,l=box2d.b2DotVV(this.m_JvAC,box2d.b2SubVV(b,f,box2d.b2Vec2.s_t0))+box2d.b2DotVV(this.m_JvBD,box2d.b2SubVV(d,h,box2d.b2Vec2.s_t0));l+=this.m_JwA*c-this.m_JwC*g+(this.m_JwB*e-this.m_JwD*
k);l*=-this.m_mass;this.m_impulse+=l;b.SelfMulAdd(this.m_mA*l,this.m_JvAC);c+=this.m_iA*l*this.m_JwA;d.SelfMulAdd(this.m_mB*l,this.m_JvBD);e+=this.m_iB*l*this.m_JwB;f.SelfMulSub(this.m_mC*l,this.m_JvAC);g-=this.m_iC*l*this.m_JwC;h.SelfMulSub(this.m_mD*l,this.m_JvBD);k-=this.m_iD*l*this.m_JwD;a.velocities[this.m_indexA].w=c;a.velocities[this.m_indexB].w=e;a.velocities[this.m_indexC].w=g;a.velocities[this.m_indexD].w=k};
box2d.b2GearJoint.prototype.SolvePositionConstraints=function(a){var b=a.positions[this.m_indexA].c,c=a.positions[this.m_indexA].a,d=a.positions[this.m_indexB].c,e=a.positions[this.m_indexB].a,f=a.positions[this.m_indexC].c,g=a.positions[this.m_indexC].a,h=a.positions[this.m_indexD].c,k=a.positions[this.m_indexD].a,l=this.m_qA.SetAngleRadians(c),m=this.m_qB.SetAngleRadians(e),n=this.m_qC.SetAngleRadians(g),p=this.m_qD.SetAngleRadians(k),q=this.m_JvAC,r=this.m_JvBD,t,u=0;if(this.m_typeA===box2d.b2JointType.e_revoluteJoint)q.SetZero(),
l=t=1,u+=this.m_iA+this.m_iC,n=c-g-this.m_referenceAngleA;else{var w=box2d.b2MulRV(n,this.m_localAxisC,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u);t=box2d.b2MulRV(n,this.m_lalcC,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rC);var x=box2d.b2MulRV(l,this.m_lalcA,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rA);q.Copy(w);l=box2d.b2CrossVV(t,w);t=box2d.b2CrossVV(x,w);u+=this.m_mC+this.m_mA+this.m_iC*l*l+this.m_iA*t*t;w=this.m_lalcC;n=box2d.b2MulTRV(n,box2d.b2AddVV(x,
box2d.b2SubVV(b,f,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0);n=box2d.b2DotVV(box2d.b2SubVV(n,w,box2d.b2Vec2.s_t0),this.m_localAxisC)}if(this.m_typeB===box2d.b2JointType.e_revoluteJoint)r.SetZero(),m=w=this.m_ratio,u+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),p=e-k-this.m_referenceAngleB;else{w=box2d.b2MulRV(p,this.m_localAxisD,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u);var A=box2d.b2MulRV(p,this.m_lalcD,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rD);
x=box2d.b2MulRV(m,this.m_lalcB,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rB);box2d.b2MulSV(this.m_ratio,w,r);m=this.m_ratio*box2d.b2CrossVV(A,w);w=this.m_ratio*box2d.b2CrossVV(x,w);u+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*m*m+this.m_iB*w*w;A=this.m_lalcD;p=box2d.b2MulTRV(p,box2d.b2AddVV(x,box2d.b2SubVV(d,h,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0);p=box2d.b2DotVV(box2d.b2SubVV(p,A,box2d.b2Vec2.s_t0),this.m_localAxisD)}p=n+this.m_ratio*p-this.m_constant;
n=0;0<u&&(n=-p/u);b.SelfMulAdd(this.m_mA*n,q);c+=this.m_iA*n*t;d.SelfMulAdd(this.m_mB*n,r);e+=this.m_iB*n*w;f.SelfMulSub(this.m_mC*n,q);g-=this.m_iC*n*l;h.SelfMulSub(this.m_mD*n,r);k-=this.m_iD*n*m;a.positions[this.m_indexA].a=c;a.positions[this.m_indexB].a=e;a.positions[this.m_indexC].a=g;a.positions[this.m_indexD].a=k;return 0<box2d.b2_linearSlop};box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rA=new box2d.b2Vec2;
box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rB=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rC=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rD=new box2d.b2Vec2;box2d.b2GearJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};box2d.b2GearJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};
box2d.b2GearJoint.prototype.GetReactionForce=function(a,b){return box2d.b2MulSV(a*this.m_impulse,this.m_JvAC,b)};box2d.b2GearJoint.prototype.GetReactionTorque=function(a){return a*this.m_impulse*this.m_JwA};box2d.b2GearJoint.prototype.GetJoint1=function(){return this.m_joint1};box2d.b2GearJoint.prototype.GetJoint2=function(){return this.m_joint2};box2d.b2GearJoint.prototype.GetRatio=function(){return this.m_ratio};
box2d.b2GearJoint.prototype.SetRatio=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a));this.m_ratio=a};
box2d.b2GearJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex,c=this.m_joint1.m_index,d=this.m_joint2.m_index;box2d.b2Log("  /*box2d.b2GearJointDef*/ var jd = new box2d.b2GearJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.joint1 = joints[%d];\n",c);box2d.b2Log("  jd.joint2 = joints[%d];\n",
d);box2d.b2Log("  jd.ratio = %.15f;\n",this.m_ratio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};box2d.b2DistanceProxy=function(){this.m_buffer=box2d.b2Vec2.MakeArray(2)};box2d.b2DistanceProxy.prototype.m_buffer=null;box2d.b2DistanceProxy.prototype.m_vertices=null;box2d.b2DistanceProxy.prototype.m_count=0;box2d.b2DistanceProxy.prototype.m_radius=0;box2d.b2DistanceProxy.prototype.Reset=function(){this.m_vertices=null;this.m_radius=this.m_count=0;return this};
box2d.b2DistanceProxy.prototype.SetShape=function(a,b){a.SetupDistanceProxy(this,b)};box2d.b2DistanceProxy.prototype.GetSupport=function(a){for(var b=0,c=box2d.b2DotVV(this.m_vertices[0],a),d=1;d<this.m_count;++d){var e=box2d.b2DotVV(this.m_vertices[d],a);e>c&&(b=d,c=e)}return b};box2d.b2DistanceProxy.prototype.GetSupportVertex=function(a,b){for(var c=0,d=box2d.b2DotVV(this.m_vertices[0],a),e=1;e<this.m_count;++e){var f=box2d.b2DotVV(this.m_vertices[e],a);f>d&&(c=e,d=f)}return b.Copy(this.m_vertices[c])};
box2d.b2DistanceProxy.prototype.GetVertexCount=function(){return this.m_count};box2d.b2DistanceProxy.prototype.GetVertex=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=a&&a<this.m_count);return this.m_vertices[a]};box2d.b2SimplexCache=function(){this.indexA=box2d.b2MakeNumberArray(3);this.indexB=box2d.b2MakeNumberArray(3)};box2d.b2SimplexCache.prototype.metric=0;box2d.b2SimplexCache.prototype.count=0;box2d.b2SimplexCache.prototype.indexA=null;box2d.b2SimplexCache.prototype.indexB=null;
box2d.b2SimplexCache.prototype.Reset=function(){this.count=this.metric=0;return this};box2d.b2DistanceInput=function(){this.proxyA=new box2d.b2DistanceProxy;this.proxyB=new box2d.b2DistanceProxy;this.transformA=new box2d.b2Transform;this.transformB=new box2d.b2Transform};box2d.b2DistanceInput.prototype.proxyA=null;box2d.b2DistanceInput.prototype.proxyB=null;box2d.b2DistanceInput.prototype.transformA=null;box2d.b2DistanceInput.prototype.transformB=null;box2d.b2DistanceInput.prototype.useRadii=!1;
box2d.b2DistanceInput.prototype.Reset=function(){this.proxyA.Reset();this.proxyB.Reset();this.transformA.SetIdentity();this.transformB.SetIdentity();this.useRadii=!1;return this};box2d.b2DistanceOutput=function(){this.pointA=new box2d.b2Vec2;this.pointB=new box2d.b2Vec2};box2d.b2DistanceOutput.prototype.pointA=null;box2d.b2DistanceOutput.prototype.pointB=null;box2d.b2DistanceOutput.prototype.distance=0;box2d.b2DistanceOutput.prototype.iterations=0;
box2d.b2DistanceOutput.prototype.Reset=function(){this.pointA.SetZero();this.pointB.SetZero();this.iterations=this.distance=0;return this};box2d.b2_gjkCalls=0;box2d.b2_gjkIters=0;box2d.b2_gjkMaxIters=0;box2d.b2SimplexVertex=function(){this.wA=new box2d.b2Vec2;this.wB=new box2d.b2Vec2;this.w=new box2d.b2Vec2};box2d.b2SimplexVertex.prototype.wA=null;box2d.b2SimplexVertex.prototype.wB=null;box2d.b2SimplexVertex.prototype.w=null;box2d.b2SimplexVertex.prototype.a=0;
box2d.b2SimplexVertex.prototype.indexA=0;box2d.b2SimplexVertex.prototype.indexB=0;box2d.b2SimplexVertex.prototype.Copy=function(a){this.wA.Copy(a.wA);this.wB.Copy(a.wB);this.w.Copy(a.w);this.a=a.a;this.indexA=a.indexA;this.indexB=a.indexB;return this};box2d.b2Simplex=function(){this.m_v1=new box2d.b2SimplexVertex;this.m_v2=new box2d.b2SimplexVertex;this.m_v3=new box2d.b2SimplexVertex;this.m_vertices=Array(3);this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};
box2d.b2Simplex.prototype.m_v1=null;box2d.b2Simplex.prototype.m_v2=null;box2d.b2Simplex.prototype.m_v3=null;box2d.b2Simplex.prototype.m_vertices=null;box2d.b2Simplex.prototype.m_count=0;
box2d.b2Simplex.prototype.ReadCache=function(a,b,c,d,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=a.count&&3>=a.count);this.m_count=a.count;for(var f=this.m_vertices,g=0;g<this.m_count;++g){var h=f[g];h.indexA=a.indexA[g];h.indexB=a.indexB[g];var k=b.GetVertex(h.indexA),l=d.GetVertex(h.indexB);box2d.b2MulXV(c,k,h.wA);box2d.b2MulXV(e,l,h.wB);box2d.b2SubVV(h.wB,h.wA,h.w);h.a=0}1<this.m_count&&(a=a.metric,g=this.GetMetric(),g<.5*a||2*a<g||g<box2d.b2_epsilon)&&(this.m_count=0);0===this.m_count&&(h=f[0],
h.indexA=0,h.indexB=0,k=b.GetVertex(0),l=d.GetVertex(0),box2d.b2MulXV(c,k,h.wA),box2d.b2MulXV(e,l,h.wB),box2d.b2SubVV(h.wB,h.wA,h.w),this.m_count=h.a=1)};box2d.b2Simplex.prototype.WriteCache=function(a){a.metric=this.GetMetric();a.count=this.m_count;for(var b=this.m_vertices,c=0;c<this.m_count;++c)a.indexA[c]=b[c].indexA,a.indexB[c]=b[c].indexB};
box2d.b2Simplex.prototype.GetSearchDirection=function(a){switch(this.m_count){case 1:return box2d.b2NegV(this.m_v1.w,a);case 2:var b=box2d.b2SubVV(this.m_v2.w,this.m_v1.w,a);return 0<box2d.b2CrossVV(b,box2d.b2NegV(this.m_v1.w,box2d.b2Vec2.s_t0))?box2d.b2CrossOneV(b,a):box2d.b2CrossVOne(b,a);default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),a.SetZero()}};
box2d.b2Simplex.prototype.GetClosestPoint=function(a){switch(this.m_count){case 0:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),a.SetZero();case 1:return a.Copy(this.m_v1.w);case 2:return a.SetXY(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);case 3:return a.SetZero();default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),a.SetZero()}};
box2d.b2Simplex.prototype.GetWitnessPoints=function(a,b){switch(this.m_count){case 0:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);break;case 1:a.Copy(this.m_v1.wA);b.Copy(this.m_v1.wB);break;case 2:a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;b.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;b.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:b.x=a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+
this.m_v3.a*this.m_v3.wA.x;b.y=a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}};
box2d.b2Simplex.prototype.GetMetric=function(){switch(this.m_count){case 0:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0;case 1:return 0;case 2:return box2d.b2DistanceVV(this.m_v1.w,this.m_v2.w);case 3:return box2d.b2CrossVV(box2d.b2SubVV(this.m_v2.w,this.m_v1.w,box2d.b2Vec2.s_t0),box2d.b2SubVV(this.m_v3.w,this.m_v1.w,box2d.b2Vec2.s_t1));default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0}};
box2d.b2Simplex.prototype.Solve2=function(){var a=this.m_v1.w,b=this.m_v2.w,c=box2d.b2SubVV(b,a,box2d.b2Simplex.s_e12);a=-box2d.b2DotVV(a,c);0>=a?this.m_count=this.m_v1.a=1:(b=box2d.b2DotVV(b,c),0>=b?(this.m_count=this.m_v2.a=1,this.m_v1.Copy(this.m_v2)):(c=1/(b+a),this.m_v1.a=b*c,this.m_v2.a=a*c,this.m_count=2))};
box2d.b2Simplex.prototype.Solve3=function(){var a=this.m_v1.w,b=this.m_v2.w,c=this.m_v3.w,d=box2d.b2SubVV(b,a,box2d.b2Simplex.s_e12),e=box2d.b2DotVV(a,d),f=box2d.b2DotVV(b,d);e=-e;var g=box2d.b2SubVV(c,a,box2d.b2Simplex.s_e13),h=box2d.b2DotVV(a,g),k=box2d.b2DotVV(c,g);h=-h;var l=box2d.b2SubVV(c,b,box2d.b2Simplex.s_e23),m=box2d.b2DotVV(b,l);l=box2d.b2DotVV(c,l);m=-m;g=box2d.b2CrossVV(d,g);d=g*box2d.b2CrossVV(b,c);c=g*box2d.b2CrossVV(c,a);a=g*box2d.b2CrossVV(a,b);0>=e&&0>=h?this.m_count=this.m_v1.a=
1:0<f&&0<e&&0>=a?(k=1/(f+e),this.m_v1.a=f*k,this.m_v2.a=e*k,this.m_count=2):0<k&&0<h&&0>=c?(f=1/(k+h),this.m_v1.a=k*f,this.m_v3.a=h*f,this.m_count=2,this.m_v2.Copy(this.m_v3)):0>=f&&0>=m?(this.m_count=this.m_v2.a=1,this.m_v1.Copy(this.m_v2)):0>=k&&0>=l?(this.m_count=this.m_v3.a=1,this.m_v1.Copy(this.m_v3)):0<l&&0<m&&0>=d?(f=1/(l+m),this.m_v2.a=l*f,this.m_v3.a=m*f,this.m_count=2,this.m_v1.Copy(this.m_v3)):(f=1/(d+c+a),this.m_v1.a=d*f,this.m_v2.a=c*f,this.m_v3.a=a*f,this.m_count=3)};
box2d.b2Simplex.s_e12=new box2d.b2Vec2;box2d.b2Simplex.s_e13=new box2d.b2Vec2;box2d.b2Simplex.s_e23=new box2d.b2Vec2;
box2d.b2Distance=function(a,b,c){++box2d.b2_gjkCalls;var d=c.proxyA,e=c.proxyB,f=c.transformA,g=c.transformB,h=box2d.b2Distance.s_simplex;h.ReadCache(b,d,f,e,g);for(var k=h.m_vertices,l=box2d.b2Distance.s_saveA,m=box2d.b2Distance.s_saveB,n,p=0;20>p;){n=h.m_count;for(var q=0;q<n;++q)l[q]=k[q].indexA,m[q]=k[q].indexB;switch(h.m_count){case 1:break;case 2:h.Solve2();break;case 3:h.Solve3();break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}if(3===h.m_count)break;var r=h.GetClosestPoint(box2d.b2Distance.s_p);
r.GetLengthSquared();q=h.GetSearchDirection(box2d.b2Distance.s_d);if(q.GetLengthSquared()<box2d.b2_epsilon_sq)break;r=k[h.m_count];r.indexA=d.GetSupport(box2d.b2MulTRV(f.q,box2d.b2NegV(q,box2d.b2Vec2.s_t0),box2d.b2Distance.s_supportA));box2d.b2MulXV(f,d.GetVertex(r.indexA),r.wA);r.indexB=e.GetSupport(box2d.b2MulTRV(g.q,q,box2d.b2Distance.s_supportB));box2d.b2MulXV(g,e.GetVertex(r.indexB),r.wB);box2d.b2SubVV(r.wB,r.wA,r.w);++p;++box2d.b2_gjkIters;var t=!1;for(q=0;q<n;++q)if(r.indexA===l[q]&&r.indexB===
m[q]){t=!0;break}if(t)break;++h.m_count}box2d.b2_gjkMaxIters=box2d.b2Max(box2d.b2_gjkMaxIters,p);h.GetWitnessPoints(a.pointA,a.pointB);a.distance=box2d.b2DistanceVV(a.pointA,a.pointB);a.iterations=p;h.WriteCache(b);c.useRadii&&(b=d.m_radius,e=e.m_radius,a.distance>b+e&&a.distance>box2d.b2_epsilon?(a.distance-=b+e,c=box2d.b2SubVV(a.pointB,a.pointA,box2d.b2Distance.s_normal),c.Normalize(),a.pointA.SelfMulAdd(b,c),a.pointB.SelfMulSub(e,c)):(r=box2d.b2MidVV(a.pointA,a.pointB,box2d.b2Distance.s_p),a.pointA.Copy(r),
a.pointB.Copy(r),a.distance=0))};box2d.b2Distance.s_simplex=new box2d.b2Simplex;box2d.b2Distance.s_saveA=box2d.b2MakeNumberArray(3);box2d.b2Distance.s_saveB=box2d.b2MakeNumberArray(3);box2d.b2Distance.s_p=new box2d.b2Vec2;box2d.b2Distance.s_d=new box2d.b2Vec2;box2d.b2Distance.s_normal=new box2d.b2Vec2;box2d.b2Distance.s_supportA=new box2d.b2Vec2;box2d.b2Distance.s_supportB=new box2d.b2Vec2;
box2d.b2WeldJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_weldJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2};goog.inherits(box2d.b2WeldJointDef,box2d.b2JointDef);box2d.b2WeldJointDef.prototype.localAnchorA=null;box2d.b2WeldJointDef.prototype.localAnchorB=null;box2d.b2WeldJointDef.prototype.referenceAngle=0;box2d.b2WeldJointDef.prototype.frequencyHz=0;box2d.b2WeldJointDef.prototype.dampingRatio=0;
box2d.b2WeldJointDef.prototype.Initialize=function(a,b,c){this.bodyA=a;this.bodyB=b;this.bodyA.GetLocalPoint(c,this.localAnchorA);this.bodyB.GetLocalPoint(c,this.localAnchorB);this.referenceAngle=this.bodyB.GetAngleRadians()-this.bodyA.GetAngleRadians()};
box2d.b2WeldJoint=function(a){box2d.b2Joint.call(this,a);this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_localAnchorA=a.localAnchorA.Clone();this.m_localAnchorB=a.localAnchorB.Clone();this.m_referenceAngle=a.referenceAngle;this.m_impulse=new box2d.b2Vec3(0,0,0);this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_mass=new box2d.b2Mat33;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=
new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat33};goog.inherits(box2d.b2WeldJoint,box2d.b2Joint);box2d.b2WeldJoint.prototype.m_frequencyHz=0;box2d.b2WeldJoint.prototype.m_dampingRatio=0;box2d.b2WeldJoint.prototype.m_bias=0;box2d.b2WeldJoint.prototype.m_localAnchorA=null;box2d.b2WeldJoint.prototype.m_localAnchorB=null;box2d.b2WeldJoint.prototype.m_referenceAngle=0;box2d.b2WeldJoint.prototype.m_gamma=0;box2d.b2WeldJoint.prototype.m_impulse=null;
box2d.b2WeldJoint.prototype.m_indexA=0;box2d.b2WeldJoint.prototype.m_indexB=0;box2d.b2WeldJoint.prototype.m_rA=null;box2d.b2WeldJoint.prototype.m_rB=null;box2d.b2WeldJoint.prototype.m_localCenterA=null;box2d.b2WeldJoint.prototype.m_localCenterB=null;box2d.b2WeldJoint.prototype.m_invMassA=0;box2d.b2WeldJoint.prototype.m_invMassB=0;box2d.b2WeldJoint.prototype.m_invIA=0;box2d.b2WeldJoint.prototype.m_invIB=0;box2d.b2WeldJoint.prototype.m_mass=null;box2d.b2WeldJoint.prototype.m_qA=null;
box2d.b2WeldJoint.prototype.m_qB=null;box2d.b2WeldJoint.prototype.m_lalcA=null;box2d.b2WeldJoint.prototype.m_lalcB=null;box2d.b2WeldJoint.prototype.m_K=null;
box2d.b2WeldJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexA].a,c=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,
e=a.positions[this.m_indexB].a,f=a.velocities[this.m_indexB].v,g=a.velocities[this.m_indexB].w,h=this.m_qA.SetAngleRadians(b),k=this.m_qB.SetAngleRadians(e);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2MulRV(h,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2MulRV(k,this.m_lalcB,this.m_rB);h=this.m_invMassA;k=this.m_invMassB;var l=this.m_invIA,m=this.m_invIB,n=this.m_K;n.ex.x=h+k+this.m_rA.y*this.m_rA.y*l+this.m_rB.y*
this.m_rB.y*m;n.ey.x=-this.m_rA.y*this.m_rA.x*l-this.m_rB.y*this.m_rB.x*m;n.ez.x=-this.m_rA.y*l-this.m_rB.y*m;n.ex.y=n.ey.x;n.ey.y=h+k+this.m_rA.x*this.m_rA.x*l+this.m_rB.x*this.m_rB.x*m;n.ez.y=this.m_rA.x*l+this.m_rB.x*m;n.ex.z=n.ez.x;n.ey.z=n.ez.y;n.ez.z=l+m;if(0<this.m_frequencyHz){n.GetInverse22(this.m_mass);n=l+m;var p=0<n?1/n:0;b=e-b-this.m_referenceAngle;e=2*box2d.b2_pi*this.m_frequencyHz;var q=p*e*e,r=a.step.dt;this.m_gamma=r*(2*p*this.m_dampingRatio*e+r*q);this.m_gamma=0!==this.m_gamma?1/
this.m_gamma:0;this.m_bias=b*r*q*this.m_gamma;n+=this.m_gamma;this.m_mass.ez.z=0!==n?1/n:0}else n.GetSymInverse33(this.m_mass),this.m_bias=this.m_gamma=0;a.step.warmStarting?(this.m_impulse.SelfMul(a.step.dtRatio),n=box2d.b2WeldJoint.prototype.InitVelocityConstraints.s_P.SetXY(this.m_impulse.x,this.m_impulse.y),c.SelfMulSub(h,n),d-=l*(box2d.b2CrossVV(this.m_rA,n)+this.m_impulse.z),f.SelfMulAdd(k,n),g+=m*(box2d.b2CrossVV(this.m_rB,n)+this.m_impulse.z)):this.m_impulse.SetZero();a.velocities[this.m_indexA].w=
d;a.velocities[this.m_indexB].w=g};box2d.b2WeldJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2WeldJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,c=a.velocities[this.m_indexA].w,d=a.velocities[this.m_indexB].v,e=a.velocities[this.m_indexB].w,f=this.m_invMassA,g=this.m_invMassB,h=this.m_invIA,k=this.m_invIB;if(0<this.m_frequencyHz){var l=-this.m_mass.ez.z*(e-c+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=l;c-=h*l;e+=k*l;l=box2d.b2SubVV(box2d.b2AddVCrossSV(d,e,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(b,c,this.m_rA,box2d.b2Vec2.s_t1),
box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1);l=box2d.b2MulM33XY(this.m_mass,l.x,l.y,box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse1).SelfNeg();this.m_impulse.x+=l.x;this.m_impulse.y+=l.y;b.SelfMulSub(f,l);c-=h*box2d.b2CrossVV(this.m_rA,l);d.SelfMulAdd(g,l);e+=k*box2d.b2CrossVV(this.m_rB,l)}else{l=box2d.b2SubVV(box2d.b2AddVCrossSV(d,e,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(b,c,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1);
var m=box2d.b2MulM33XYZ(this.m_mass,l.x,l.y,e-c,box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse).SelfNeg();this.m_impulse.SelfAdd(m);l=box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_P.SetXY(m.x,m.y);b.SelfMulSub(f,l);c-=h*(box2d.b2CrossVV(this.m_rA,l)+m.z);d.SelfMulAdd(g,l);e+=k*(box2d.b2CrossVV(this.m_rB,l)+m.z)}a.velocities[this.m_indexA].w=c;a.velocities[this.m_indexB].w=e};box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1=new box2d.b2Vec2;
box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse1=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec3;box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2WeldJoint.prototype.SolvePositionConstraints=function(a){var b=a.positions[this.m_indexA].c,c=a.positions[this.m_indexA].a,d=a.positions[this.m_indexB].c,e=a.positions[this.m_indexB].a,f=this.m_qA.SetAngleRadians(c),g=this.m_qB.SetAngleRadians(e),h=this.m_invMassA,k=this.m_invMassB,l=this.m_invIA,m=this.m_invIB;box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var n=box2d.b2MulRV(f,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);
var p=box2d.b2MulRV(g,this.m_lalcB,this.m_rB),q=this.m_K;q.ex.x=h+k+n.y*n.y*l+p.y*p.y*m;q.ey.x=-n.y*n.x*l-p.y*p.x*m;q.ez.x=-n.y*l-p.y*m;q.ex.y=q.ey.x;q.ey.y=h+k+n.x*n.x*l+p.x*p.x*m;q.ez.y=n.x*l+p.x*m;q.ex.z=q.ez.x;q.ey.z=q.ez.y;q.ez.z=l+m;if(0<this.m_frequencyHz){var r=box2d.b2SubVV(box2d.b2AddVV(d,p,box2d.b2Vec2.s_t0),box2d.b2AddVV(b,n,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1);g=r.GetLength();f=0;q=q.Solve22(r.x,r.y,box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P).SelfNeg();
b.SelfMulSub(h,q);c-=l*box2d.b2CrossVV(n,q);d.SelfMulAdd(k,q);e+=m*box2d.b2CrossVV(p,q)}else r=box2d.b2SubVV(box2d.b2AddVV(d,p,box2d.b2Vec2.s_t0),box2d.b2AddVV(b,n,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1),n=e-c-this.m_referenceAngle,g=r.GetLength(),f=box2d.b2Abs(n),n=q.Solve33(r.x,r.y,n,box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse).SelfNeg(),q=box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P.SetXY(n.x,n.y),b.SelfMulSub(h,q),c-=l*(box2d.b2CrossVV(this.m_rA,
q)+n.z),d.SelfMulAdd(k,q),e+=m*(box2d.b2CrossVV(this.m_rB,q)+n.z);a.positions[this.m_indexA].a=c;a.positions[this.m_indexB].a=e;return g<=box2d.b2_linearSlop&&f<=box2d.b2_angularSlop};box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec3;
box2d.b2WeldJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};box2d.b2WeldJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};box2d.b2WeldJoint.prototype.GetReactionForce=function(a,b){return b.SetXY(a*this.m_impulse.x,a*this.m_impulse.y)};box2d.b2WeldJoint.prototype.GetReactionTorque=function(a){return a*this.m_impulse.z};box2d.b2WeldJoint.prototype.GetLocalAnchorA=function(a){return a.Copy(this.m_localAnchorA)};
box2d.b2WeldJoint.prototype.GetLocalAnchorB=function(a){return a.Copy(this.m_localAnchorB)};box2d.b2WeldJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle};box2d.b2WeldJoint.prototype.SetFrequency=function(a){this.m_frequencyHz=a};box2d.b2WeldJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};box2d.b2WeldJoint.prototype.SetDampingRatio=function(a){this.m_dampingRatio=a};box2d.b2WeldJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};
box2d.b2WeldJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2WeldJointDef*/ var jd = new box2d.b2WeldJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",
this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle);box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz);box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};box2d.b2RopeJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_ropeJoint);this.localAnchorA=new box2d.b2Vec2(-1,0);this.localAnchorB=new box2d.b2Vec2(1,0)};
goog.inherits(box2d.b2RopeJointDef,box2d.b2JointDef);box2d.b2RopeJointDef.prototype.localAnchorA=null;box2d.b2RopeJointDef.prototype.localAnchorB=null;box2d.b2RopeJointDef.prototype.maxLength=0;
box2d.b2RopeJoint=function(a){box2d.b2Joint.call(this,a);this.m_localAnchorA=a.localAnchorA.Clone();this.m_localAnchorB=a.localAnchorB.Clone();this.m_maxLength=a.maxLength;this.m_u=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2};goog.inherits(box2d.b2RopeJoint,box2d.b2Joint);
box2d.b2RopeJoint.prototype.m_localAnchorA=null;box2d.b2RopeJoint.prototype.m_localAnchorB=null;box2d.b2RopeJoint.prototype.m_maxLength=0;box2d.b2RopeJoint.prototype.m_length=0;box2d.b2RopeJoint.prototype.m_impulse=0;box2d.b2RopeJoint.prototype.m_indexA=0;box2d.b2RopeJoint.prototype.m_indexB=0;box2d.b2RopeJoint.prototype.m_u=null;box2d.b2RopeJoint.prototype.m_rA=null;box2d.b2RopeJoint.prototype.m_rB=null;box2d.b2RopeJoint.prototype.m_localCenterA=null;box2d.b2RopeJoint.prototype.m_localCenterB=null;
box2d.b2RopeJoint.prototype.m_invMassA=0;box2d.b2RopeJoint.prototype.m_invMassB=0;box2d.b2RopeJoint.prototype.m_invIA=0;box2d.b2RopeJoint.prototype.m_invIB=0;box2d.b2RopeJoint.prototype.m_mass=0;box2d.b2RopeJoint.prototype.m_state=box2d.b2LimitState.e_inactiveLimit;box2d.b2RopeJoint.prototype.m_qA=null;box2d.b2RopeJoint.prototype.m_qB=null;box2d.b2RopeJoint.prototype.m_lalcA=null;box2d.b2RopeJoint.prototype.m_lalcB=null;
box2d.b2RopeJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexA].c,c=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,
e=a.positions[this.m_indexB].c,f=a.positions[this.m_indexB].a,g=a.velocities[this.m_indexB].v,h=a.velocities[this.m_indexB].w,k=this.m_qA.SetAngleRadians(a.positions[this.m_indexA].a);f=this.m_qB.SetAngleRadians(f);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2MulRV(k,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2MulRV(f,this.m_lalcB,this.m_rB);this.m_u.Copy(e).SelfAdd(this.m_rB).SelfSub(b).SelfSub(this.m_rA);this.m_length=
this.m_u.GetLength();this.m_state=0<this.m_length-this.m_maxLength?box2d.b2LimitState.e_atUpperLimit:box2d.b2LimitState.e_inactiveLimit;this.m_length>box2d.b2_linearSlop?(this.m_u.SelfMul(1/this.m_length),b=box2d.b2CrossVV(this.m_rA,this.m_u),e=box2d.b2CrossVV(this.m_rB,this.m_u),b=this.m_invMassA+this.m_invIA*b*b+this.m_invMassB+this.m_invIB*e*e,this.m_mass=0!==b?1/b:0,a.step.warmStarting?(this.m_impulse*=a.step.dtRatio,b=box2d.b2MulSV(this.m_impulse,this.m_u,box2d.b2RopeJoint.prototype.InitVelocityConstraints.s_P),
c.SelfMulSub(this.m_invMassA,b),d-=this.m_invIA*box2d.b2CrossVV(this.m_rA,b),g.SelfMulAdd(this.m_invMassB,b),h+=this.m_invIB*box2d.b2CrossVV(this.m_rB,b)):this.m_impulse=0,a.velocities[this.m_indexA].w=d,a.velocities[this.m_indexB].w=h):(this.m_u.SetZero(),this.m_impulse=this.m_mass=0)};box2d.b2RopeJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2RopeJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,c=a.velocities[this.m_indexA].w,d=a.velocities[this.m_indexB].v,e=a.velocities[this.m_indexB].w,f=box2d.b2AddVCrossSV(b,c,this.m_rA,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpA),g=box2d.b2AddVCrossSV(d,e,this.m_rB,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpB),h=this.m_length-this.m_maxLength;f=box2d.b2DotVV(this.m_u,box2d.b2SubVV(g,f,box2d.b2Vec2.s_t0));0>h&&(f+=a.step.inv_dt*
h);h=-this.m_mass*f;f=this.m_impulse;this.m_impulse=box2d.b2Min(0,this.m_impulse+h);h=this.m_impulse-f;h=box2d.b2MulSV(h,this.m_u,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_P);b.SelfMulSub(this.m_invMassA,h);c-=this.m_invIA*box2d.b2CrossVV(this.m_rA,h);d.SelfMulAdd(this.m_invMassB,h);e+=this.m_invIB*box2d.b2CrossVV(this.m_rB,h);a.velocities[this.m_indexA].w=c;a.velocities[this.m_indexB].w=e};box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2;
box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2;box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2RopeJoint.prototype.SolvePositionConstraints=function(a){var b=a.positions[this.m_indexA].c,c=a.positions[this.m_indexA].a,d=a.positions[this.m_indexB].c,e=a.positions[this.m_indexB].a,f=this.m_qA.SetAngleRadians(c),g=this.m_qB.SetAngleRadians(e);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);f=box2d.b2MulRV(f,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);g=box2d.b2MulRV(g,this.m_lalcB,this.m_rB);var h=this.m_u.Copy(d).SelfAdd(g).SelfSub(b).SelfSub(f),
k=h.Normalize(),l=k-this.m_maxLength;l=box2d.b2Clamp(l,0,box2d.b2_maxLinearCorrection);h=box2d.b2MulSV(-this.m_mass*l,h,box2d.b2RopeJoint.prototype.SolvePositionConstraints.s_P);b.SelfMulSub(this.m_invMassA,h);c-=this.m_invIA*box2d.b2CrossVV(f,h);d.SelfMulAdd(this.m_invMassB,h);e+=this.m_invIB*box2d.b2CrossVV(g,h);a.positions[this.m_indexA].a=c;a.positions[this.m_indexB].a=e;return k-this.m_maxLength<box2d.b2_linearSlop};box2d.b2RopeJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;
box2d.b2RopeJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};box2d.b2RopeJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};box2d.b2RopeJoint.prototype.GetReactionForce=function(a,b){return box2d.b2MulSV(a*this.m_impulse,this.m_u,b)};box2d.b2RopeJoint.prototype.GetReactionTorque=function(a){return 0};box2d.b2RopeJoint.prototype.GetLocalAnchorA=function(a){return a.Copy(this.m_localAnchorA)};
box2d.b2RopeJoint.prototype.GetLocalAnchorB=function(a){return a.Copy(this.m_localAnchorB)};box2d.b2RopeJoint.prototype.SetMaxLength=function(a){this.m_maxLength=a};box2d.b2RopeJoint.prototype.GetMaxLength=function(){return this.m_maxLength};box2d.b2RopeJoint.prototype.GetLimitState=function(){return this.m_state};
box2d.b2RopeJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2RopeJointDef*/ var jd = new box2d.b2RopeJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",
this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.maxLength = %.15f;\n",this.m_maxLength);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};box2d.b2GravityController=function(){box2d.b2Controller.call(this)};goog.inherits(box2d.b2GravityController,box2d.b2Controller);box2d.b2GravityController.prototype.G=1;box2d.b2GravityController.prototype.invSqr=!0;
box2d.b2GravityController.prototype.Step=function(a){if(this.invSqr)for(a=this.m_bodyList;a;a=a.nextBody)for(var b=a.body,c=b.GetWorldCenter(),d=b.GetMass(),e=this.m_bodyList;e!==a;e=e.nextBody){var f=e.body,g=f.GetWorldCenter(),h=f.GetMass(),k=g.x-c.x,l=g.y-c.y,m=k*k+l*l;m<box2d.b2_epsilon||(k=box2d.b2GravityController.prototype.Step.s_f.SetXY(k,l),k.SelfMul(this.G/m/box2d.b2Sqrt(m)*d*h),b.IsAwake()&&b.ApplyForce(k,c),f.IsAwake()&&f.ApplyForce(k.SelfMul(-1),g))}else for(a=this.m_bodyList;a;a=a.nextBody)for(b=
a.body,c=b.GetWorldCenter(),d=b.GetMass(),e=this.m_bodyList;e!==a;e=e.nextBody)f=e.body,g=f.GetWorldCenter(),h=f.GetMass(),k=g.x-c.x,l=g.y-c.y,m=k*k+l*l,m<box2d.b2_epsilon||(k=box2d.b2GravityController.prototype.Step.s_f.SetXY(k,l),k.SelfMul(this.G/m*d*h),b.IsAwake()&&b.ApplyForce(k,c),f.IsAwake()&&f.ApplyForce(k.SelfMul(-1),g))};box2d.b2GravityController.prototype.Step.s_f=new box2d.b2Vec2;box2d.b2Profile=function(){};box2d.b2Profile.prototype.step=0;box2d.b2Profile.prototype.collide=0;
box2d.b2Profile.prototype.solve=0;box2d.b2Profile.prototype.solveInit=0;box2d.b2Profile.prototype.solveVelocity=0;box2d.b2Profile.prototype.solvePosition=0;box2d.b2Profile.prototype.broadphase=0;box2d.b2Profile.prototype.solveTOI=0;box2d.b2Profile.prototype.Reset=function(){this.solveTOI=this.broadphase=this.solvePosition=this.solveVelocity=this.solveInit=this.solve=this.collide=this.step=0;return this};box2d.b2TimeStep=function(){};box2d.b2TimeStep.prototype.dt=0;
box2d.b2TimeStep.prototype.inv_dt=0;box2d.b2TimeStep.prototype.dtRatio=0;box2d.b2TimeStep.prototype.velocityIterations=0;box2d.b2TimeStep.prototype.positionIterations=0;box2d.b2TimeStep.prototype.warmStarting=!1;box2d.b2TimeStep.prototype.Copy=function(a){this.dt=a.dt;this.inv_dt=a.inv_dt;this.dtRatio=a.dtRatio;this.positionIterations=a.positionIterations;this.velocityIterations=a.velocityIterations;this.warmStarting=a.warmStarting;return this};box2d.b2Position=function(){this.c=new box2d.b2Vec2};
box2d.b2Position.prototype.c=null;box2d.b2Position.prototype.a=0;box2d.b2Position.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2Position})};box2d.b2Velocity=function(){this.v=new box2d.b2Vec2};box2d.b2Velocity.prototype.v=null;box2d.b2Velocity.prototype.w=0;box2d.b2Velocity.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2Velocity})};box2d.b2SolverData=function(){this.step=new box2d.b2TimeStep};box2d.b2SolverData.prototype.step=null;
box2d.b2SolverData.prototype.positions=null;box2d.b2SolverData.prototype.velocities=null;box2d.b2Collision={};box2d.b2ContactFeatureType={e_vertex:0,e_face:1};goog.exportProperty(box2d.b2ContactFeatureType,"e_vertex",box2d.b2ContactFeatureType.e_vertex);goog.exportProperty(box2d.b2ContactFeatureType,"e_face",box2d.b2ContactFeatureType.e_face);box2d.b2ContactFeature=function(a){this._id=a};box2d.b2ContactFeature.prototype._id=null;box2d.b2ContactFeature.prototype._indexA=0;
box2d.b2ContactFeature.prototype._indexB=0;box2d.b2ContactFeature.prototype._typeA=0;box2d.b2ContactFeature.prototype._typeB=0;Object.defineProperty(box2d.b2ContactFeature.prototype,"indexA",{enumerable:!1,configurable:!0,get:function(){return this._indexA},set:function(a){this._indexA=a;this._id._key=this._id._key&4294967040|this._indexA&255}});
Object.defineProperty(box2d.b2ContactFeature.prototype,"indexB",{enumerable:!1,configurable:!0,get:function(){return this._indexB},set:function(a){this._indexB=a;this._id._key=this._id._key&4294902015|this._indexB<<8&65280}});Object.defineProperty(box2d.b2ContactFeature.prototype,"typeA",{enumerable:!1,configurable:!0,get:function(){return this._typeA},set:function(a){this._typeA=a;this._id._key=this._id._key&4278255615|this._typeA<<16&16711680}});
Object.defineProperty(box2d.b2ContactFeature.prototype,"typeB",{enumerable:!1,configurable:!0,get:function(){return this._typeB},set:function(a){this._typeB=a;this._id._key=this._id._key&16777215|this._typeB<<24&4278190080}});box2d.b2ContactID=function(){this.cf=new box2d.b2ContactFeature(this)};box2d.b2ContactID.prototype.cf=null;box2d.b2ContactID.prototype.key=0;box2d.b2ContactID.prototype.Copy=function(a){this.key=a.key;return this};box2d.b2ContactID.prototype.Clone=function(){return(new box2d.b2ContactID).Copy(this)};
Object.defineProperty(box2d.b2ContactID.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key},set:function(a){this._key=a;this.cf._indexA=this._key&255;this.cf._indexB=this._key>>8&255;this.cf._typeA=this._key>>16&255;this.cf._typeB=this._key>>24&255}});box2d.b2ManifoldPoint=function(){this.localPoint=new box2d.b2Vec2;this.id=new box2d.b2ContactID};box2d.b2ManifoldPoint.prototype.localPoint=null;box2d.b2ManifoldPoint.prototype.normalImpulse=0;
box2d.b2ManifoldPoint.prototype.tangentImpulse=0;box2d.b2ManifoldPoint.prototype.id=null;box2d.b2ManifoldPoint.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2ManifoldPoint})};box2d.b2ManifoldPoint.prototype.Reset=function(){this.localPoint.SetZero();this.tangentImpulse=this.normalImpulse=0;this.id.key=0};
box2d.b2ManifoldPoint.prototype.Copy=function(a){this.localPoint.Copy(a.localPoint);this.normalImpulse=a.normalImpulse;this.tangentImpulse=a.tangentImpulse;this.id.Copy(a.id);return this};box2d.b2ManifoldType={e_unknown:-1,e_circles:0,e_faceA:1,e_faceB:2};goog.exportProperty(box2d.b2ManifoldType,"e_unknown",box2d.b2ManifoldType.e_unknown);goog.exportProperty(box2d.b2ManifoldType,"e_circles",box2d.b2ManifoldType.e_circles);goog.exportProperty(box2d.b2ManifoldType,"e_faceA",box2d.b2ManifoldType.e_faceA);
goog.exportProperty(box2d.b2ManifoldType,"e_faceB",box2d.b2ManifoldType.e_faceB);box2d.b2Manifold=function(){this.points=box2d.b2ManifoldPoint.MakeArray(box2d.b2_maxManifoldPoints);this.localNormal=new box2d.b2Vec2;this.localPoint=new box2d.b2Vec2;this.type=box2d.b2ManifoldType.e_unknown;this.pointCount=0};box2d.b2Manifold.prototype.points=null;box2d.b2Manifold.prototype.localNormal=null;box2d.b2Manifold.prototype.localPoint=null;box2d.b2Manifold.prototype.type=box2d.b2ManifoldType.e_unknown;
box2d.b2Manifold.prototype.pointCount=0;box2d.b2Manifold.prototype.Reset=function(){for(var a=0,b=box2d.b2_maxManifoldPoints;a<b;++a)this.points[a].Reset();this.localNormal.SetZero();this.localPoint.SetZero();this.type=box2d.b2ManifoldType.e_unknown;this.pointCount=0};
box2d.b2Manifold.prototype.Copy=function(a){this.pointCount=a.pointCount;for(var b=0,c=box2d.b2_maxManifoldPoints;b<c;++b)this.points[b].Copy(a.points[b]);this.localNormal.Copy(a.localNormal);this.localPoint.Copy(a.localPoint);this.type=a.type;return this};box2d.b2Manifold.prototype.Clone=function(){return(new box2d.b2Manifold).Copy(this)};box2d.b2WorldManifold=function(){this.normal=new box2d.b2Vec2;this.points=box2d.b2Vec2.MakeArray(box2d.b2_maxManifoldPoints);this.separations=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints)};
box2d.b2WorldManifold.prototype.normal=null;box2d.b2WorldManifold.prototype.points=null;box2d.b2WorldManifold.prototype.separations=null;
box2d.b2WorldManifold.prototype.Initialize=function(a,b,c,d,e){if(0!==a.pointCount)switch(a.type){case box2d.b2ManifoldType.e_circles:this.normal.SetXY(1,0);b=box2d.b2MulXV(b,a.localPoint,box2d.b2WorldManifold.prototype.Initialize.s_pointA);a=box2d.b2MulXV(d,a.points[0].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_pointB);box2d.b2DistanceSquaredVV(b,a)>box2d.b2_epsilon_sq&&box2d.b2SubVV(a,b,this.normal).SelfNormalize();var f=box2d.b2AddVMulSV(b,c,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA),
g=box2d.b2SubVMulSV(a,e,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB);box2d.b2MidVV(f,g,this.points[0]);this.separations[0]=box2d.b2DotVV(box2d.b2SubVV(g,f,box2d.b2Vec2.s_t0),this.normal);break;case box2d.b2ManifoldType.e_faceA:box2d.b2MulRV(b.q,a.localNormal,this.normal);for(var h=box2d.b2MulXV(b,a.localPoint,box2d.b2WorldManifold.prototype.Initialize.s_planePoint),k=0,l=a.pointCount;k<l;++k){var m=box2d.b2MulXV(d,a.points[k].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_clipPoint);
f=c-box2d.b2DotVV(box2d.b2SubVV(m,h,box2d.b2Vec2.s_t0),this.normal);f=box2d.b2AddVMulSV(m,f,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA);g=box2d.b2SubVMulSV(m,e,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB);box2d.b2MidVV(f,g,this.points[k]);this.separations[k]=box2d.b2DotVV(box2d.b2SubVV(g,f,box2d.b2Vec2.s_t0),this.normal)}break;case box2d.b2ManifoldType.e_faceB:box2d.b2MulRV(d.q,a.localNormal,this.normal);h=box2d.b2MulXV(d,a.localPoint,box2d.b2WorldManifold.prototype.Initialize.s_planePoint);
k=0;for(l=a.pointCount;k<l;++k)m=box2d.b2MulXV(b,a.points[k].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_clipPoint),f=e-box2d.b2DotVV(box2d.b2SubVV(m,h,box2d.b2Vec2.s_t0),this.normal),g=box2d.b2AddVMulSV(m,f,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB),f=box2d.b2SubVMulSV(m,c,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA),box2d.b2MidVV(f,g,this.points[k]),this.separations[k]=box2d.b2DotVV(box2d.b2SubVV(f,g,box2d.b2Vec2.s_t0),this.normal);this.normal.SelfNeg()}};
box2d.b2WorldManifold.prototype.Initialize.s_pointA=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_pointB=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_cA=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_cB=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_planePoint=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_clipPoint=new box2d.b2Vec2;box2d.b2PointState={b2_nullState:0,b2_addState:1,b2_persistState:2,b2_removeState:3};
goog.exportProperty(box2d.b2PointState,"b2_nullState   ",box2d.b2PointState.b2_nullState);goog.exportProperty(box2d.b2PointState,"b2_addState    ",box2d.b2PointState.b2_addState);goog.exportProperty(box2d.b2PointState,"b2_persistState",box2d.b2PointState.b2_persistState);goog.exportProperty(box2d.b2PointState,"b2_removeState ",box2d.b2PointState.b2_removeState);
box2d.b2GetPointStates=function(a,b,c,d){for(var e=0,f=c.pointCount;e<f;++e){var g=c.points[e].id;g=g.key;a[e]=box2d.b2PointState.b2_removeState;for(var h=0,k=d.pointCount;h<k;++h)if(d.points[h].id.key===g){a[e]=box2d.b2PointState.b2_persistState;break}}for(f=box2d.b2_maxManifoldPoints;e<f;++e)a[e]=box2d.b2PointState.b2_nullState;e=0;for(f=d.pointCount;e<f;++e)for(g=d.points[e].id,g=g.key,b[e]=box2d.b2PointState.b2_addState,h=0,k=c.pointCount;h<k;++h)if(c.points[h].id.key===g){b[e]=box2d.b2PointState.b2_persistState;
break}for(f=box2d.b2_maxManifoldPoints;e<f;++e)b[e]=box2d.b2PointState.b2_nullState};box2d.b2ClipVertex=function(){this.v=new box2d.b2Vec2;this.id=new box2d.b2ContactID};box2d.b2ClipVertex.prototype.v=null;box2d.b2ClipVertex.prototype.id=null;box2d.b2ClipVertex.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2ClipVertex})};box2d.b2ClipVertex.prototype.Copy=function(a){this.v.Copy(a.v);this.id.Copy(a.id);return this};
box2d.b2RayCastInput=function(){this.p1=new box2d.b2Vec2;this.p2=new box2d.b2Vec2;this.maxFraction=1};box2d.b2RayCastInput.prototype.p1=null;box2d.b2RayCastInput.prototype.p2=null;box2d.b2RayCastInput.prototype.maxFraction=1;box2d.b2RayCastInput.prototype.Copy=function(a){this.p1.Copy(a.p1);this.p2.Copy(a.p2);this.maxFraction=a.maxFraction;return this};box2d.b2RayCastOutput=function(){this.normal=new box2d.b2Vec2;this.fraction=0};box2d.b2RayCastOutput.prototype.normal=null;
box2d.b2RayCastOutput.prototype.fraction=0;box2d.b2RayCastOutput.prototype.Copy=function(a){this.normal.Copy(a.normal);this.fraction=a.fraction;return this};box2d.b2AABB=function(){this.lowerBound=new box2d.b2Vec2;this.upperBound=new box2d.b2Vec2;this.m_out_center=new box2d.b2Vec2;this.m_out_extent=new box2d.b2Vec2};box2d.b2AABB.prototype.lowerBound=null;box2d.b2AABB.prototype.upperBound=null;box2d.b2AABB.prototype.m_out_center=null;box2d.b2AABB.prototype.m_out_extent=null;
box2d.b2AABB.prototype.Copy=function(a){this.lowerBound.Copy(a.lowerBound);this.upperBound.Copy(a.upperBound);return this};box2d.b2AABB.prototype.IsValid=function(){var a=this.upperBound.y-this.lowerBound.y;return 0<=this.upperBound.x-this.lowerBound.x&&0<=a&&this.lowerBound.IsValid()&&this.upperBound.IsValid()};box2d.b2AABB.prototype.GetCenter=function(){return box2d.b2MidVV(this.lowerBound,this.upperBound,this.m_out_center)};
box2d.b2AABB.prototype.GetExtents=function(){return box2d.b2ExtVV(this.lowerBound,this.upperBound,this.m_out_extent)};box2d.b2AABB.prototype.GetPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+(this.upperBound.y-this.lowerBound.y))};
box2d.b2AABB.prototype.Combine1=function(a){this.lowerBound.x=box2d.b2Min(this.lowerBound.x,a.lowerBound.x);this.lowerBound.y=box2d.b2Min(this.lowerBound.y,a.lowerBound.y);this.upperBound.x=box2d.b2Max(this.upperBound.x,a.upperBound.x);this.upperBound.y=box2d.b2Max(this.upperBound.y,a.upperBound.y);return this};
box2d.b2AABB.prototype.Combine2=function(a,b){this.lowerBound.x=box2d.b2Min(a.lowerBound.x,b.lowerBound.x);this.lowerBound.y=box2d.b2Min(a.lowerBound.y,b.lowerBound.y);this.upperBound.x=box2d.b2Max(a.upperBound.x,b.upperBound.x);this.upperBound.y=box2d.b2Max(a.upperBound.y,b.upperBound.y);return this};box2d.b2AABB.Combine=function(a,b,c){c.Combine2(a,b);return c};
box2d.b2AABB.prototype.Contains=function(a){var b;return b=(b=(b=(b=this.lowerBound.x<=a.lowerBound.x)&&this.lowerBound.y<=a.lowerBound.y)&&a.upperBound.x<=this.upperBound.x)&&a.upperBound.y<=this.upperBound.y};
box2d.b2AABB.prototype.RayCast=function(a,b){var c=-box2d.b2_maxFloat,d=box2d.b2_maxFloat,e=b.p1.x,f=b.p1.y,g=b.p2.x-b.p1.x,h=b.p2.y-b.p1.y,k=box2d.b2Abs(g),l=box2d.b2Abs(h),m=a.normal;if(k<box2d.b2_epsilon){if(e<this.lowerBound.x||this.upperBound.x<e)return!1}else if(k=1/g,g=(this.lowerBound.x-e)*k,e=(this.upperBound.x-e)*k,k=-1,g>e&&(k=g,g=e,e=k,k=1),g>c&&(m.x=k,m.y=0,c=g),d=box2d.b2Min(d,e),c>d)return!1;if(l<box2d.b2_epsilon){if(f<this.lowerBound.y||this.upperBound.y<f)return!1}else if(k=1/h,g=
(this.lowerBound.y-f)*k,e=(this.upperBound.y-f)*k,k=-1,g>e&&(k=g,g=e,e=k,k=1),g>c&&(m.x=0,m.y=k,c=g),d=box2d.b2Min(d,e),c>d)return!1;if(0>c||b.maxFraction<c)return!1;a.fraction=c;return!0};box2d.b2AABB.prototype.TestOverlap=function(a){var b=a.lowerBound.y-this.upperBound.y,c=this.lowerBound.y-a.upperBound.y;return 0<a.lowerBound.x-this.upperBound.x||0<b||0<this.lowerBound.x-a.upperBound.x||0<c?!1:!0};
box2d.b2TestOverlapAABB=function(a,b){var c=b.lowerBound.y-a.upperBound.y,d=a.lowerBound.y-b.upperBound.y;return 0<b.lowerBound.x-a.upperBound.x||0<c||0<a.lowerBound.x-b.upperBound.x||0<d?!1:!0};
box2d.b2ClipSegmentToLine=function(a,b,c,d,e){var f=0,g=b[0];b=b[1];var h=box2d.b2DotVV(c,g.v)-d;c=box2d.b2DotVV(c,b.v)-d;0>=h&&a[f++].Copy(g);0>=c&&a[f++].Copy(b);0>h*c&&(c=h/(h-c),d=a[f].v,d.x=g.v.x+c*(b.v.x-g.v.x),d.y=g.v.y+c*(b.v.y-g.v.y),a=a[f].id,a.cf.indexA=e,a.cf.indexB=g.id.cf.indexB,a.cf.typeA=box2d.b2ContactFeatureType.e_vertex,a.cf.typeB=box2d.b2ContactFeatureType.e_face,++f);return f};
box2d.b2TestOverlapShape=function(a,b,c,d,e,f){var g=box2d.b2TestOverlapShape.s_input.Reset();g.proxyA.SetShape(a,b);g.proxyB.SetShape(c,d);g.transformA.Copy(e);g.transformB.Copy(f);g.useRadii=!0;a=box2d.b2TestOverlapShape.s_simplexCache.Reset();a.count=0;b=box2d.b2TestOverlapShape.s_output.Reset();box2d.b2Distance(b,a,g);return b.distance<10*box2d.b2_epsilon};box2d.b2TestOverlapShape.s_input=new box2d.b2DistanceInput;box2d.b2TestOverlapShape.s_simplexCache=new box2d.b2SimplexCache;
box2d.b2TestOverlapShape.s_output=new box2d.b2DistanceOutput;box2d.b2Timer=function(){this.m_start=(new Date).getTime()};box2d.b2Timer.prototype.m_start=0;box2d.b2Timer.prototype.Reset=function(){this.m_start=(new Date).getTime();return this};box2d.b2Timer.prototype.GetMilliseconds=function(){return(new Date).getTime()-this.m_start};box2d.b2Counter=function(){};box2d.b2Counter.prototype.m_count=0;box2d.b2Counter.prototype.m_min_count=0;box2d.b2Counter.prototype.m_max_count=0;
box2d.b2Counter.prototype.GetCount=function(){return this.m_count};box2d.b2Counter.prototype.GetMinCount=function(){return this.m_min_count};box2d.b2Counter.prototype.GetMaxCount=function(){return this.m_max_count};box2d.b2Counter.prototype.ResetCount=function(){var a=this.m_count;this.m_count=0;return a};box2d.b2Counter.prototype.ResetMinCount=function(){this.m_min_count=0};box2d.b2Counter.prototype.ResetMaxCount=function(){this.m_max_count=0};
box2d.b2Counter.prototype.Increment=function(){this.m_count++;this.m_max_count<this.m_count&&(this.m_max_count=this.m_count)};box2d.b2Counter.prototype.Decrement=function(){this.m_count--;this.m_min_count>this.m_count&&(this.m_min_count=this.m_count)};box2d.b2_toiTime=0;box2d.b2_toiMaxTime=0;box2d.b2_toiCalls=0;box2d.b2_toiIters=0;box2d.b2_toiMaxIters=0;box2d.b2_toiRootIters=0;box2d.b2_toiMaxRootIters=0;
box2d.b2TOIInput=function(){this.proxyA=new box2d.b2DistanceProxy;this.proxyB=new box2d.b2DistanceProxy;this.sweepA=new box2d.b2Sweep;this.sweepB=new box2d.b2Sweep};box2d.b2TOIInput.prototype.proxyA=null;box2d.b2TOIInput.prototype.proxyB=null;box2d.b2TOIInput.prototype.sweepA=null;box2d.b2TOIInput.prototype.sweepB=null;box2d.b2TOIInput.prototype.tMax=0;box2d.b2TOIOutputState={e_unknown:0,e_failed:1,e_overlapped:2,e_touching:3,e_separated:4};goog.exportProperty(box2d.b2TOIOutputState,"e_unknown",box2d.b2TOIOutputState.e_unknown);
goog.exportProperty(box2d.b2TOIOutputState,"e_failed",box2d.b2TOIOutputState.e_failed);goog.exportProperty(box2d.b2TOIOutputState,"e_overlapped",box2d.b2TOIOutputState.e_overlapped);goog.exportProperty(box2d.b2TOIOutputState,"e_touching",box2d.b2TOIOutputState.e_touching);goog.exportProperty(box2d.b2TOIOutputState,"e_separated",box2d.b2TOIOutputState.e_separated);box2d.b2TOIOutput=function(){};box2d.b2TOIOutput.prototype.state=box2d.b2TOIOutputState.e_unknown;box2d.b2TOIOutput.prototype.t=0;
box2d.b2SeparationFunctionType={e_unknown:-1,e_points:0,e_faceA:1,e_faceB:2};goog.exportProperty(box2d.b2SeparationFunctionType,"e_unknown",box2d.b2SeparationFunctionType.e_unknown);goog.exportProperty(box2d.b2SeparationFunctionType,"e_points",box2d.b2SeparationFunctionType.e_points);goog.exportProperty(box2d.b2SeparationFunctionType,"e_faceA",box2d.b2SeparationFunctionType.e_faceA);goog.exportProperty(box2d.b2SeparationFunctionType,"e_faceB",box2d.b2SeparationFunctionType.e_faceB);
box2d.b2SeparationFunction=function(){this.m_sweepA=new box2d.b2Sweep;this.m_sweepB=new box2d.b2Sweep;this.m_localPoint=new box2d.b2Vec2;this.m_axis=new box2d.b2Vec2};box2d.b2SeparationFunction.prototype.m_proxyA=null;box2d.b2SeparationFunction.prototype.m_proxyB=null;box2d.b2SeparationFunction.prototype.m_sweepA=null;box2d.b2SeparationFunction.prototype.m_sweepB=null;box2d.b2SeparationFunction.prototype.m_type=box2d.b2SeparationFunctionType.e_unknown;
box2d.b2SeparationFunction.prototype.m_localPoint=null;box2d.b2SeparationFunction.prototype.m_axis=null;
box2d.b2SeparationFunction.prototype.Initialize=function(a,b,c,d,e,f){this.m_proxyA=b;this.m_proxyB=d;b=a.count;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<b&&3>b);this.m_sweepA.Copy(c);this.m_sweepB.Copy(e);c=box2d.b2TimeOfImpact.s_xfA;e=box2d.b2TimeOfImpact.s_xfB;this.m_sweepA.GetTransform(c,f);this.m_sweepB.GetTransform(e,f);1===b?(this.m_type=box2d.b2SeparationFunctionType.e_points,b=this.m_proxyA.GetVertex(a.indexA[0]),a=this.m_proxyB.GetVertex(a.indexB[0]),c=box2d.b2MulXV(c,b,box2d.b2TimeOfImpact.s_pointA),
e=box2d.b2MulXV(e,a,box2d.b2TimeOfImpact.s_pointB),box2d.b2SubVV(e,c,this.m_axis),a=this.m_axis.Normalize()):(a.indexA[0]===a.indexA[1]?(this.m_type=box2d.b2SeparationFunctionType.e_faceB,b=this.m_proxyB.GetVertex(a.indexB[0]),d=this.m_proxyB.GetVertex(a.indexB[1]),box2d.b2CrossVOne(box2d.b2SubVV(d,b,box2d.b2Vec2.s_t0),this.m_axis).SelfNormalize(),f=box2d.b2MulRV(e.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),box2d.b2MidVV(b,d,this.m_localPoint),e=box2d.b2MulXV(e,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),
b=this.m_proxyA.GetVertex(a.indexA[0]),c=box2d.b2MulXV(c,b,box2d.b2TimeOfImpact.s_pointA),a=box2d.b2DotVV(box2d.b2SubVV(c,e,box2d.b2Vec2.s_t0),f)):(this.m_type=box2d.b2SeparationFunctionType.e_faceA,b=this.m_proxyA.GetVertex(a.indexA[0]),d=this.m_proxyA.GetVertex(a.indexA[1]),box2d.b2CrossVOne(box2d.b2SubVV(d,b,box2d.b2Vec2.s_t0),this.m_axis).SelfNormalize(),f=box2d.b2MulRV(c.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),box2d.b2MidVV(b,d,this.m_localPoint),c=box2d.b2MulXV(c,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),
a=this.m_proxyB.GetVertex(a.indexB[0]),e=box2d.b2MulXV(e,a,box2d.b2TimeOfImpact.s_pointB),a=box2d.b2DotVV(box2d.b2SubVV(e,c,box2d.b2Vec2.s_t0),f)),0>a&&(this.m_axis.SelfNeg(),a=-a));return a};
box2d.b2SeparationFunction.prototype.FindMinSeparation=function(a,b,c){var d=box2d.b2TimeOfImpact.s_xfA,e=box2d.b2TimeOfImpact.s_xfB;this.m_sweepA.GetTransform(d,c);this.m_sweepB.GetTransform(e,c);switch(this.m_type){case box2d.b2SeparationFunctionType.e_points:var f=box2d.b2MulTRV(d.q,this.m_axis,box2d.b2TimeOfImpact.s_axisA),g=box2d.b2MulTRV(e.q,box2d.b2NegV(this.m_axis,box2d.b2Vec2.s_t0),box2d.b2TimeOfImpact.s_axisB);a[0]=this.m_proxyA.GetSupport(f);b[0]=this.m_proxyB.GetSupport(g);a=this.m_proxyA.GetVertex(a[0]);
b=this.m_proxyB.GetVertex(b[0]);d=box2d.b2MulXV(d,a,box2d.b2TimeOfImpact.s_pointA);e=box2d.b2MulXV(e,b,box2d.b2TimeOfImpact.s_pointB);return b=box2d.b2DotVV(box2d.b2SubVV(e,d,box2d.b2Vec2.s_t0),this.m_axis);case box2d.b2SeparationFunctionType.e_faceA:return c=box2d.b2MulRV(d.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),d=box2d.b2MulXV(d,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),g=box2d.b2MulTRV(e.q,box2d.b2NegV(c,box2d.b2Vec2.s_t0),box2d.b2TimeOfImpact.s_axisB),a[0]=-1,b[0]=this.m_proxyB.GetSupport(g),
b=this.m_proxyB.GetVertex(b[0]),e=box2d.b2MulXV(e,b,box2d.b2TimeOfImpact.s_pointB),b=box2d.b2DotVV(box2d.b2SubVV(e,d,box2d.b2Vec2.s_t0),c);case box2d.b2SeparationFunctionType.e_faceB:return c=box2d.b2MulRV(e.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),e=box2d.b2MulXV(e,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),f=box2d.b2MulTRV(d.q,box2d.b2NegV(c,box2d.b2Vec2.s_t0),box2d.b2TimeOfImpact.s_axisA),b[0]=-1,a[0]=this.m_proxyA.GetSupport(f),a=this.m_proxyA.GetVertex(a[0]),d=box2d.b2MulXV(d,a,box2d.b2TimeOfImpact.s_pointA),
b=box2d.b2DotVV(box2d.b2SubVV(d,e,box2d.b2Vec2.s_t0),c);default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),a[0]=-1,b[0]=-1,0}};
box2d.b2SeparationFunction.prototype.Evaluate=function(a,b,c){var d=box2d.b2TimeOfImpact.s_xfA,e=box2d.b2TimeOfImpact.s_xfB;this.m_sweepA.GetTransform(d,c);this.m_sweepB.GetTransform(e,c);switch(this.m_type){case box2d.b2SeparationFunctionType.e_points:return a=this.m_proxyA.GetVertex(a),b=this.m_proxyB.GetVertex(b),d=box2d.b2MulXV(d,a,box2d.b2TimeOfImpact.s_pointA),e=box2d.b2MulXV(e,b,box2d.b2TimeOfImpact.s_pointB),d=box2d.b2DotVV(box2d.b2SubVV(e,d,box2d.b2Vec2.s_t0),this.m_axis);case box2d.b2SeparationFunctionType.e_faceA:return c=
box2d.b2MulRV(d.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),d=box2d.b2MulXV(d,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),b=this.m_proxyB.GetVertex(b),e=box2d.b2MulXV(e,b,box2d.b2TimeOfImpact.s_pointB),d=box2d.b2DotVV(box2d.b2SubVV(e,d,box2d.b2Vec2.s_t0),c);case box2d.b2SeparationFunctionType.e_faceB:return c=box2d.b2MulRV(e.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),e=box2d.b2MulXV(e,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),a=this.m_proxyA.GetVertex(a),d=box2d.b2MulXV(d,a,box2d.b2TimeOfImpact.s_pointA),
d=box2d.b2DotVV(box2d.b2SubVV(d,e,box2d.b2Vec2.s_t0),c);default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0}};
box2d.b2TimeOfImpact=function(a,b){var c=box2d.b2TimeOfImpact.s_timer.Reset();++box2d.b2_toiCalls;a.state=box2d.b2TOIOutputState.e_unknown;a.t=b.tMax;var d=b.proxyA,e=b.proxyB,f=box2d.b2TimeOfImpact.s_sweepA.Copy(b.sweepA),g=box2d.b2TimeOfImpact.s_sweepB.Copy(b.sweepB);f.Normalize();g.Normalize();var h=b.tMax,k=box2d.b2Max(box2d.b2_linearSlop,d.m_radius+e.m_radius-3*box2d.b2_linearSlop),l=.25*box2d.b2_linearSlop;box2d.ENABLE_ASSERTS&&box2d.b2Assert(k>l);var m=0,n=0,p=box2d.b2TimeOfImpact.s_cache;
p.count=0;var q=box2d.b2TimeOfImpact.s_distanceInput;q.proxyA=b.proxyA;q.proxyB=b.proxyB;for(q.useRadii=!1;;){var r=box2d.b2TimeOfImpact.s_xfA,t=box2d.b2TimeOfImpact.s_xfB;f.GetTransform(r,m);g.GetTransform(t,m);q.transformA.Copy(r);q.transformB.Copy(t);r=box2d.b2TimeOfImpact.s_distanceOutput;box2d.b2Distance(r,p,q);if(0>=r.distance){a.state=box2d.b2TOIOutputState.e_overlapped;a.t=0;break}if(r.distance<k+l){a.state=box2d.b2TOIOutputState.e_touching;a.t=m;break}r=box2d.b2TimeOfImpact.s_fcn;r.Initialize(p,
d,f,e,g,m);t=!1;for(var u=h,w=0;;){var x=box2d.b2TimeOfImpact.s_indexA,A=box2d.b2TimeOfImpact.s_indexB,B=r.FindMinSeparation(x,A,u);if(B>k+l){a.state=box2d.b2TOIOutputState.e_separated;a.t=h;t=!0;break}if(B>k-l){m=u;break}var v=r.Evaluate(x[0],A[0],m);if(v<k-l){a.state=box2d.b2TOIOutputState.e_failed;a.t=m;t=!0;break}if(v<=k+l){a.state=box2d.b2TOIOutputState.e_touching;a.t=m;t=!0;break}for(var y=0,E=m,F=u;;){var D=y&1?E+(k-v)*(F-E)/(B-v):.5*(E+F);++y;++box2d.b2_toiRootIters;var z=r.Evaluate(x[0],
A[0],D);if(box2d.b2Abs(z-k)<l){u=D;break}z>k?(E=D,v=z):(F=D,B=z);if(50===y)break}box2d.b2_toiMaxRootIters=box2d.b2Max(box2d.b2_toiMaxRootIters,y);++w;if(w===box2d.b2_maxPolygonVertices)break}++n;++box2d.b2_toiIters;if(t)break;if(20===n){a.state=box2d.b2TOIOutputState.e_failed;a.t=m;break}}box2d.b2_toiMaxIters=box2d.b2Max(box2d.b2_toiMaxIters,n);c=c.GetMilliseconds();box2d.b2_toiMaxTime=box2d.b2Max(box2d.b2_toiMaxTime,c);box2d.b2_toiTime+=c};box2d.b2TimeOfImpact.s_timer=new box2d.b2Timer;
box2d.b2TimeOfImpact.s_cache=new box2d.b2SimplexCache;box2d.b2TimeOfImpact.s_distanceInput=new box2d.b2DistanceInput;box2d.b2TimeOfImpact.s_distanceOutput=new box2d.b2DistanceOutput;box2d.b2TimeOfImpact.s_xfA=new box2d.b2Transform;box2d.b2TimeOfImpact.s_xfB=new box2d.b2Transform;box2d.b2TimeOfImpact.s_indexA=box2d.b2MakeNumberArray(1);box2d.b2TimeOfImpact.s_indexB=box2d.b2MakeNumberArray(1);box2d.b2TimeOfImpact.s_fcn=new box2d.b2SeparationFunction;box2d.b2TimeOfImpact.s_sweepA=new box2d.b2Sweep;
box2d.b2TimeOfImpact.s_sweepB=new box2d.b2Sweep;box2d.b2TimeOfImpact.s_pointA=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_pointB=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_normal=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_axisA=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_axisB=new box2d.b2Vec2;box2d.b2MixFriction=function(a,b){return box2d.b2Sqrt(a*b)};box2d.b2MixRestitution=function(a,b){return a>b?a:b};box2d.b2ContactEdge=function(){};box2d.b2ContactEdge.prototype.other=null;
box2d.b2ContactEdge.prototype.contact=null;box2d.b2ContactEdge.prototype.prev=null;box2d.b2ContactEdge.prototype.next=null;box2d.b2ContactFlag={e_none:0,e_islandFlag:1,e_touchingFlag:2,e_enabledFlag:4,e_filterFlag:8,e_bulletHitFlag:16,e_toiFlag:32};goog.exportProperty(box2d.b2ContactFlag,"e_none",box2d.b2ContactFlag.e_none);goog.exportProperty(box2d.b2ContactFlag,"e_islandFlag",box2d.b2ContactFlag.e_islandFlag);goog.exportProperty(box2d.b2ContactFlag,"e_touchingFlag",box2d.b2ContactFlag.e_touchingFlag);
goog.exportProperty(box2d.b2ContactFlag,"e_enabledFlag",box2d.b2ContactFlag.e_enabledFlag);goog.exportProperty(box2d.b2ContactFlag,"e_filterFlag",box2d.b2ContactFlag.e_filterFlag);goog.exportProperty(box2d.b2ContactFlag,"e_bulletHitFlag",box2d.b2ContactFlag.e_bulletHitFlag);goog.exportProperty(box2d.b2ContactFlag,"e_toiFlag",box2d.b2ContactFlag.e_toiFlag);
box2d.b2Contact=function(){this.m_nodeA=new box2d.b2ContactEdge;this.m_nodeB=new box2d.b2ContactEdge;this.m_manifold=new box2d.b2Manifold;this.m_oldManifold=new box2d.b2Manifold};box2d.b2Contact.prototype.m_flags=box2d.b2ContactFlag.e_none;box2d.b2Contact.prototype.m_prev=null;box2d.b2Contact.prototype.m_next=null;box2d.b2Contact.prototype.m_nodeA=null;box2d.b2Contact.prototype.m_nodeB=null;box2d.b2Contact.prototype.m_fixtureA=null;box2d.b2Contact.prototype.m_fixtureB=null;
box2d.b2Contact.prototype.m_indexA=0;box2d.b2Contact.prototype.m_indexB=0;box2d.b2Contact.prototype.m_manifold=null;box2d.b2Contact.prototype.m_toiCount=0;box2d.b2Contact.prototype.m_toi=0;box2d.b2Contact.prototype.m_friction=0;box2d.b2Contact.prototype.m_restitution=0;box2d.b2Contact.prototype.m_tangentSpeed=0;box2d.b2Contact.prototype.m_oldManifold=null;box2d.b2Contact.prototype.GetManifold=function(){return this.m_manifold};
box2d.b2Contact.prototype.GetWorldManifold=function(a){var b=this.m_fixtureA.GetBody(),c=this.m_fixtureB.GetBody(),d=this.m_fixtureA.GetShape(),e=this.m_fixtureB.GetShape();a.Initialize(this.m_manifold,b.GetTransform(),d.m_radius,c.GetTransform(),e.m_radius)};box2d.b2Contact.prototype.IsTouching=function(){return(this.m_flags&box2d.b2ContactFlag.e_touchingFlag)===box2d.b2ContactFlag.e_touchingFlag};
box2d.b2Contact.prototype.SetEnabled=function(a){this.m_flags=a?this.m_flags|box2d.b2ContactFlag.e_enabledFlag:this.m_flags&~box2d.b2ContactFlag.e_enabledFlag};box2d.b2Contact.prototype.IsEnabled=function(){return(this.m_flags&box2d.b2ContactFlag.e_enabledFlag)===box2d.b2ContactFlag.e_enabledFlag};box2d.b2Contact.prototype.GetNext=function(){return this.m_next};box2d.b2Contact.prototype.GetFixtureA=function(){return this.m_fixtureA};box2d.b2Contact.prototype.GetChildIndexA=function(){return this.m_indexA};
box2d.b2Contact.prototype.GetFixtureB=function(){return this.m_fixtureB};box2d.b2Contact.prototype.GetChildIndexB=function(){return this.m_indexB};box2d.b2Contact.prototype.Evaluate=function(a,b,c){};box2d.b2Contact.prototype.FlagForFiltering=function(){this.m_flags|=box2d.b2ContactFlag.e_filterFlag};box2d.b2Contact.prototype.SetFriction=function(a){this.m_friction=a};box2d.b2Contact.prototype.GetFriction=function(){return this.m_friction};
box2d.b2Contact.prototype.ResetFriction=function(){this.m_friction=box2d.b2MixFriction(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)};box2d.b2Contact.prototype.SetRestitution=function(a){this.m_restitution=a};box2d.b2Contact.prototype.GetRestitution=function(){return this.m_restitution};box2d.b2Contact.prototype.ResetRestitution=function(){this.m_restitution=box2d.b2MixRestitution(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)};
box2d.b2Contact.prototype.SetTangentSpeed=function(a){this.m_tangentSpeed=a};box2d.b2Contact.prototype.GetTangentSpeed=function(){return this.m_tangentSpeed};
box2d.b2Contact.prototype.Reset=function(a,b,c,d){this.m_flags=box2d.b2ContactFlag.e_enabledFlag;this.m_fixtureA=a;this.m_fixtureB=c;this.m_indexA=b;this.m_indexB=d;this.m_manifold.pointCount=0;this.m_next=this.m_prev=null;this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null;this.m_toiCount=0;this.m_friction=box2d.b2MixFriction(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction);
this.m_restitution=box2d.b2MixRestitution(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)};
box2d.b2Contact.prototype.Update=function(a){var b=this.m_oldManifold;this.m_oldManifold=this.m_manifold;this.m_manifold=b;this.m_flags|=box2d.b2ContactFlag.e_enabledFlag;b=(this.m_flags&box2d.b2ContactFlag.e_touchingFlag)===box2d.b2ContactFlag.e_touchingFlag;var c=this.m_fixtureA.IsSensor(),d=this.m_fixtureB.IsSensor();c=c||d;d=this.m_fixtureA.GetBody();var e=this.m_fixtureB.GetBody();var f=d.GetTransform();var g=e.GetTransform();if(c)d=this.m_fixtureA.GetShape(),e=this.m_fixtureB.GetShape(),f=box2d.b2TestOverlapShape(d,
this.m_indexA,e,this.m_indexB,f,g),this.m_manifold.pointCount=0;else{this.Evaluate(this.m_manifold,f,g);f=0<this.m_manifold.pointCount;for(g=0;g<this.m_manifold.pointCount;++g){var h=this.m_manifold.points[g];h.normalImpulse=0;h.tangentImpulse=0;for(var k=h.id,l=0;l<this.m_oldManifold.pointCount;++l){var m=this.m_oldManifold.points[l];if(m.id.key===k.key){h.normalImpulse=m.normalImpulse;h.tangentImpulse=m.tangentImpulse;break}}}f!==b&&(d.SetAwake(!0),e.SetAwake(!0))}this.m_flags=f?this.m_flags|box2d.b2ContactFlag.e_touchingFlag:
this.m_flags&~box2d.b2ContactFlag.e_touchingFlag;!1===b&&!0===f&&a&&a.BeginContact(this);!0===b&&!1===f&&a&&a.EndContact(this);!1===c&&f&&a&&a.PreSolve(this,this.m_oldManifold)};
box2d.b2Contact.prototype.ComputeTOI=function(a,b){var c=box2d.b2Contact.prototype.ComputeTOI.s_input;c.proxyA.SetShape(this.m_fixtureA.GetShape(),this.m_indexA);c.proxyB.SetShape(this.m_fixtureB.GetShape(),this.m_indexB);c.sweepA.Copy(a);c.sweepB.Copy(b);c.tMax=box2d.b2_linearSlop;var d=box2d.b2Contact.prototype.ComputeTOI.s_output;box2d.b2TimeOfImpact(d,c);return d.t};box2d.b2Contact.prototype.ComputeTOI.s_input=new box2d.b2TOIInput;box2d.b2Contact.prototype.ComputeTOI.s_output=new box2d.b2TOIOutput;
box2d.b2PolygonAndCircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2PolygonAndCircleContact,box2d.b2Contact);box2d.b2PolygonAndCircleContact.Create=function(a){return new box2d.b2PolygonAndCircleContact};box2d.b2PolygonAndCircleContact.Destroy=function(a,b){};
box2d.b2PolygonAndCircleContact.prototype.Reset=function(a,b,c,d){box2d.b2PolygonAndCircleContact.superClass_.Reset.call(this,a,b,c,d);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.GetType()===box2d.b2ShapeType.e_polygonShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(c.GetType()===box2d.b2ShapeType.e_circleShape)};
box2d.b2PolygonAndCircleContact.prototype.Evaluate=function(a,b,c){var d=this.m_fixtureA.GetShape(),e=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(d instanceof box2d.b2PolygonShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2CircleShape);box2d.b2CollidePolygonAndCircle(a,d instanceof box2d.b2PolygonShape?d:null,b,e instanceof box2d.b2CircleShape?e:null,c)};box2d.b2EdgeAndPolygonContact=function(){box2d.b2Contact.call(this)};
goog.inherits(box2d.b2EdgeAndPolygonContact,box2d.b2Contact);box2d.b2EdgeAndPolygonContact.Create=function(a){return new box2d.b2EdgeAndPolygonContact};box2d.b2EdgeAndPolygonContact.Destroy=function(a,b){};box2d.b2EdgeAndPolygonContact.prototype.Reset=function(a,b,c,d){box2d.b2EdgeAndPolygonContact.superClass_.Reset.call(this,a,b,c,d);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.GetType()===box2d.b2ShapeType.e_edgeShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(c.GetType()===box2d.b2ShapeType.e_polygonShape)};
box2d.b2EdgeAndPolygonContact.prototype.Evaluate=function(a,b,c){var d=this.m_fixtureA.GetShape(),e=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(d instanceof box2d.b2EdgeShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2PolygonShape);box2d.b2CollideEdgeAndPolygon(a,d instanceof box2d.b2EdgeShape?d:null,b,e instanceof box2d.b2PolygonShape?e:null,c)};box2d.b2MassData=function(){this.center=new box2d.b2Vec2(0,0)};box2d.b2MassData.prototype.mass=0;
box2d.b2MassData.prototype.center=null;box2d.b2MassData.prototype.I=0;box2d.b2ShapeType={e_unknown:-1,e_circleShape:0,e_edgeShape:1,e_polygonShape:2,e_chainShape:3,e_shapeTypeCount:4};goog.exportProperty(box2d.b2ShapeType,"e_unknown",box2d.b2ShapeType.e_unknown);goog.exportProperty(box2d.b2ShapeType,"e_circleShape",box2d.b2ShapeType.e_circleShape);goog.exportProperty(box2d.b2ShapeType,"e_edgeShape",box2d.b2ShapeType.e_edgeShape);goog.exportProperty(box2d.b2ShapeType,"e_polygonShape",box2d.b2ShapeType.e_polygonShape);
goog.exportProperty(box2d.b2ShapeType,"e_chainShape",box2d.b2ShapeType.e_chainShape);goog.exportProperty(box2d.b2ShapeType,"e_shapeTypeCount",box2d.b2ShapeType.e_shapeTypeCount);box2d.b2Shape=function(a,b){this.m_type=a;this.m_radius=b};box2d.b2Shape.prototype.m_type=box2d.b2ShapeType.e_unknown;box2d.b2Shape.prototype.m_radius=0;box2d.b2Shape.prototype.Clone=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);return null};
box2d.b2Shape.prototype.Copy=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_type===a.m_type);this.m_radius=a.m_radius;return this};box2d.b2Shape.prototype.GetType=function(){return this.m_type};box2d.b2Shape.prototype.GetChildCount=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return 0};box2d.b2Shape.prototype.TestPoint=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return!1};
box2d.b2Shape.prototype.RayCast=function(a,b,c,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return!1};box2d.b2Shape.prototype.ComputeAABB=function(a,b,c){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};box2d.b2Shape.prototype.ComputeMass=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};box2d.b2Shape.prototype.SetupDistanceProxy=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};
box2d.b2Shape.prototype.ComputeSubmergedArea=function(a,b,c,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return 0};box2d.b2Shape.prototype.Dump=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};box2d.b2PolygonShape=function(){box2d.b2Shape.call(this,box2d.b2ShapeType.e_polygonShape,box2d.b2_polygonRadius);this.m_centroid=new box2d.b2Vec2(0,0);this.m_vertices=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);this.m_normals=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices)};
goog.inherits(box2d.b2PolygonShape,box2d.b2Shape);box2d.b2PolygonShape.prototype.m_centroid=null;box2d.b2PolygonShape.prototype.m_vertices=null;box2d.b2PolygonShape.prototype.m_normals=null;box2d.b2PolygonShape.prototype.m_count=0;box2d.b2PolygonShape.prototype.Clone=function(){return(new box2d.b2PolygonShape).Copy(this)};
box2d.b2PolygonShape.prototype.Copy=function(a){box2d.b2PolygonShape.superClass_.Copy.call(this,a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2PolygonShape);this.m_centroid.Copy(a.m_centroid);this.m_count=a.m_count;for(var b=0,c=this.m_count;b<c;++b)this.m_vertices[b].Copy(a.m_vertices[b]),this.m_normals[b].Copy(a.m_normals[b]);return this};
box2d.b2PolygonShape.prototype.SetAsBox=function(a,b){this.m_count=4;this.m_vertices[0].SetXY(-a,-b);this.m_vertices[1].SetXY(a,-b);this.m_vertices[2].SetXY(a,b);this.m_vertices[3].SetXY(-a,b);this.m_normals[0].SetXY(0,-1);this.m_normals[1].SetXY(1,0);this.m_normals[2].SetXY(0,1);this.m_normals[3].SetXY(-1,0);this.m_centroid.SetZero();return this};
box2d.b2PolygonShape.prototype.SetAsOrientedBox=function(a,b,c,d){this.m_count=4;this.m_vertices[0].SetXY(-a,-b);this.m_vertices[1].SetXY(a,-b);this.m_vertices[2].SetXY(a,b);this.m_vertices[3].SetXY(-a,b);this.m_normals[0].SetXY(0,-1);this.m_normals[1].SetXY(1,0);this.m_normals[2].SetXY(0,1);this.m_normals[3].SetXY(-1,0);this.m_centroid.Copy(c);a=new box2d.b2Transform;a.SetPosition(c);a.SetRotationAngleRadians(d);c=0;for(d=this.m_count;c<d;++c)box2d.b2MulXV(a,this.m_vertices[c],this.m_vertices[c]),
box2d.b2MulRV(a.q,this.m_normals[c],this.m_normals[c]);return this};
box2d.b2PolygonShape.prototype.Set=function(a,b){void 0===b&&(b=a.length);box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=b&&b<=box2d.b2_maxPolygonVertices);if(3>b)return this.SetAsBox(1,1);for(var c=box2d.b2Min(b,box2d.b2_maxPolygonVertices),d=box2d.b2PolygonShape.prototype.Set.s_ps,e=0,f=0;f<c;++f){for(var g=a[f],h=!0,k=0;k<e;++k)if(box2d.b2DistanceSquaredVV(g,d[k])<.5*box2d.b2_linearSlop){h=!1;break}h&&d[e++].Copy(g)}c=e;if(3>c)return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),this.SetAsBox(1,1);e=0;g=d[0].x;
for(f=1;f<c;++f)if(k=d[f].x,k>g||k===g&&d[f].y<d[e].y)e=f,g=k;var l=box2d.b2PolygonShape.prototype.Set.s_hull;h=0;for(f=e;;){l[h]=f;var m=0;for(k=1;k<c;++k)if(m===f)m=k;else{var n=box2d.b2SubVV(d[m],d[l[h]],box2d.b2PolygonShape.prototype.Set.s_r);g=box2d.b2SubVV(d[k],d[l[h]],box2d.b2PolygonShape.prototype.Set.s_v);var p=box2d.b2CrossVV(n,g);0>p&&(m=k);0===p&&g.GetLengthSquared()>n.GetLengthSquared()&&(m=k)}++h;f=m;if(m===e)break}this.m_count=h;for(f=0;f<h;++f)this.m_vertices[f].Copy(d[l[f]]);f=0;
for(c=h;f<c;++f)d=box2d.b2SubVV(this.m_vertices[(f+1)%c],this.m_vertices[f],box2d.b2Vec2.s_t0),box2d.ENABLE_ASSERTS&&box2d.b2Assert(d.GetLengthSquared()>box2d.b2_epsilon_sq),box2d.b2CrossVOne(d,this.m_normals[f]).SelfNormalize();box2d.b2PolygonShape.ComputeCentroid(this.m_vertices,h,this.m_centroid);return this};box2d.b2PolygonShape.prototype.Set.s_ps=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);box2d.b2PolygonShape.prototype.Set.s_hull=box2d.b2MakeNumberArray(box2d.b2_maxPolygonVertices);
box2d.b2PolygonShape.prototype.Set.s_r=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.Set.s_v=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.SetAsVector=function(a,b){this.Set(a,b);return this};box2d.b2PolygonShape.prototype.SetAsArray=function(a,b){this.Set(a,b);return this};box2d.b2PolygonShape.prototype.GetChildCount=function(){return 1};
box2d.b2PolygonShape.prototype.TestPoint=function(a,b){for(var c=box2d.b2MulTXV(a,b,box2d.b2PolygonShape.prototype.TestPoint.s_pLocal),d=0,e=this.m_count;d<e;++d)if(0<box2d.b2DotVV(this.m_normals[d],box2d.b2SubVV(c,this.m_vertices[d],box2d.b2Vec2.s_t0)))return!1;return!0};box2d.b2PolygonShape.prototype.TestPoint.s_pLocal=new box2d.b2Vec2;
box2d.b2PolygonShape.prototype.RayCast=function(a,b,c,d){d=box2d.b2MulTXV(c,b.p1,box2d.b2PolygonShape.prototype.RayCast.s_p1);var e=box2d.b2MulTXV(c,b.p2,box2d.b2PolygonShape.prototype.RayCast.s_p2);e=box2d.b2SubVV(e,d,box2d.b2PolygonShape.prototype.RayCast.s_d);for(var f=0,g=b.maxFraction,h=-1,k=0,l=this.m_count;k<l;++k){var m=box2d.b2DotVV(this.m_normals[k],box2d.b2SubVV(this.m_vertices[k],d,box2d.b2Vec2.s_t0)),n=box2d.b2DotVV(this.m_normals[k],e);if(0===n){if(0>m)return!1}else 0>n&&m<f*n?(f=m/
n,h=k):0<n&&m<g*n&&(g=m/n);if(g<f)return!1}box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=f&&f<=b.maxFraction);return 0<=h?(a.fraction=f,box2d.b2MulRV(c.q,this.m_normals[h],a.normal),!0):!1};box2d.b2PolygonShape.prototype.RayCast.s_p1=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.RayCast.s_p2=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.RayCast.s_d=new box2d.b2Vec2;
box2d.b2PolygonShape.prototype.ComputeAABB=function(a,b,c){c=box2d.b2MulXV(b,this.m_vertices[0],a.lowerBound);a=a.upperBound.Copy(c);for(var d=0,e=this.m_count;d<e;++d){var f=box2d.b2MulXV(b,this.m_vertices[d],box2d.b2PolygonShape.prototype.ComputeAABB.s_v);box2d.b2MinV(f,c,c);box2d.b2MaxV(f,a,a)}b=this.m_radius;c.SelfSubXY(b,b);a.SelfAddXY(b,b)};box2d.b2PolygonShape.prototype.ComputeAABB.s_v=new box2d.b2Vec2;
box2d.b2PolygonShape.prototype.ComputeMass=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=this.m_count);for(var c=box2d.b2PolygonShape.prototype.ComputeMass.s_center.SetZero(),d=0,e=0,f=box2d.b2PolygonShape.prototype.ComputeMass.s_s.SetZero(),g=0,h=this.m_count;g<h;++g)f.SelfAdd(this.m_vertices[g]);f.SelfMul(1/this.m_count);var k=1/3;g=0;for(h=this.m_count;g<h;++g){var l=box2d.b2SubVV(this.m_vertices[g],f,box2d.b2PolygonShape.prototype.ComputeMass.s_e1),m=box2d.b2SubVV(this.m_vertices[(g+1)%
h],f,box2d.b2PolygonShape.prototype.ComputeMass.s_e2),n=box2d.b2CrossVV(l,m),p=.5*n;d+=p;c.SelfAdd(box2d.b2MulSV(p*k,box2d.b2AddVV(l,m,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t1));p=l.x;l=l.y;var q=m.x;m=m.y;e+=.25*k*n*(p*p+q*p+q*q+(l*l+m*l+m*m))}a.mass=b*d;box2d.ENABLE_ASSERTS&&box2d.b2Assert(d>box2d.b2_epsilon);c.SelfMul(1/d);box2d.b2AddVV(c,f,a.center);a.I=b*e;a.I+=a.mass*(box2d.b2DotVV(a.center,a.center)-box2d.b2DotVV(c,c))};box2d.b2PolygonShape.prototype.ComputeMass.s_center=new box2d.b2Vec2;
box2d.b2PolygonShape.prototype.ComputeMass.s_s=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeMass.s_e1=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeMass.s_e2=new box2d.b2Vec2;
box2d.b2PolygonShape.prototype.Validate=function(){for(var a=0;a<this.m_count;++a)for(var b=a,c=(a+1)%this.m_count,d=this.m_vertices[b],e=box2d.b2SubVV(this.m_vertices[c],d,box2d.b2PolygonShape.prototype.Validate.s_e),f=0;f<this.m_count;++f)if(f!==b&&f!==c){var g=box2d.b2SubVV(this.m_vertices[f],d,box2d.b2PolygonShape.prototype.Validate.s_v);if(0>box2d.b2CrossVV(e,g))return!1}return!0};box2d.b2PolygonShape.prototype.Validate.s_e=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.Validate.s_v=new box2d.b2Vec2;
box2d.b2PolygonShape.prototype.SetupDistanceProxy=function(a,b){a.m_vertices=this.m_vertices;a.m_count=this.m_count;a.m_radius=this.m_radius};
box2d.b2PolygonShape.prototype.ComputeSubmergedArea=function(a,b,c,d){var e=box2d.b2MulTRV(c.q,a,box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_normalL),f=b-box2d.b2DotVV(a,c.p),g=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_depths,h=0,k=-1;b=-1;var l=!1;a=0;for(var m=this.m_count;a<m;++a){g[a]=box2d.b2DotVV(e,this.m_vertices[a])-f;var n=g[a]<-box2d.b2_epsilon;0<a&&(n?l||(k=a-1,h++):l&&(b=a-1,h++));l=n}switch(h){case 0:return l?(a=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_md,
this.ComputeMass(a,1),box2d.b2MulXV(c,a.center,d),a.mass):0;case 1:-1===k?k=this.m_count-1:b=this.m_count-1}a=(k+1)%this.m_count;e=(b+1)%this.m_count;f=(0-g[k])/(g[a]-g[k]);g=(0-g[b])/(g[e]-g[b]);k=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_intoVec.SetXY(this.m_vertices[k].x*(1-f)+this.m_vertices[a].x*f,this.m_vertices[k].y*(1-f)+this.m_vertices[a].y*f);b=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_outoVec.SetXY(this.m_vertices[b].x*(1-g)+this.m_vertices[e].x*g,this.m_vertices[b].y*
(1-g)+this.m_vertices[e].y*g);g=0;f=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_center.SetZero();for(h=this.m_vertices[a];a!==e;)a=(a+1)%this.m_count,l=a===e?b:this.m_vertices[a],m=.5*((h.x-k.x)*(l.y-k.y)-(h.y-k.y)*(l.x-k.x)),g+=m,f.x+=m*(k.x+h.x+l.x)/3,f.y+=m*(k.y+h.y+l.y)/3,h=l;f.SelfMul(1/g);box2d.b2MulXV(c,f,d);return g};box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_normalL=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_depths=box2d.b2MakeNumberArray(box2d.b2_maxPolygonVertices);
box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_md=new box2d.b2MassData;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_intoVec=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_outoVec=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_center=new box2d.b2Vec2;
box2d.b2PolygonShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2PolygonShape*/ var shape = new box2d.b2PolygonShape();\n");box2d.b2Log("    /*box2d.b2Vec2[]*/ var vs = box2d.b2Vec2.MakeArray(%d);\n",box2d.b2_maxPolygonVertices);for(var a=0;a<this.m_count;++a)box2d.b2Log("    vs[%d].SetXY(%.15f, %.15f);\n",a,this.m_vertices[a].x,this.m_vertices[a].y);box2d.b2Log("    shape.Set(vs, %d);\n",this.m_count)};
box2d.b2PolygonShape.ComputeCentroid=function(a,b,c){box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=b);c.SetZero();for(var d=0,e=box2d.b2PolygonShape.ComputeCentroid.s_pRef.SetZero(),f=1/3,g=0;g<b;++g){var h=e,k=a[g],l=a[(g+1)%b],m=box2d.b2SubVV(k,h,box2d.b2PolygonShape.ComputeCentroid.s_e1),n=box2d.b2SubVV(l,h,box2d.b2PolygonShape.ComputeCentroid.s_e2);m=.5*box2d.b2CrossVV(m,n);d+=m;c.x+=m*f*(h.x+k.x+l.x);c.y+=m*f*(h.y+k.y+l.y)}box2d.ENABLE_ASSERTS&&box2d.b2Assert(d>box2d.b2_epsilon);c.SelfMul(1/d);return c};
box2d.b2PolygonShape.ComputeCentroid.s_pRef=new box2d.b2Vec2;box2d.b2PolygonShape.ComputeCentroid.s_e1=new box2d.b2Vec2;box2d.b2PolygonShape.ComputeCentroid.s_e2=new box2d.b2Vec2;box2d.b2CollideEdge={};
box2d.b2CollideEdgeAndCircle=function(a,b,c,d,e){a.pointCount=0;c=box2d.b2MulTXV(c,box2d.b2MulXV(e,d.m_p,box2d.b2Vec2.s_t0),box2d.b2CollideEdgeAndCircle.s_Q);var f=b.m_vertex1,g=b.m_vertex2,h=box2d.b2SubVV(g,f,box2d.b2CollideEdgeAndCircle.s_e),k=box2d.b2DotVV(h,box2d.b2SubVV(g,c,box2d.b2Vec2.s_t0)),l=box2d.b2DotVV(h,box2d.b2SubVV(c,f,box2d.b2Vec2.s_t0)),m=b.m_radius+d.m_radius;e=box2d.b2CollideEdgeAndCircle.s_id;e.cf.indexB=0;e.cf.typeB=box2d.b2ContactFeatureType.e_vertex;if(0>=l){var n=f;k=box2d.b2SubVV(c,
n,box2d.b2CollideEdgeAndCircle.s_d);k=box2d.b2DotVV(k,k);if(!(k>m*m)){if(b.m_hasVertex0&&(b=box2d.b2SubVV(f,b.m_vertex0,box2d.b2CollideEdgeAndCircle.s_e1),0<box2d.b2DotVV(b,box2d.b2SubVV(f,c,box2d.b2Vec2.s_t0))))return;e.cf.indexA=0;e.cf.typeA=box2d.b2ContactFeatureType.e_vertex;a.pointCount=1;a.type=box2d.b2ManifoldType.e_circles;a.localNormal.SetZero();a.localPoint.Copy(n);a.points[0].id.Copy(e);a.points[0].localPoint.Copy(d.m_p)}}else if(0>=k){if(n=g,k=box2d.b2SubVV(c,n,box2d.b2CollideEdgeAndCircle.s_d),
k=box2d.b2DotVV(k,k),!(k>m*m)){if(b.m_hasVertex3&&(f=box2d.b2SubVV(b.m_vertex3,g,box2d.b2CollideEdgeAndCircle.s_e2),0<box2d.b2DotVV(f,box2d.b2SubVV(c,g,box2d.b2Vec2.s_t0))))return;e.cf.indexA=1;e.cf.typeA=box2d.b2ContactFeatureType.e_vertex;a.pointCount=1;a.type=box2d.b2ManifoldType.e_circles;a.localNormal.SetZero();a.localPoint.Copy(n);a.points[0].id.Copy(e);a.points[0].localPoint.Copy(d.m_p)}}else b=box2d.b2DotVV(h,h),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<b),n=box2d.b2CollideEdgeAndCircle.s_P,
n.x=1/b*(k*f.x+l*g.x),n.y=1/b*(k*f.y+l*g.y),k=box2d.b2SubVV(c,n,box2d.b2CollideEdgeAndCircle.s_d),k=box2d.b2DotVV(k,k),k>m*m||(n=box2d.b2CollideEdgeAndCircle.s_n.SetXY(-h.y,h.x),0>box2d.b2DotVV(n,box2d.b2SubVV(c,f,box2d.b2Vec2.s_t0))&&n.SetXY(-n.x,-n.y),n.Normalize(),e.cf.indexA=0,e.cf.typeA=box2d.b2ContactFeatureType.e_face,a.pointCount=1,a.type=box2d.b2ManifoldType.e_faceA,a.localNormal.Copy(n),a.localPoint.Copy(f),a.points[0].id.Copy(e),a.points[0].localPoint.Copy(d.m_p))};
box2d.b2CollideEdgeAndCircle.s_Q=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_e=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_d=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_e1=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_e2=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_P=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_n=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_id=new box2d.b2ContactID;box2d.b2EPAxisType={e_unknown:0,e_edgeA:1,e_edgeB:2};
goog.exportProperty(box2d.b2EPAxisType,"e_unknown",box2d.b2EPAxisType.e_unknown);goog.exportProperty(box2d.b2EPAxisType,"e_edgeA",box2d.b2EPAxisType.e_edgeA);goog.exportProperty(box2d.b2EPAxisType,"e_edgeB",box2d.b2EPAxisType.e_edgeB);box2d.b2EPAxis=function(){};box2d.b2EPAxis.prototype.type=box2d.b2EPAxisType.e_unknown;box2d.b2EPAxis.prototype.index=0;box2d.b2EPAxis.prototype.separation=0;
box2d.b2TempPolygon=function(){this.vertices=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);this.normals=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);this.count=0};box2d.b2TempPolygon.prototype.vertices=null;box2d.b2TempPolygon.prototype.normals=null;box2d.b2TempPolygon.prototype.count=0;
box2d.b2ReferenceFace=function(){this.i2=this.i1=0;this.v1=new box2d.b2Vec2;this.v2=new box2d.b2Vec2;this.normal=new box2d.b2Vec2;this.sideNormal1=new box2d.b2Vec2;this.sideOffset1=0;this.sideNormal2=new box2d.b2Vec2;this.sideOffset2=0};box2d.b2ReferenceFace.prototype.i1=0;box2d.b2ReferenceFace.prototype.i2=0;box2d.b2ReferenceFace.prototype.v1=null;box2d.b2ReferenceFace.prototype.v2=null;box2d.b2ReferenceFace.prototype.normal=null;box2d.b2ReferenceFace.prototype.sideNormal1=null;
box2d.b2ReferenceFace.prototype.sideOffset1=0;box2d.b2ReferenceFace.prototype.sideNormal2=null;box2d.b2ReferenceFace.prototype.sideOffset2=0;box2d.b2EPColliderVertexType={e_isolated:0,e_concave:1,e_convex:2};goog.exportProperty(box2d.b2EPColliderVertexType,"e_isolated",box2d.b2EPColliderVertexType.e_isolated);goog.exportProperty(box2d.b2EPColliderVertexType,"e_concave",box2d.b2EPColliderVertexType.e_concave);goog.exportProperty(box2d.b2EPColliderVertexType,"e_convex",box2d.b2EPColliderVertexType.e_convex);
box2d.b2EPCollider=function(){this.m_polygonB=new box2d.b2TempPolygon;this.m_xf=new box2d.b2Transform;this.m_centroidB=new box2d.b2Vec2;this.m_v0=new box2d.b2Vec2;this.m_v1=new box2d.b2Vec2;this.m_v2=new box2d.b2Vec2;this.m_v3=new box2d.b2Vec2;this.m_normal0=new box2d.b2Vec2;this.m_normal1=new box2d.b2Vec2;this.m_normal2=new box2d.b2Vec2;this.m_normal=new box2d.b2Vec2;this.m_type2=this.m_type1=box2d.b2EPColliderVertexType.e_isolated;this.m_lowerLimit=new box2d.b2Vec2;this.m_upperLimit=new box2d.b2Vec2;
this.m_radius=0;this.m_front=!1};box2d.b2EPCollider.prototype.m_polygonB=null;box2d.b2EPCollider.prototype.m_xf=null;box2d.b2EPCollider.prototype.m_centroidB=null;box2d.b2EPCollider.prototype.m_v0=null;box2d.b2EPCollider.prototype.m_v1=null;box2d.b2EPCollider.prototype.m_v2=null;box2d.b2EPCollider.prototype.m_v3=null;box2d.b2EPCollider.prototype.m_normal0=null;box2d.b2EPCollider.prototype.m_normal1=null;box2d.b2EPCollider.prototype.m_normal2=null;box2d.b2EPCollider.prototype.m_normal=null;
box2d.b2EPCollider.prototype.m_type1=box2d.b2EPColliderVertexType.e_isolated;box2d.b2EPCollider.prototype.m_type2=box2d.b2EPColliderVertexType.e_isolated;box2d.b2EPCollider.prototype.m_lowerLimit=null;box2d.b2EPCollider.prototype.m_upperLimit=null;box2d.b2EPCollider.prototype.m_radius=0;box2d.b2EPCollider.prototype.m_front=!1;
box2d.b2EPCollider.prototype.Collide=function(a,b,c,d,e){box2d.b2MulTXX(c,e,this.m_xf);box2d.b2MulXV(this.m_xf,d.m_centroid,this.m_centroidB);this.m_v0.Copy(b.m_vertex0);this.m_v1.Copy(b.m_vertex1);this.m_v2.Copy(b.m_vertex2);this.m_v3.Copy(b.m_vertex3);c=b.m_hasVertex0;b=b.m_hasVertex3;e=box2d.b2SubVV(this.m_v2,this.m_v1,box2d.b2EPCollider.s_edge1);e.Normalize();this.m_normal1.SetXY(e.y,-e.x);var f=box2d.b2DotVV(this.m_normal1,box2d.b2SubVV(this.m_centroidB,this.m_v1,box2d.b2Vec2.s_t0)),g=0,h=0,
k=!1,l=!1;c&&(g=box2d.b2SubVV(this.m_v1,this.m_v0,box2d.b2EPCollider.s_edge0),g.Normalize(),this.m_normal0.SetXY(g.y,-g.x),k=0<=box2d.b2CrossVV(g,e),g=box2d.b2DotVV(this.m_normal0,box2d.b2SubVV(this.m_centroidB,this.m_v0,box2d.b2Vec2.s_t0)));b&&(h=box2d.b2SubVV(this.m_v3,this.m_v2,box2d.b2EPCollider.s_edge2),h.Normalize(),this.m_normal2.SetXY(h.y,-h.x),l=0<box2d.b2CrossVV(e,h),h=box2d.b2DotVV(this.m_normal2,box2d.b2SubVV(this.m_centroidB,this.m_v2,box2d.b2Vec2.s_t0)));c&&b?k&&l?(this.m_front=0<=g||
0<=f||0<=h)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):k?(this.m_front=0<=g||0<=f&&0<=h)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),
this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):l?(this.m_front=0<=h||0<=g&&0<=f)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg()):(this.m_front=0<=g&&0<=f&&0<=h)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),
this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg()):c?k?((this.m_front=0<=g||0<=f)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1)),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_front=0<=g&&0<=f)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),
this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal0).SelfNeg()):b?l?(this.m_front=0<=f||0<=h)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1)):((this.m_front=0<=f&&0<=h)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),
this.m_lowerLimit.Copy(this.m_normal2).SelfNeg()),this.m_upperLimit.Copy(this.m_normal1)):(this.m_front=0<=f)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1));this.m_polygonB.count=d.m_count;f=0;for(g=d.m_count;f<g;++f)box2d.b2MulXV(this.m_xf,d.m_vertices[f],this.m_polygonB.vertices[f]),box2d.b2MulRV(this.m_xf.q,
d.m_normals[f],this.m_polygonB.normals[f]);this.m_radius=2*box2d.b2_polygonRadius;a.pointCount=0;c=this.ComputeEdgeSeparation(box2d.b2EPCollider.s_edgeAxis);if(!(c.type===box2d.b2EPAxisType.e_unknown||c.separation>this.m_radius||(b=this.ComputePolygonSeparation(box2d.b2EPCollider.s_polygonAxis),b.type!==box2d.b2EPAxisType.e_unknown&&b.separation>this.m_radius))){c=b.type===box2d.b2EPAxisType.e_unknown?c:b.separation>.98*c.separation+.001?b:c;e=box2d.b2EPCollider.s_ie;b=box2d.b2EPCollider.s_rf;if(c.type===
box2d.b2EPAxisType.e_edgeA){a.type=box2d.b2ManifoldType.e_faceA;h=0;k=box2d.b2DotVV(this.m_normal,this.m_polygonB.normals[0]);f=1;for(g=this.m_polygonB.count;f<g;++f)l=box2d.b2DotVV(this.m_normal,this.m_polygonB.normals[f]),l<k&&(k=l,h=f);g=h;f=(g+1)%this.m_polygonB.count;h=e[0];h.v.Copy(this.m_polygonB.vertices[g]);h.id.cf.indexA=0;h.id.cf.indexB=g;h.id.cf.typeA=box2d.b2ContactFeatureType.e_face;h.id.cf.typeB=box2d.b2ContactFeatureType.e_vertex;g=e[1];g.v.Copy(this.m_polygonB.vertices[f]);g.id.cf.indexA=
0;g.id.cf.indexB=f;g.id.cf.typeA=box2d.b2ContactFeatureType.e_face;g.id.cf.typeB=box2d.b2ContactFeatureType.e_vertex;this.m_front?(b.i1=0,b.i2=1,b.v1.Copy(this.m_v1),b.v2.Copy(this.m_v2),b.normal.Copy(this.m_normal1)):(b.i1=1,b.i2=0,b.v1.Copy(this.m_v2),b.v2.Copy(this.m_v1),b.normal.Copy(this.m_normal1).SelfNeg())}else a.type=box2d.b2ManifoldType.e_faceB,h=e[0],h.v.Copy(this.m_v1),h.id.cf.indexA=0,h.id.cf.indexB=c.index,h.id.cf.typeA=box2d.b2ContactFeatureType.e_vertex,h.id.cf.typeB=box2d.b2ContactFeatureType.e_face,
g=e[1],g.v.Copy(this.m_v2),g.id.cf.indexA=0,g.id.cf.indexB=c.index,g.id.cf.typeA=box2d.b2ContactFeatureType.e_vertex,g.id.cf.typeB=box2d.b2ContactFeatureType.e_face,b.i1=c.index,b.i2=(b.i1+1)%this.m_polygonB.count,b.v1.Copy(this.m_polygonB.vertices[b.i1]),b.v2.Copy(this.m_polygonB.vertices[b.i2]),b.normal.Copy(this.m_polygonB.normals[b.i1]);b.sideNormal1.SetXY(b.normal.y,-b.normal.x);b.sideNormal2.Copy(b.sideNormal1).SelfNeg();b.sideOffset1=box2d.b2DotVV(b.sideNormal1,b.v1);b.sideOffset2=box2d.b2DotVV(b.sideNormal2,
b.v2);f=box2d.b2EPCollider.s_clipPoints1;h=box2d.b2EPCollider.s_clipPoints2;e=box2d.b2ClipSegmentToLine(f,e,b.sideNormal1,b.sideOffset1,b.i1);if(!(e<box2d.b2_maxManifoldPoints||(e=box2d.b2ClipSegmentToLine(h,f,b.sideNormal2,b.sideOffset2,b.i2),e<box2d.b2_maxManifoldPoints))){c.type===box2d.b2EPAxisType.e_edgeA?(a.localNormal.Copy(b.normal),a.localPoint.Copy(b.v1)):(a.localNormal.Copy(d.m_normals[b.i1]),a.localPoint.Copy(d.m_vertices[b.i1]));f=d=0;for(g=box2d.b2_maxManifoldPoints;f<g;++f)box2d.b2DotVV(b.normal,
box2d.b2SubVV(h[f].v,b.v1,box2d.b2Vec2.s_t0))<=this.m_radius&&(e=a.points[d],c.type===box2d.b2EPAxisType.e_edgeA?(box2d.b2MulTXV(this.m_xf,h[f].v,e.localPoint),e.id=h[f].id):(e.localPoint.Copy(h[f].v),e.id.cf.typeA=h[f].id.cf.typeB,e.id.cf.typeB=h[f].id.cf.typeA,e.id.cf.indexA=h[f].id.cf.indexB,e.id.cf.indexB=h[f].id.cf.indexA),++d);a.pointCount=d}}};box2d.b2EPCollider.s_edge1=new box2d.b2Vec2;box2d.b2EPCollider.s_edge0=new box2d.b2Vec2;box2d.b2EPCollider.s_edge2=new box2d.b2Vec2;
box2d.b2EPCollider.s_ie=box2d.b2ClipVertex.MakeArray(2);box2d.b2EPCollider.s_rf=new box2d.b2ReferenceFace;box2d.b2EPCollider.s_clipPoints1=box2d.b2ClipVertex.MakeArray(2);box2d.b2EPCollider.s_clipPoints2=box2d.b2ClipVertex.MakeArray(2);box2d.b2EPCollider.s_edgeAxis=new box2d.b2EPAxis;box2d.b2EPCollider.s_polygonAxis=new box2d.b2EPAxis;
box2d.b2EPCollider.prototype.ComputeEdgeSeparation=function(a){a.type=box2d.b2EPAxisType.e_edgeA;a.index=this.m_front?0:1;a.separation=box2d.b2_maxFloat;for(var b=0,c=this.m_polygonB.count;b<c;++b){var d=box2d.b2DotVV(this.m_normal,box2d.b2SubVV(this.m_polygonB.vertices[b],this.m_v1,box2d.b2Vec2.s_t0));d<a.separation&&(a.separation=d)}return a};
box2d.b2EPCollider.prototype.ComputePolygonSeparation=function(a){a.type=box2d.b2EPAxisType.e_unknown;a.index=-1;a.separation=-box2d.b2_maxFloat;for(var b=box2d.b2EPCollider.s_perp.SetXY(-this.m_normal.y,this.m_normal.x),c=0,d=this.m_polygonB.count;c<d;++c){var e=box2d.b2NegV(this.m_polygonB.normals[c],box2d.b2EPCollider.s_n),f=box2d.b2DotVV(e,box2d.b2SubVV(this.m_polygonB.vertices[c],this.m_v1,box2d.b2Vec2.s_t0)),g=box2d.b2DotVV(e,box2d.b2SubVV(this.m_polygonB.vertices[c],this.m_v2,box2d.b2Vec2.s_t0));
f=box2d.b2Min(f,g);if(f>this.m_radius){a.type=box2d.b2EPAxisType.e_edgeB;a.index=c;a.separation=f;break}if(0<=box2d.b2DotVV(e,b)){if(box2d.b2DotVV(box2d.b2SubVV(e,this.m_upperLimit,box2d.b2Vec2.s_t0),this.m_normal)<-box2d.b2_angularSlop)continue}else if(box2d.b2DotVV(box2d.b2SubVV(e,this.m_lowerLimit,box2d.b2Vec2.s_t0),this.m_normal)<-box2d.b2_angularSlop)continue;f>a.separation&&(a.type=box2d.b2EPAxisType.e_edgeB,a.index=c,a.separation=f)}return a};box2d.b2EPCollider.s_n=new box2d.b2Vec2;
box2d.b2EPCollider.s_perp=new box2d.b2Vec2;box2d.b2CollideEdgeAndPolygon=function(a,b,c,d,e){box2d.b2CollideEdgeAndPolygon.s_collider.Collide(a,b,c,d,e)};box2d.b2CollideEdgeAndPolygon.s_collider=new box2d.b2EPCollider;box2d.b2EdgeShape=function(){box2d.b2Shape.call(this,box2d.b2ShapeType.e_edgeShape,box2d.b2_polygonRadius);this.m_vertex1=new box2d.b2Vec2;this.m_vertex2=new box2d.b2Vec2;this.m_vertex0=new box2d.b2Vec2;this.m_vertex3=new box2d.b2Vec2};goog.inherits(box2d.b2EdgeShape,box2d.b2Shape);
box2d.b2EdgeShape.prototype.m_vertex1=null;box2d.b2EdgeShape.prototype.m_vertex2=null;box2d.b2EdgeShape.prototype.m_vertex0=null;box2d.b2EdgeShape.prototype.m_vertex3=null;box2d.b2EdgeShape.prototype.m_hasVertex0=!1;box2d.b2EdgeShape.prototype.m_hasVertex3=!1;box2d.b2EdgeShape.prototype.Set=function(a,b){this.m_vertex1.Copy(a);this.m_vertex2.Copy(b);this.m_hasVertex3=this.m_hasVertex0=!1;return this};box2d.b2EdgeShape.prototype.SetAsEdge=box2d.b2EdgeShape.prototype.Set;
box2d.b2EdgeShape.prototype.Clone=function(){return(new box2d.b2EdgeShape).Copy(this)};box2d.b2EdgeShape.prototype.Copy=function(a){box2d.b2EdgeShape.superClass_.Copy.call(this,a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2EdgeShape);this.m_vertex1.Copy(a.m_vertex1);this.m_vertex2.Copy(a.m_vertex2);this.m_vertex0.Copy(a.m_vertex0);this.m_vertex3.Copy(a.m_vertex3);this.m_hasVertex0=a.m_hasVertex0;this.m_hasVertex3=a.m_hasVertex3;return this};
box2d.b2EdgeShape.prototype.GetChildCount=function(){return 1};box2d.b2EdgeShape.prototype.TestPoint=function(a,b){return!1};
box2d.b2EdgeShape.prototype.RayCast=function(a,b,c,d){var e=box2d.b2MulTXV(c,b.p1,box2d.b2EdgeShape.prototype.RayCast.s_p1);d=box2d.b2MulTXV(c,b.p2,box2d.b2EdgeShape.prototype.RayCast.s_p2);var f=box2d.b2SubVV(d,e,box2d.b2EdgeShape.prototype.RayCast.s_d);d=this.m_vertex1;var g=this.m_vertex2,h=box2d.b2SubVV(g,d,box2d.b2EdgeShape.prototype.RayCast.s_e),k=a.normal.SetXY(h.y,-h.x).SelfNormalize();h=box2d.b2DotVV(k,box2d.b2SubVV(d,e,box2d.b2Vec2.s_t0));k=box2d.b2DotVV(k,f);if(0===k)return!1;k=h/k;if(0>
k||b.maxFraction<k)return!1;b=box2d.b2AddVMulSV(e,k,f,box2d.b2EdgeShape.prototype.RayCast.s_q);e=box2d.b2SubVV(g,d,box2d.b2EdgeShape.prototype.RayCast.s_r);g=box2d.b2DotVV(e,e);if(0===g)return!1;d=box2d.b2DotVV(box2d.b2SubVV(b,d,box2d.b2Vec2.s_t0),e)/g;if(0>d||1<d)return!1;a.fraction=k;box2d.b2MulRV(c.q,a.normal,a.normal);0<h&&a.normal.SelfNeg();return!0};box2d.b2EdgeShape.prototype.RayCast.s_p1=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_p2=new box2d.b2Vec2;
box2d.b2EdgeShape.prototype.RayCast.s_d=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_e=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_q=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_r=new box2d.b2Vec2;
box2d.b2EdgeShape.prototype.ComputeAABB=function(a,b,c){c=box2d.b2MulXV(b,this.m_vertex1,box2d.b2EdgeShape.prototype.ComputeAABB.s_v1);b=box2d.b2MulXV(b,this.m_vertex2,box2d.b2EdgeShape.prototype.ComputeAABB.s_v2);box2d.b2MinV(c,b,a.lowerBound);box2d.b2MaxV(c,b,a.upperBound);b=this.m_radius;a.lowerBound.SelfSubXY(b,b);a.upperBound.SelfAddXY(b,b)};box2d.b2EdgeShape.prototype.ComputeAABB.s_v1=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeAABB.s_v2=new box2d.b2Vec2;
box2d.b2EdgeShape.prototype.ComputeMass=function(a,b){a.mass=0;box2d.b2MidVV(this.m_vertex1,this.m_vertex2,a.center);a.I=0};box2d.b2EdgeShape.prototype.SetupDistanceProxy=function(a,b){a.m_vertices=Array(2);a.m_vertices[0]=this.m_vertex1;a.m_vertices[1]=this.m_vertex2;a.m_count=2;a.m_radius=this.m_radius};box2d.b2EdgeShape.prototype.ComputeSubmergedArea=function(a,b,c,d){d.SetZero();return 0};
box2d.b2EdgeShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2EdgeShape*/ var shape = new box2d.b2EdgeShape();\n");box2d.b2Log("    shape.m_radius = %.15f;\n",this.m_radius);box2d.b2Log("    shape.m_vertex0.SetXY(%.15f, %.15f);\n",this.m_vertex0.x,this.m_vertex0.y);box2d.b2Log("    shape.m_vertex1.SetXY(%.15f, %.15f);\n",this.m_vertex1.x,this.m_vertex1.y);box2d.b2Log("    shape.m_vertex2.SetXY(%.15f, %.15f);\n",this.m_vertex2.x,this.m_vertex2.y);box2d.b2Log("    shape.m_vertex3.SetXY(%.15f, %.15f);\n",
this.m_vertex3.x,this.m_vertex3.y);box2d.b2Log("    shape.m_hasVertex0 = %s;\n",this.m_hasVertex0);box2d.b2Log("    shape.m_hasVertex3 = %s;\n",this.m_hasVertex3)};box2d.b2ChainShape=function(){box2d.b2Shape.call(this,box2d.b2ShapeType.e_chainShape,box2d.b2_polygonRadius);this.m_prevVertex=new box2d.b2Vec2;this.m_nextVertex=new box2d.b2Vec2};goog.inherits(box2d.b2ChainShape,box2d.b2Shape);box2d.b2ChainShape.prototype.m_vertices=null;box2d.b2ChainShape.prototype.m_count=0;
box2d.b2ChainShape.prototype.m_prevVertex=null;box2d.b2ChainShape.prototype.m_nextVertex=null;box2d.b2ChainShape.prototype.m_hasPrevVertex=!1;box2d.b2ChainShape.prototype.m_hasNextVertex=!1;
box2d.b2ChainShape.prototype.CreateLoop=function(a,b){b=b||a.length;box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===this.m_vertices&&0===this.m_count);box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=b);if(box2d.ENABLE_ASSERTS)for(var c=1;c<b;++c)box2d.b2Assert(box2d.b2DistanceSquaredVV(a[c-1],a[c])>box2d.b2_linearSlop*box2d.b2_linearSlop);this.m_count=b+1;this.m_vertices=box2d.b2Vec2.MakeArray(this.m_count);for(c=0;c<b;++c)this.m_vertices[c].Copy(a[c]);this.m_vertices[b].Copy(this.m_vertices[0]);this.m_prevVertex.Copy(this.m_vertices[this.m_count-
2]);this.m_nextVertex.Copy(this.m_vertices[1]);this.m_hasNextVertex=this.m_hasPrevVertex=!0;return this};
box2d.b2ChainShape.prototype.CreateChain=function(a,b){b=b||a.length;box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===this.m_vertices&&0===this.m_count);box2d.ENABLE_ASSERTS&&box2d.b2Assert(2<=b);if(box2d.ENABLE_ASSERTS)for(var c=1;c<b;++c)box2d.b2Assert(box2d.b2DistanceSquaredVV(a[c-1],a[c])>box2d.b2_linearSlop*box2d.b2_linearSlop);this.m_count=b;this.m_vertices=box2d.b2Vec2.MakeArray(b);for(c=0;c<b;++c)this.m_vertices[c].Copy(a[c]);this.m_hasNextVertex=this.m_hasPrevVertex=!1;this.m_prevVertex.SetZero();
this.m_nextVertex.SetZero();return this};box2d.b2ChainShape.prototype.SetPrevVertex=function(a){this.m_prevVertex.Copy(a);this.m_hasPrevVertex=!0;return this};box2d.b2ChainShape.prototype.SetNextVertex=function(a){this.m_nextVertex.Copy(a);this.m_hasNextVertex=!0;return this};box2d.b2ChainShape.prototype.Clone=function(){return(new box2d.b2ChainShape).Copy(this)};
box2d.b2ChainShape.prototype.Copy=function(a){box2d.b2ChainShape.superClass_.Copy.call(this,a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2ChainShape);this.CreateChain(a.m_vertices,a.m_count);this.m_prevVertex.Copy(a.m_prevVertex);this.m_nextVertex.Copy(a.m_nextVertex);this.m_hasPrevVertex=a.m_hasPrevVertex;this.m_hasNextVertex=a.m_hasNextVertex;return this};box2d.b2ChainShape.prototype.GetChildCount=function(){return this.m_count-1};
box2d.b2ChainShape.prototype.GetChildEdge=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=b&&b<this.m_count-1);a.m_type=box2d.b2ShapeType.e_edgeShape;a.m_radius=this.m_radius;a.m_vertex1.Copy(this.m_vertices[b]);a.m_vertex2.Copy(this.m_vertices[b+1]);0<b?(a.m_vertex0.Copy(this.m_vertices[b-1]),a.m_hasVertex0=!0):(a.m_vertex0.Copy(this.m_prevVertex),a.m_hasVertex0=this.m_hasPrevVertex);b<this.m_count-2?(a.m_vertex3.Copy(this.m_vertices[b+2]),a.m_hasVertex3=!0):(a.m_vertex3.Copy(this.m_nextVertex),
a.m_hasVertex3=this.m_hasNextVertex)};box2d.b2ChainShape.prototype.TestPoint=function(a,b){return!1};box2d.b2ChainShape.prototype.RayCast=function(a,b,c,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(d<this.m_count);var e=box2d.b2ChainShape.s_edgeShape;e.m_vertex1.Copy(this.m_vertices[d]);e.m_vertex2.Copy(this.m_vertices[(d+1)%this.m_count]);return e.RayCast(a,b,c,0)};box2d.b2ChainShape.s_edgeShape=new box2d.b2EdgeShape;
box2d.b2ChainShape.prototype.ComputeAABB=function(a,b,c){box2d.ENABLE_ASSERTS&&box2d.b2Assert(c<this.m_count);var d=this.m_vertices[(c+1)%this.m_count];c=box2d.b2MulXV(b,this.m_vertices[c],box2d.b2ChainShape.prototype.ComputeAABB.s_v1);b=box2d.b2MulXV(b,d,box2d.b2ChainShape.prototype.ComputeAABB.s_v2);box2d.b2MinV(c,b,a.lowerBound);box2d.b2MaxV(c,b,a.upperBound)};box2d.b2ChainShape.prototype.ComputeAABB.s_v1=new box2d.b2Vec2;box2d.b2ChainShape.prototype.ComputeAABB.s_v2=new box2d.b2Vec2;
box2d.b2ChainShape.prototype.ComputeMass=function(a,b){a.mass=0;a.center.SetZero();a.I=0};box2d.b2ChainShape.prototype.SetupDistanceProxy=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=b&&b<this.m_count);a.m_buffer[0].Copy(this.m_vertices[b]);b+1<this.m_count?a.m_buffer[1].Copy(this.m_vertices[b+1]):a.m_buffer[1].Copy(this.m_vertices[0]);a.m_vertices=a.m_buffer;a.m_count=2;a.m_radius=this.m_radius};box2d.b2ChainShape.prototype.ComputeSubmergedArea=function(a,b,c,d){d.SetZero();return 0};
box2d.b2ChainShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2ChainShape*/ var shape = new box2d.b2ChainShape();\n");box2d.b2Log("    /*box2d.b2Vec2[]*/ var vs = box2d.b2Vec2.MakeArray(%d);\n",box2d.b2_maxPolygonVertices);for(var a=0;a<this.m_count;++a)box2d.b2Log("    vs[%d].SetXY(%.15f, %.15f);\n",a,this.m_vertices[a].x,this.m_vertices[a].y);box2d.b2Log("    shape.CreateChain(vs, %d);\n",this.m_count);box2d.b2Log("    shape.m_prevVertex.SetXY(%.15f, %.15f);\n",this.m_prevVertex.x,this.m_prevVertex.y);
box2d.b2Log("    shape.m_nextVertex.SetXY(%.15f, %.15f);\n",this.m_nextVertex.x,this.m_nextVertex.y);box2d.b2Log("    shape.m_hasPrevVertex = %s;\n",this.m_hasPrevVertex?"true":"false");box2d.b2Log("    shape.m_hasNextVertex = %s;\n",this.m_hasNextVertex?"true":"false")};box2d.b2ChainAndPolygonContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2ChainAndPolygonContact,box2d.b2Contact);box2d.b2ChainAndPolygonContact.Create=function(a){return new box2d.b2ChainAndPolygonContact};
box2d.b2ChainAndPolygonContact.Destroy=function(a,b){};box2d.b2ChainAndPolygonContact.prototype.Reset=function(a,b,c,d){box2d.b2ChainAndPolygonContact.superClass_.Reset.call(this,a,b,c,d);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.GetType()===box2d.b2ShapeType.e_chainShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(c.GetType()===box2d.b2ShapeType.e_polygonShape)};
box2d.b2ChainAndPolygonContact.prototype.Evaluate=function(a,b,c){var d=this.m_fixtureA.GetShape(),e=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(d instanceof box2d.b2ChainShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2PolygonShape);var f=box2d.b2ChainAndPolygonContact.prototype.Evaluate.s_edge;(d instanceof box2d.b2ChainShape?d:null).GetChildEdge(f,this.m_indexA);box2d.b2CollideEdgeAndPolygon(a,f,b,e instanceof box2d.b2PolygonShape?e:null,c)};
box2d.b2ChainAndPolygonContact.prototype.Evaluate.s_edge=new box2d.b2EdgeShape;box2d.b2CollidePolygon={};
box2d.b2FindMaxSeparation=function(a,b,c,d,e){var f=b.m_count,g=d.m_count,h=b.m_normals;b=b.m_vertices;d=d.m_vertices;c=box2d.b2MulTXX(e,c,box2d.b2FindMaxSeparation.s_xf);e=0;for(var k=-box2d.b2_maxFloat,l=0;l<f;++l){for(var m=box2d.b2MulRV(c.q,h[l],box2d.b2FindMaxSeparation.s_n),n=box2d.b2MulXV(c,b[l],box2d.b2FindMaxSeparation.s_v1),p=box2d.b2_maxFloat,q=0;q<g;++q){var r=box2d.b2DotVV(m,box2d.b2SubVV(d[q],n,box2d.b2Vec2.s_t0));r<p&&(p=r)}p>k&&(k=p,e=l)}a[0]=e;return k};
box2d.b2FindMaxSeparation.s_xf=new box2d.b2Transform;box2d.b2FindMaxSeparation.s_n=new box2d.b2Vec2;box2d.b2FindMaxSeparation.s_v1=new box2d.b2Vec2;
box2d.b2FindIncidentEdge=function(a,b,c,d,e,f){var g=b.m_count,h=b.m_normals,k=e.m_count;b=e.m_vertices;e=e.m_normals;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=d&&d<g);c=box2d.b2MulTRV(f.q,box2d.b2MulRV(c.q,h[d],box2d.b2Vec2.s_t0),box2d.b2FindIncidentEdge.s_normal1);g=0;h=box2d.b2_maxFloat;for(var l=0;l<k;++l){var m=box2d.b2DotVV(c,e[l]);m<h&&(h=m,g=l)}e=g;k=(e+1)%k;c=a[0];box2d.b2MulXV(f,b[e],c.v);c=c.id.cf;c.indexA=d;c.indexB=e;c.typeA=box2d.b2ContactFeatureType.e_face;c.typeB=box2d.b2ContactFeatureType.e_vertex;
a=a[1];box2d.b2MulXV(f,b[k],a.v);f=a.id.cf;f.indexA=d;f.indexB=k;f.typeA=box2d.b2ContactFeatureType.e_face;f.typeB=box2d.b2ContactFeatureType.e_vertex};box2d.b2FindIncidentEdge.s_normal1=new box2d.b2Vec2;
box2d.b2CollidePolygons=function(a,b,c,d,e){a.pointCount=0;var f=b.m_radius+d.m_radius,g=box2d.b2CollidePolygons.s_edgeA;g[0]=0;var h=box2d.b2FindMaxSeparation(g,b,c,d,e);if(!(h>f)){var k=box2d.b2CollidePolygons.s_edgeB;k[0]=0;var l=box2d.b2FindMaxSeparation(k,d,e,b,c);if(!(l>f)){if(l>.98*h+.001){h=d;d=e;var m=k[0];a.type=box2d.b2ManifoldType.e_faceB;g=1}else h=b,b=d,d=c,c=e,m=g[0],a.type=box2d.b2ManifoldType.e_faceA,g=0;k=box2d.b2CollidePolygons.s_incidentEdge;box2d.b2FindIncidentEdge(k,h,d,m,b,
c);l=h.m_vertices;e=m;b=(m+1)%h.m_count;var n=l[e],p=l[b];h=box2d.b2SubVV(p,n,box2d.b2CollidePolygons.s_localTangent);h.Normalize();l=box2d.b2CrossVOne(h,box2d.b2CollidePolygons.s_localNormal);m=box2d.b2MidVV(n,p,box2d.b2CollidePolygons.s_planePoint);var q=box2d.b2MulRV(d.q,h,box2d.b2CollidePolygons.s_tangent);h=box2d.b2CrossVOne(q,box2d.b2CollidePolygons.s_normal);n=box2d.b2MulXV(d,n,box2d.b2CollidePolygons.s_v11);var r=box2d.b2MulXV(d,p,box2d.b2CollidePolygons.s_v12);d=box2d.b2DotVV(h,n);p=-box2d.b2DotVV(q,
n)+f;r=box2d.b2DotVV(q,r)+f;var t=box2d.b2CollidePolygons.s_clipPoints1;n=box2d.b2CollidePolygons.s_clipPoints2;var u=box2d.b2NegV(q,box2d.b2CollidePolygons.s_ntangent);k=box2d.b2ClipSegmentToLine(t,k,u,p,e);if(!(2>k||(k=box2d.b2ClipSegmentToLine(n,t,q,r,b),2>k))){a.localNormal.Copy(l);a.localPoint.Copy(m);for(e=k=0;e<box2d.b2_maxManifoldPoints;++e)l=n[e],box2d.b2DotVV(h,l.v)-d<=f&&(b=a.points[k],box2d.b2MulTXV(c,l.v,b.localPoint),b.id.Copy(l.id),g&&(l=b.id.cf,b.id.cf.indexA=l.indexB,b.id.cf.indexB=
l.indexA,b.id.cf.typeA=l.typeB,b.id.cf.typeB=l.typeA),++k);a.pointCount=k}}}};box2d.b2CollidePolygons.s_incidentEdge=box2d.b2ClipVertex.MakeArray(2);box2d.b2CollidePolygons.s_clipPoints1=box2d.b2ClipVertex.MakeArray(2);box2d.b2CollidePolygons.s_clipPoints2=box2d.b2ClipVertex.MakeArray(2);box2d.b2CollidePolygons.s_edgeA=box2d.b2MakeNumberArray(1);box2d.b2CollidePolygons.s_edgeB=box2d.b2MakeNumberArray(1);box2d.b2CollidePolygons.s_localTangent=new box2d.b2Vec2;
box2d.b2CollidePolygons.s_localNormal=new box2d.b2Vec2;box2d.b2CollidePolygons.s_planePoint=new box2d.b2Vec2;box2d.b2CollidePolygons.s_normal=new box2d.b2Vec2;box2d.b2CollidePolygons.s_tangent=new box2d.b2Vec2;box2d.b2CollidePolygons.s_ntangent=new box2d.b2Vec2;box2d.b2CollidePolygons.s_v11=new box2d.b2Vec2;box2d.b2CollidePolygons.s_v12=new box2d.b2Vec2;box2d.b2PolygonContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2PolygonContact,box2d.b2Contact);
box2d.b2PolygonContact.Create=function(a){return new box2d.b2PolygonContact};box2d.b2PolygonContact.Destroy=function(a,b){};box2d.b2PolygonContact.prototype.Reset=function(a,b,c,d){box2d.b2PolygonContact.superClass_.Reset.call(this,a,b,c,d)};
box2d.b2PolygonContact.prototype.Evaluate=function(a,b,c){var d=this.m_fixtureA.GetShape(),e=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(d instanceof box2d.b2PolygonShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2PolygonShape);box2d.b2CollidePolygons(a,d instanceof box2d.b2PolygonShape?d:null,b,e instanceof box2d.b2PolygonShape?e:null,c)};box2d.b2CollideCircle={};
box2d.b2CollideCircles=function(a,b,c,d,e){a.pointCount=0;c=box2d.b2MulXV(c,b.m_p,box2d.b2CollideCircles.s_pA);e=box2d.b2MulXV(e,d.m_p,box2d.b2CollideCircles.s_pB);e=box2d.b2DistanceSquaredVV(c,e);c=b.m_radius+d.m_radius;e>c*c||(a.type=box2d.b2ManifoldType.e_circles,a.localPoint.Copy(b.m_p),a.localNormal.SetZero(),a.pointCount=1,a.points[0].localPoint.Copy(d.m_p),a.points[0].id.key=0)};box2d.b2CollideCircles.s_pA=new box2d.b2Vec2;box2d.b2CollideCircles.s_pB=new box2d.b2Vec2;
box2d.b2CollidePolygonAndCircle=function(a,b,c,d,e){a.pointCount=0;e=box2d.b2MulXV(e,d.m_p,box2d.b2CollidePolygonAndCircle.s_c);c=box2d.b2MulTXV(c,e,box2d.b2CollidePolygonAndCircle.s_cLocal);var f=0,g=-box2d.b2_maxFloat;e=b.m_radius+d.m_radius;var h=b.m_count,k=b.m_vertices;b=b.m_normals;for(var l=0;l<h;++l){var m=box2d.b2DotVV(b[l],box2d.b2SubVV(c,k[l],box2d.b2Vec2.s_t0));if(m>e)return;m>g&&(g=m,f=l)}l=f;m=k[l];h=k[(l+1)%h];if(g<box2d.b2_epsilon)a.pointCount=1,a.type=box2d.b2ManifoldType.e_faceA,
a.localNormal.Copy(b[f]),box2d.b2MidVV(m,h,a.localPoint);else if(g=box2d.b2DotVV(box2d.b2SubVV(c,m,box2d.b2Vec2.s_t0),box2d.b2SubVV(h,m,box2d.b2Vec2.s_t1)),f=box2d.b2DotVV(box2d.b2SubVV(c,h,box2d.b2Vec2.s_t0),box2d.b2SubVV(m,h,box2d.b2Vec2.s_t1)),0>=g){if(box2d.b2DistanceSquaredVV(c,m)>e*e)return;a.pointCount=1;a.type=box2d.b2ManifoldType.e_faceA;box2d.b2SubVV(c,m,a.localNormal).SelfNormalize();a.localPoint.Copy(m)}else if(0>=f){if(box2d.b2DistanceSquaredVV(c,h)>e*e)return;a.pointCount=1;a.type=box2d.b2ManifoldType.e_faceA;
box2d.b2SubVV(c,h,a.localNormal).SelfNormalize();a.localPoint.Copy(h)}else{f=box2d.b2MidVV(m,h,box2d.b2CollidePolygonAndCircle.s_faceCenter);g=box2d.b2DotVV(box2d.b2SubVV(c,f,box2d.b2Vec2.s_t1),b[l]);if(g>e)return;a.pointCount=1;a.type=box2d.b2ManifoldType.e_faceA;a.localNormal.Copy(b[l]).SelfNormalize();a.localPoint.Copy(f)}a.points[0].localPoint.Copy(d.m_p);a.points[0].id.key=0};box2d.b2CollidePolygonAndCircle.s_c=new box2d.b2Vec2;box2d.b2CollidePolygonAndCircle.s_cLocal=new box2d.b2Vec2;
box2d.b2CollidePolygonAndCircle.s_faceCenter=new box2d.b2Vec2;box2d.b2CircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2CircleContact,box2d.b2Contact);box2d.b2CircleContact.Create=function(a){return new box2d.b2CircleContact};box2d.b2CircleContact.Destroy=function(a,b){};box2d.b2CircleContact.prototype.Reset=function(a,b,c,d){box2d.b2CircleContact.superClass_.Reset.call(this,a,b,c,d)};
box2d.b2CircleContact.prototype.Evaluate=function(a,b,c){var d=this.m_fixtureA.GetShape(),e=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(d instanceof box2d.b2CircleShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2CircleShape);box2d.b2CollideCircles(a,d instanceof box2d.b2CircleShape?d:null,b,e instanceof box2d.b2CircleShape?e:null,c)};box2d.b2ChainAndCircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2ChainAndCircleContact,box2d.b2Contact);
box2d.b2ChainAndCircleContact.Create=function(a){return new box2d.b2ChainAndCircleContact};box2d.b2ChainAndCircleContact.Destroy=function(a,b){};box2d.b2ChainAndCircleContact.prototype.Reset=function(a,b,c,d){box2d.b2ChainAndCircleContact.superClass_.Reset.call(this,a,b,c,d);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.GetType()===box2d.b2ShapeType.e_chainShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(c.GetType()===box2d.b2ShapeType.e_circleShape)};
box2d.b2ChainAndCircleContact.prototype.Evaluate=function(a,b,c){var d=this.m_fixtureA.GetShape(),e=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(d instanceof box2d.b2ChainShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2CircleShape);var f=box2d.b2ChainAndCircleContact.prototype.Evaluate.s_edge;(d instanceof box2d.b2ChainShape?d:null).GetChildEdge(f,this.m_indexA);box2d.b2CollideEdgeAndCircle(a,f,b,e instanceof box2d.b2CircleShape?e:null,c)};
box2d.b2ChainAndCircleContact.prototype.Evaluate.s_edge=new box2d.b2EdgeShape;box2d.b2EdgeAndCircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2EdgeAndCircleContact,box2d.b2Contact);box2d.b2EdgeAndCircleContact.Create=function(a){return new box2d.b2EdgeAndCircleContact};box2d.b2EdgeAndCircleContact.Destroy=function(a,b){};
box2d.b2EdgeAndCircleContact.prototype.Reset=function(a,b,c,d){box2d.b2EdgeAndCircleContact.superClass_.Reset.call(this,a,b,c,d);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.GetType()===box2d.b2ShapeType.e_edgeShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(c.GetType()===box2d.b2ShapeType.e_circleShape)};
box2d.b2EdgeAndCircleContact.prototype.Evaluate=function(a,b,c){var d=this.m_fixtureA.GetShape(),e=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(d instanceof box2d.b2EdgeShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2CircleShape);box2d.b2CollideEdgeAndCircle(a,d instanceof box2d.b2EdgeShape?d:null,b,e instanceof box2d.b2CircleShape?e:null,c)};box2d.b2VelocityConstraintPoint=function(){this.rA=new box2d.b2Vec2;this.rB=new box2d.b2Vec2};
box2d.b2VelocityConstraintPoint.prototype.rA=null;box2d.b2VelocityConstraintPoint.prototype.rB=null;box2d.b2VelocityConstraintPoint.prototype.normalImpulse=0;box2d.b2VelocityConstraintPoint.prototype.tangentImpulse=0;box2d.b2VelocityConstraintPoint.prototype.normalMass=0;box2d.b2VelocityConstraintPoint.prototype.tangentMass=0;box2d.b2VelocityConstraintPoint.prototype.velocityBias=0;box2d.b2VelocityConstraintPoint.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2VelocityConstraintPoint})};
box2d.b2ContactVelocityConstraint=function(){this.points=box2d.b2VelocityConstraintPoint.MakeArray(box2d.b2_maxManifoldPoints);this.normal=new box2d.b2Vec2;this.tangent=new box2d.b2Vec2;this.normalMass=new box2d.b2Mat22;this.K=new box2d.b2Mat22};box2d.b2ContactVelocityConstraint.prototype.points=null;box2d.b2ContactVelocityConstraint.prototype.normal=null;box2d.b2ContactVelocityConstraint.prototype.tangent=null;box2d.b2ContactVelocityConstraint.prototype.normalMass=null;
box2d.b2ContactVelocityConstraint.prototype.K=null;box2d.b2ContactVelocityConstraint.prototype.indexA=0;box2d.b2ContactVelocityConstraint.prototype.indexB=0;box2d.b2ContactVelocityConstraint.prototype.invMassA=0;box2d.b2ContactVelocityConstraint.prototype.invMassB=0;box2d.b2ContactVelocityConstraint.prototype.invIA=0;box2d.b2ContactVelocityConstraint.prototype.invIB=0;box2d.b2ContactVelocityConstraint.prototype.friction=0;box2d.b2ContactVelocityConstraint.prototype.restitution=0;
box2d.b2ContactVelocityConstraint.prototype.tangentSpeed=0;box2d.b2ContactVelocityConstraint.prototype.pointCount=0;box2d.b2ContactVelocityConstraint.prototype.contactIndex=0;box2d.b2ContactVelocityConstraint.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2ContactVelocityConstraint})};
box2d.b2ContactPositionConstraint=function(){this.localPoints=box2d.b2Vec2.MakeArray(box2d.b2_maxManifoldPoints);this.localNormal=new box2d.b2Vec2;this.localPoint=new box2d.b2Vec2;this.localCenterA=new box2d.b2Vec2;this.localCenterB=new box2d.b2Vec2};box2d.b2ContactPositionConstraint.prototype.localPoints=null;box2d.b2ContactPositionConstraint.prototype.localNormal=null;box2d.b2ContactPositionConstraint.prototype.localPoint=null;box2d.b2ContactPositionConstraint.prototype.indexA=0;
box2d.b2ContactPositionConstraint.prototype.indexB=0;box2d.b2ContactPositionConstraint.prototype.invMassA=0;box2d.b2ContactPositionConstraint.prototype.invMassB=0;box2d.b2ContactPositionConstraint.prototype.localCenterA=null;box2d.b2ContactPositionConstraint.prototype.localCenterB=null;box2d.b2ContactPositionConstraint.prototype.invIA=0;box2d.b2ContactPositionConstraint.prototype.invIB=0;box2d.b2ContactPositionConstraint.prototype.type=box2d.b2ManifoldType.e_unknown;
box2d.b2ContactPositionConstraint.prototype.radiusA=0;box2d.b2ContactPositionConstraint.prototype.radiusB=0;box2d.b2ContactPositionConstraint.prototype.pointCount=0;box2d.b2ContactPositionConstraint.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2ContactPositionConstraint})};box2d.b2ContactSolverDef=function(){this.step=new box2d.b2TimeStep};box2d.b2ContactSolverDef.prototype.step=null;box2d.b2ContactSolverDef.prototype.contacts=null;
box2d.b2ContactSolverDef.prototype.count=0;box2d.b2ContactSolverDef.prototype.positions=null;box2d.b2ContactSolverDef.prototype.velocities=null;box2d.b2ContactSolverDef.prototype.allocator=null;box2d.b2ContactSolver=function(){this.m_step=new box2d.b2TimeStep;this.m_positionConstraints=box2d.b2ContactPositionConstraint.MakeArray(1024);this.m_velocityConstraints=box2d.b2ContactVelocityConstraint.MakeArray(1024)};box2d.b2ContactSolver.prototype.m_step=null;
box2d.b2ContactSolver.prototype.m_positions=null;box2d.b2ContactSolver.prototype.m_velocities=null;box2d.b2ContactSolver.prototype.m_allocator=null;box2d.b2ContactSolver.prototype.m_positionConstraints=null;box2d.b2ContactSolver.prototype.m_velocityConstraints=null;box2d.b2ContactSolver.prototype.m_contacts=null;box2d.b2ContactSolver.prototype.m_count=0;
box2d.b2ContactSolver.prototype.Initialize=function(a){this.m_step.Copy(a.step);this.m_allocator=a.allocator;this.m_count=a.count;if(this.m_positionConstraints.length<this.m_count){var b=box2d.b2Max(2*this.m_positionConstraints.length,this.m_count);for(box2d.DEBUG&&window.console.log("box2d.b2ContactSolver.m_positionConstraints: "+b);this.m_positionConstraints.length<b;)this.m_positionConstraints[this.m_positionConstraints.length]=new box2d.b2ContactPositionConstraint}if(this.m_velocityConstraints.length<
this.m_count)for(b=box2d.b2Max(2*this.m_velocityConstraints.length,this.m_count),box2d.DEBUG&&window.console.log("box2d.b2ContactSolver.m_velocityConstraints: "+b);this.m_velocityConstraints.length<b;)this.m_velocityConstraints[this.m_velocityConstraints.length]=new box2d.b2ContactVelocityConstraint;this.m_positions=a.positions;this.m_velocities=a.velocities;this.m_contacts=a.contacts;a=0;for(b=this.m_count;a<b;++a){var c=this.m_contacts[a];var d=c.m_fixtureA;var e=c.m_fixtureB;var f=d.GetShape();
var g=e.GetShape();f=f.m_radius;g=g.m_radius;var h=d.GetBody();var k=e.GetBody();e=c.GetManifold();var l=e.pointCount;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<l);d=this.m_velocityConstraints[a];d.friction=c.m_friction;d.restitution=c.m_restitution;d.tangentSpeed=c.m_tangentSpeed;d.indexA=h.m_islandIndex;d.indexB=k.m_islandIndex;d.invMassA=h.m_invMass;d.invMassB=k.m_invMass;d.invIA=h.m_invI;d.invIB=k.m_invI;d.contactIndex=a;d.pointCount=l;d.K.SetZero();d.normalMass.SetZero();c=this.m_positionConstraints[a];
c.indexA=h.m_islandIndex;c.indexB=k.m_islandIndex;c.invMassA=h.m_invMass;c.invMassB=k.m_invMass;c.localCenterA.Copy(h.m_sweep.localCenter);c.localCenterB.Copy(k.m_sweep.localCenter);c.invIA=h.m_invI;c.invIB=k.m_invI;c.localNormal.Copy(e.localNormal);c.localPoint.Copy(e.localPoint);c.pointCount=l;c.radiusA=f;c.radiusB=g;c.type=e.type;f=0;for(g=l;f<g;++f)h=e.points[f],l=d.points[f],this.m_step.warmStarting?(l.normalImpulse=this.m_step.dtRatio*h.normalImpulse,l.tangentImpulse=this.m_step.dtRatio*h.tangentImpulse):
(l.normalImpulse=0,l.tangentImpulse=0),l.rA.SetZero(),l.rB.SetZero(),l.normalMass=0,l.tangentMass=0,l.velocityBias=0,c.localPoints[f].Copy(h.localPoint)}return this};
box2d.b2ContactSolver.prototype.InitializeVelocityConstraints=function(){var a,b=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfA,c=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfB,d=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_worldManifold;var e=0;for(a=this.m_count;e<a;++e){var f=this.m_velocityConstraints[e];var g=this.m_positionConstraints[e];var h=g.radiusA;var k=g.radiusB;var l=this.m_contacts[f.contactIndex].GetManifold();var m=f.indexA;
var n=f.indexB;var p=f.invMassA;var q=f.invMassB;var r=f.invIA;var t=f.invIB;var u=g.localCenterA;var w=g.localCenterB;g=this.m_positions[m].c;var x=this.m_positions[m].a;var A=this.m_velocities[m].v;m=this.m_velocities[m].w;var B=this.m_positions[n].c;var v=this.m_positions[n].a;var y=this.m_velocities[n].v;n=this.m_velocities[n].w;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<l.pointCount);b.q.SetAngleRadians(x);c.q.SetAngleRadians(v);box2d.b2SubVV(g,box2d.b2MulRV(b.q,u,box2d.b2Vec2.s_t0),b.p);box2d.b2SubVV(B,
box2d.b2MulRV(c.q,w,box2d.b2Vec2.s_t0),c.p);d.Initialize(l,b,h,c,k);f.normal.Copy(d.normal);box2d.b2CrossVOne(f.normal,f.tangent);k=f.pointCount;for(h=0;h<k;++h)l=f.points[h],box2d.b2SubVV(d.points[h],g,l.rA),box2d.b2SubVV(d.points[h],B,l.rB),u=box2d.b2CrossVV(l.rA,f.normal),w=box2d.b2CrossVV(l.rB,f.normal),u=p+q+r*u*u+t*w*w,l.normalMass=0<u?1/u:0,w=f.tangent,u=box2d.b2CrossVV(l.rA,w),w=box2d.b2CrossVV(l.rB,w),u=p+q+r*u*u+t*w*w,l.tangentMass=0<u?1/u:0,l.velocityBias=0,u=box2d.b2DotVV(f.normal,box2d.b2SubVV(box2d.b2AddVCrossSV(y,
n,l.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(A,m,l.rA,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0)),u<-box2d.b2_velocityThreshold&&(l.velocityBias+=-f.restitution*u);2===f.pointCount&&(A=f.points[0],B=f.points[1],g=box2d.b2CrossVV(A.rA,f.normal),A=box2d.b2CrossVV(A.rB,f.normal),m=box2d.b2CrossVV(B.rA,f.normal),n=box2d.b2CrossVV(B.rB,f.normal),B=p+q+r*g*g+t*A*A,y=p+q+r*m*m+t*n*n,p=p+q+r*g*m+t*A*n,B*B<1E3*(B*y-p*p)?(f.K.ex.SetXY(B,p),f.K.ey.SetXY(p,y),f.K.GetInverse(f.normalMass)):f.pointCount=1)}};
box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfA=new box2d.b2Transform;box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfB=new box2d.b2Transform;box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_worldManifold=new box2d.b2WorldManifold;
box2d.b2ContactSolver.prototype.WarmStart=function(){var a,b,c=box2d.b2ContactSolver.prototype.WarmStart.s_P;var d=0;for(a=this.m_count;d<a;++d){var e=this.m_velocityConstraints[d];var f=e.indexA;var g=e.indexB;var h=e.invMassA;var k=e.invIA;var l=e.invMassB;var m=e.invIB;var n=e.pointCount;var p=this.m_velocities[f].v;var q=this.m_velocities[f].w;var r=this.m_velocities[g].v;var t=this.m_velocities[g].w;var u=e.normal;var w=e.tangent;for(b=0;b<n;++b){var x=e.points[b];box2d.b2AddVV(box2d.b2MulSV(x.normalImpulse,
u,box2d.b2Vec2.s_t0),box2d.b2MulSV(x.tangentImpulse,w,box2d.b2Vec2.s_t1),c);q-=k*box2d.b2CrossVV(x.rA,c);p.SelfMulSub(h,c);t+=m*box2d.b2CrossVV(x.rB,c);r.SelfMulAdd(l,c)}this.m_velocities[f].w=q;this.m_velocities[g].w=t}};box2d.b2ContactSolver.prototype.WarmStart.s_P=new box2d.b2Vec2;
box2d.b2ContactSolver.prototype.SolveVelocityConstraints=function(){var a,b,c=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv,d=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv1,e=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv2,f=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P,g=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_a,h=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_b,k=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_x,
l=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_d,m=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1,n=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P2,p=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1P2;var q=0;for(a=this.m_count;q<a;++q){var r=this.m_velocityConstraints[q];var t=r.indexA;var u=r.indexB;var w=r.invMassA;var x=r.invIA;var A=r.invMassB;var B=r.invIB;var v=r.pointCount;var y=this.m_velocities[t].v;var E=this.m_velocities[t].w;var F=
this.m_velocities[u].v;var D=this.m_velocities[u].w;var z=r.normal;var C=r.tangent;var H=r.friction;box2d.ENABLE_ASSERTS&&box2d.b2Assert(1===v||2===v);var G=0;for(b=v;G<b;++G){v=r.points[G];box2d.b2SubVV(box2d.b2AddVCrossSV(F,D,v.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(y,E,v.rA,box2d.b2Vec2.s_t1),c);var I=box2d.b2DotVV(c,C)-r.tangentSpeed;I=v.tangentMass*-I;var J=H*v.normalImpulse;J=box2d.b2Clamp(v.tangentImpulse+I,-J,J);I=J-v.tangentImpulse;v.tangentImpulse=J;box2d.b2MulSV(I,C,f);y.SelfMulSub(w,
f);E-=x*box2d.b2CrossVV(v.rA,f);F.SelfMulAdd(A,f);D+=B*box2d.b2CrossVV(v.rB,f)}if(1===r.pointCount)v=r.points[0],box2d.b2SubVV(box2d.b2AddVCrossSV(F,D,v.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(y,E,v.rA,box2d.b2Vec2.s_t1),c),r=box2d.b2DotVV(c,z),I=-v.normalMass*(r-v.velocityBias),J=box2d.b2Max(v.normalImpulse+I,0),I=J-v.normalImpulse,v.normalImpulse=J,box2d.b2MulSV(I,z,f),y.SelfMulSub(w,f),E-=x*box2d.b2CrossVV(v.rA,f),F.SelfMulAdd(A,f),D+=B*box2d.b2CrossVV(v.rB,f);else for(G=r.points[0],C=r.points[1],
g.SetXY(G.normalImpulse,C.normalImpulse),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=g.x&&0<=g.y),box2d.b2SubVV(box2d.b2AddVCrossSV(F,D,G.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(y,E,G.rA,box2d.b2Vec2.s_t1),d),box2d.b2SubVV(box2d.b2AddVCrossSV(F,D,C.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(y,E,C.rA,box2d.b2Vec2.s_t1),e),H=box2d.b2DotVV(d,z),v=box2d.b2DotVV(e,z),h.x=H-G.velocityBias,h.y=v-C.velocityBias,h.SelfSub(box2d.b2MulMV(r.K,g,box2d.b2Vec2.s_t0));;){box2d.b2MulMV(r.normalMass,h,k).SelfNeg();if(0<=
k.x&&0<=k.y){box2d.b2SubVV(k,g,l);box2d.b2MulSV(l.x,z,m);box2d.b2MulSV(l.y,z,n);box2d.b2AddVV(m,n,p);y.SelfMulSub(w,p);E-=x*(box2d.b2CrossVV(G.rA,m)+box2d.b2CrossVV(C.rA,n));F.SelfMulAdd(A,p);D+=B*(box2d.b2CrossVV(G.rB,m)+box2d.b2CrossVV(C.rB,n));G.normalImpulse=k.x;C.normalImpulse=k.y;break}k.x=-G.normalMass*h.x;k.y=0;v=r.K.ex.y*k.x+h.y;if(0<=k.x&&0<=v){box2d.b2SubVV(k,g,l);box2d.b2MulSV(l.x,z,m);box2d.b2MulSV(l.y,z,n);box2d.b2AddVV(m,n,p);y.SelfMulSub(w,p);E-=x*(box2d.b2CrossVV(G.rA,m)+box2d.b2CrossVV(C.rA,
n));F.SelfMulAdd(A,p);D+=B*(box2d.b2CrossVV(G.rB,m)+box2d.b2CrossVV(C.rB,n));G.normalImpulse=k.x;C.normalImpulse=k.y;break}k.x=0;k.y=-C.normalMass*h.y;H=r.K.ey.x*k.y+h.x;if(0<=k.y&&0<=H){box2d.b2SubVV(k,g,l);box2d.b2MulSV(l.x,z,m);box2d.b2MulSV(l.y,z,n);box2d.b2AddVV(m,n,p);y.SelfMulSub(w,p);E-=x*(box2d.b2CrossVV(G.rA,m)+box2d.b2CrossVV(C.rA,n));F.SelfMulAdd(A,p);D+=B*(box2d.b2CrossVV(G.rB,m)+box2d.b2CrossVV(C.rB,n));G.normalImpulse=k.x;C.normalImpulse=k.y;break}k.x=0;k.y=0;H=h.x;v=h.y;if(0<=H&&0<=
v){box2d.b2SubVV(k,g,l);box2d.b2MulSV(l.x,z,m);box2d.b2MulSV(l.y,z,n);box2d.b2AddVV(m,n,p);y.SelfMulSub(w,p);E-=x*(box2d.b2CrossVV(G.rA,m)+box2d.b2CrossVV(C.rA,n));F.SelfMulAdd(A,p);D+=B*(box2d.b2CrossVV(G.rB,m)+box2d.b2CrossVV(C.rB,n));G.normalImpulse=k.x;C.normalImpulse=k.y;break}break}this.m_velocities[t].w=E;this.m_velocities[u].w=D}};box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv1=new box2d.b2Vec2;
box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv2=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_a=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_b=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_x=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_d=new box2d.b2Vec2;
box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P2=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1P2=new box2d.b2Vec2;
box2d.b2ContactSolver.prototype.StoreImpulses=function(){var a,b;var c=0;for(a=this.m_count;c<a;++c){var d=this.m_velocityConstraints[c];var e=this.m_contacts[d.contactIndex].GetManifold();var f=0;for(b=d.pointCount;f<b;++f)e.points[f].normalImpulse=d.points[f].normalImpulse,e.points[f].tangentImpulse=d.points[f].tangentImpulse}};box2d.b2PositionSolverManifold=function(){this.normal=new box2d.b2Vec2;this.point=new box2d.b2Vec2};box2d.b2PositionSolverManifold.prototype.normal=null;
box2d.b2PositionSolverManifold.prototype.point=null;box2d.b2PositionSolverManifold.prototype.separation=0;
box2d.b2PositionSolverManifold.prototype.Initialize=function(a,b,c,d){var e=box2d.b2PositionSolverManifold.prototype.Initialize.s_pointA,f=box2d.b2PositionSolverManifold.prototype.Initialize.s_pointB,g=box2d.b2PositionSolverManifold.prototype.Initialize.s_planePoint,h=box2d.b2PositionSolverManifold.prototype.Initialize.s_clipPoint;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<a.pointCount);switch(a.type){case box2d.b2ManifoldType.e_circles:box2d.b2MulXV(b,a.localPoint,e);box2d.b2MulXV(c,a.localPoints[0],
f);box2d.b2SubVV(f,e,this.normal).SelfNormalize();box2d.b2MidVV(e,f,this.point);this.separation=box2d.b2DotVV(box2d.b2SubVV(f,e,box2d.b2Vec2.s_t0),this.normal)-a.radiusA-a.radiusB;break;case box2d.b2ManifoldType.e_faceA:box2d.b2MulRV(b.q,a.localNormal,this.normal);box2d.b2MulXV(b,a.localPoint,g);box2d.b2MulXV(c,a.localPoints[d],h);this.separation=box2d.b2DotVV(box2d.b2SubVV(h,g,box2d.b2Vec2.s_t0),this.normal)-a.radiusA-a.radiusB;this.point.Copy(h);break;case box2d.b2ManifoldType.e_faceB:box2d.b2MulRV(c.q,
a.localNormal,this.normal),box2d.b2MulXV(c,a.localPoint,g),box2d.b2MulXV(b,a.localPoints[d],h),this.separation=box2d.b2DotVV(box2d.b2SubVV(h,g,box2d.b2Vec2.s_t0),this.normal)-a.radiusA-a.radiusB,this.point.Copy(h),this.normal.SelfNeg()}};box2d.b2PositionSolverManifold.prototype.Initialize.s_pointA=new box2d.b2Vec2;box2d.b2PositionSolverManifold.prototype.Initialize.s_pointB=new box2d.b2Vec2;box2d.b2PositionSolverManifold.prototype.Initialize.s_planePoint=new box2d.b2Vec2;
box2d.b2PositionSolverManifold.prototype.Initialize.s_clipPoint=new box2d.b2Vec2;
box2d.b2ContactSolver.prototype.SolvePositionConstraints=function(){var a,b,c=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfA,d=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfB,e=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_psm,f=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rA,g=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rB,h=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_P,k=0;var l=0;for(a=this.m_count;l<a;++l){var m=
this.m_positionConstraints[l];var n=m.indexA;var p=m.indexB;var q=m.localCenterA;var r=m.invMassA;var t=m.invIA;var u=m.localCenterB;var w=m.invMassB;var x=m.invIB;var A=m.pointCount;var B=this.m_positions[n].c;var v=this.m_positions[n].a;var y=this.m_positions[p].c;var E=this.m_positions[p].a;for(b=0;b<A;++b){c.q.SetAngleRadians(v);d.q.SetAngleRadians(E);box2d.b2SubVV(B,box2d.b2MulRV(c.q,q,box2d.b2Vec2.s_t0),c.p);box2d.b2SubVV(y,box2d.b2MulRV(d.q,u,box2d.b2Vec2.s_t0),d.p);e.Initialize(m,c,d,b);var F=
e.normal;var D=e.point;var z=e.separation;box2d.b2SubVV(D,B,f);box2d.b2SubVV(D,y,g);k=box2d.b2Min(k,z);D=box2d.b2Clamp(box2d.b2_baumgarte*(z+box2d.b2_linearSlop),-box2d.b2_maxLinearCorrection,0);z=box2d.b2CrossVV(f,F);var C=box2d.b2CrossVV(g,F);z=r+w+t*z*z+x*C*C;D=0<z?-D/z:0;box2d.b2MulSV(D,F,h);B.SelfMulSub(r,h);v-=t*box2d.b2CrossVV(f,h);y.SelfMulAdd(w,h);E+=x*box2d.b2CrossVV(g,h)}this.m_positions[n].a=v;this.m_positions[p].a=E}return k>-3*box2d.b2_linearSlop};
box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfA=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfB=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_psm=new box2d.b2PositionSolverManifold;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rA=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rB=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;
box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints=function(a,b){var c,d,e,f,g=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfA,h=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfB,k=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_psm,l=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rA,m=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rB,n=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_P,p=0;var q=0;
for(c=this.m_count;q<c;++q){var r=this.m_positionConstraints[q];var t=r.indexA;var u=r.indexB;var w=r.localCenterA;var x=r.localCenterB;var A=r.pointCount;var B=e=0;if(t===a||t===b)e=r.invMassA,B=r.invIA;var v=f=0;if(u===a||u===b)f=r.invMassB,v=r.invIB;var y=this.m_positions[t].c;var E=this.m_positions[t].a;var F=this.m_positions[u].c;var D=this.m_positions[u].a;for(d=0;d<A;++d){g.q.SetAngleRadians(E);h.q.SetAngleRadians(D);box2d.b2SubVV(y,box2d.b2MulRV(g.q,w,box2d.b2Vec2.s_t0),g.p);box2d.b2SubVV(F,
box2d.b2MulRV(h.q,x,box2d.b2Vec2.s_t0),h.p);k.Initialize(r,g,h,d);var z=k.normal;var C=k.point;var H=k.separation;box2d.b2SubVV(C,y,l);box2d.b2SubVV(C,F,m);p=box2d.b2Min(p,H);C=box2d.b2Clamp(box2d.b2_toiBaumgarte*(H+box2d.b2_linearSlop),-box2d.b2_maxLinearCorrection,0);H=box2d.b2CrossVV(l,z);var G=box2d.b2CrossVV(m,z);H=e+f+B*H*H+v*G*G;C=0<H?-C/H:0;box2d.b2MulSV(C,z,n);y.SelfMulSub(e,n);E-=B*box2d.b2CrossVV(l,n);F.SelfMulAdd(f,n);D+=v*box2d.b2CrossVV(m,n)}this.m_positions[t].a=E;this.m_positions[u].a=
D}return p>=-1.5*box2d.b2_linearSlop};box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfA=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfB=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_psm=new box2d.b2PositionSolverManifold;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rA=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rB=new box2d.b2Vec2;
box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_P=new box2d.b2Vec2;box2d.b2WorldCallbacks={};box2d.b2DestructionListener=function(){};box2d.b2DestructionListener.prototype.SayGoodbyeJoint=function(a){};box2d.b2DestructionListener.prototype.SayGoodbyeFixture=function(a){};box2d.b2ContactFilter=function(){};
box2d.b2ContactFilter.prototype.ShouldCollide=function(a,b){var c=a.GetFilterData(),d=b.GetFilterData();return c.groupIndex===d.groupIndex&&0!==c.groupIndex?0<c.groupIndex:0!==(c.maskBits&d.categoryBits)&&0!==(c.categoryBits&d.maskBits)};box2d.b2ContactFilter.b2_defaultFilter=new box2d.b2ContactFilter;box2d.b2ContactImpulse=function(){this.normalImpulses=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints);this.tangentImpulses=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints)};
box2d.b2ContactImpulse.prototype.normalImpulses=null;box2d.b2ContactImpulse.prototype.tangentImpulses=null;box2d.b2ContactImpulse.prototype.count=0;box2d.b2ContactListener=function(){};box2d.b2ContactListener.prototype.BeginContact=function(a){};box2d.b2ContactListener.prototype.EndContact=function(a){};box2d.b2ContactListener.prototype.PreSolve=function(a,b){};box2d.b2ContactListener.prototype.PostSolve=function(a,b){};box2d.b2ContactListener.b2_defaultListener=new box2d.b2ContactListener;
box2d.b2QueryCallback=function(){};box2d.b2QueryCallback.prototype.ReportFixture=function(a){return!0};box2d.b2RayCastCallback=function(){};box2d.b2RayCastCallback.prototype.ReportFixture=function(a,b,c,d){return d};box2d.b2Island=function(){this.m_bodies=Array(1024);this.m_contacts=Array(1024);this.m_joints=Array(1024);this.m_positions=box2d.b2Position.MakeArray(1024);this.m_velocities=box2d.b2Velocity.MakeArray(1024)};box2d.b2Island.prototype.m_allocator=null;
box2d.b2Island.prototype.m_listener=null;box2d.b2Island.prototype.m_bodies=null;box2d.b2Island.prototype.m_contacts=null;box2d.b2Island.prototype.m_joints=null;box2d.b2Island.prototype.m_positions=null;box2d.b2Island.prototype.m_velocities=null;box2d.b2Island.prototype.m_bodyCount=0;box2d.b2Island.prototype.m_jointCount=0;box2d.b2Island.prototype.m_contactCount=0;box2d.b2Island.prototype.m_bodyCapacity=0;box2d.b2Island.prototype.m_contactCapacity=0;box2d.b2Island.prototype.m_jointCapacity=0;
box2d.b2Island.prototype.Initialize=function(a,b,c,d,e){this.m_bodyCapacity=a;this.m_contactCapacity=b;this.m_jointCapacity=c;this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;this.m_allocator=d;for(this.m_listener=e;this.m_bodies.length<a;)this.m_bodies[this.m_bodies.length]=null;for(;this.m_contacts.length<b;)this.m_contacts[this.m_contacts.length]=null;for(;this.m_joints.length<c;)this.m_joints[this.m_joints.length]=null;if(this.m_positions.length<a)for(b=box2d.b2Max(2*this.m_positions.length,
a),box2d.DEBUG&&window.console.log("box2d.b2Island.m_positions: "+b);this.m_positions.length<b;)this.m_positions[this.m_positions.length]=new box2d.b2Position;if(this.m_velocities.length<a)for(b=box2d.b2Max(2*this.m_velocities.length,a),box2d.DEBUG&&window.console.log("box2d.b2Island.m_velocities: "+b);this.m_velocities.length<b;)this.m_velocities[this.m_velocities.length]=new box2d.b2Velocity};box2d.b2Island.prototype.Clear=function(){this.m_jointCount=this.m_contactCount=this.m_bodyCount=0};
box2d.b2Island.prototype.AddBody=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_bodyCount<this.m_bodyCapacity);a.m_islandIndex=this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=a};box2d.b2Island.prototype.AddContact=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_contactCount<this.m_contactCapacity);this.m_contacts[this.m_contactCount++]=a};
box2d.b2Island.prototype.AddJoint=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_jointCount<this.m_jointCapacity);this.m_joints[this.m_jointCount++]=a};
box2d.b2Island.prototype.Solve=function(a,b,c,d){for(var e=box2d.b2Island.s_timer.Reset(),f=b.dt,g=0;g<this.m_bodyCount;++g){var h=this.m_bodies[g];this.m_positions[g].c.Copy(h.m_sweep.c);var k=h.m_sweep.a,l=this.m_velocities[g].v.Copy(h.m_linearVelocity),m=h.m_angularVelocity;h.m_sweep.c0.Copy(h.m_sweep.c);h.m_sweep.a0=h.m_sweep.a;h.m_type===box2d.b2BodyType.b2_dynamicBody&&(l.x+=f*(h.m_gravityScale*c.x+h.m_invMass*h.m_force.x),l.y+=f*(h.m_gravityScale*c.y+h.m_invMass*h.m_force.y),m+=f*h.m_invI*
h.m_torque,l.SelfMul(1/(1+f*h.m_linearDamping)),m*=1/(1+f*h.m_angularDamping));this.m_positions[g].a=k;this.m_velocities[g].w=m}e.Reset();h=box2d.b2Island.s_solverData;h.step.Copy(b);h.positions=this.m_positions;h.velocities=this.m_velocities;g=box2d.b2Island.s_contactSolverDef;g.step.Copy(b);g.contacts=this.m_contacts;g.count=this.m_contactCount;g.positions=this.m_positions;g.velocities=this.m_velocities;g.allocator=this.m_allocator;c=box2d.b2Island.s_contactSolver.Initialize(g);c.InitializeVelocityConstraints();
b.warmStarting&&c.WarmStart();for(g=0;g<this.m_jointCount;++g)this.m_joints[g].InitVelocityConstraints(h);a.solveInit=e.GetMilliseconds();e.Reset();for(g=0;g<b.velocityIterations;++g){for(l=0;l<this.m_jointCount;++l)this.m_joints[l].SolveVelocityConstraints(h);c.SolveVelocityConstraints()}c.StoreImpulses();a.solveVelocity=e.GetMilliseconds();for(g=0;g<this.m_bodyCount;++g){var n=this.m_positions[g].c;k=this.m_positions[g].a;l=this.m_velocities[g].v;m=this.m_velocities[g].w;var p=box2d.b2MulSV(f,l,
box2d.b2Island.s_translation);box2d.b2DotVV(p,p)>box2d.b2_maxTranslationSquared&&(p=box2d.b2_maxTranslation/p.GetLength(),l.SelfMul(p));p=f*m;p*p>box2d.b2_maxRotationSquared&&(p=box2d.b2_maxRotation/box2d.b2Abs(p),m*=p);n.x+=f*l.x;n.y+=f*l.y;k+=f*m;this.m_positions[g].a=k;this.m_velocities[g].w=m}e.Reset();k=!1;for(g=0;g<b.positionIterations;++g){m=c.SolvePositionConstraints();n=!0;for(l=0;l<this.m_jointCount;++l)p=this.m_joints[l].SolvePositionConstraints(h),n=n&&p;if(m&&n){k=!0;break}}for(g=0;g<
this.m_bodyCount;++g)b=this.m_bodies[g],b.m_sweep.c.Copy(this.m_positions[g].c),b.m_sweep.a=this.m_positions[g].a,b.m_linearVelocity.Copy(this.m_velocities[g].v),b.m_angularVelocity=this.m_velocities[g].w,b.SynchronizeTransform();a.solvePosition=e.GetMilliseconds();this.Report(c.m_velocityConstraints);if(d){a=box2d.b2_maxFloat;d=box2d.b2_linearSleepTolerance*box2d.b2_linearSleepTolerance;e=box2d.b2_angularSleepTolerance*box2d.b2_angularSleepTolerance;for(g=0;g<this.m_bodyCount;++g)h=this.m_bodies[g],
h.GetType()!==box2d.b2BodyType.b2_staticBody&&(0===(h.m_flags&box2d.b2BodyFlag.e_autoSleepFlag)||h.m_angularVelocity*h.m_angularVelocity>e||box2d.b2DotVV(h.m_linearVelocity,h.m_linearVelocity)>d?a=h.m_sleepTime=0:(h.m_sleepTime+=f,a=box2d.b2Min(a,h.m_sleepTime)));if(a>=box2d.b2_timeToSleep&&k)for(g=0;g<this.m_bodyCount;++g)h=this.m_bodies[g],h.SetAwake(!1)}};
box2d.b2Island.prototype.SolveTOI=function(a,b,c){box2d.ENABLE_ASSERTS&&box2d.b2Assert(b<this.m_bodyCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(c<this.m_bodyCount);for(var d=0;d<this.m_bodyCount;++d){var e=this.m_bodies[d];this.m_positions[d].c.Copy(e.m_sweep.c);this.m_positions[d].a=e.m_sweep.a;this.m_velocities[d].v.Copy(e.m_linearVelocity);this.m_velocities[d].w=e.m_angularVelocity}d=box2d.b2Island.s_contactSolverDef;d.contacts=this.m_contacts;d.count=this.m_contactCount;d.allocator=this.m_allocator;
d.step.Copy(a);d.positions=this.m_positions;d.velocities=this.m_velocities;e=box2d.b2Island.s_contactSolver.Initialize(d);for(d=0;d<a.positionIterations&&!e.SolveTOIPositionConstraints(b,c);++d);this.m_bodies[b].m_sweep.c0.Copy(this.m_positions[b].c);this.m_bodies[b].m_sweep.a0=this.m_positions[b].a;this.m_bodies[c].m_sweep.c0.Copy(this.m_positions[c].c);this.m_bodies[c].m_sweep.a0=this.m_positions[c].a;e.InitializeVelocityConstraints();for(d=0;d<a.velocityIterations;++d)e.SolveVelocityConstraints();
a=a.dt;for(d=0;d<this.m_bodyCount;++d){b=this.m_positions[d].c;c=this.m_positions[d].a;var f=this.m_velocities[d].v,g=this.m_velocities[d].w,h=box2d.b2MulSV(a,f,box2d.b2Island.s_translation);box2d.b2DotVV(h,h)>box2d.b2_maxTranslationSquared&&(h=box2d.b2_maxTranslation/h.GetLength(),f.SelfMul(h));h=a*g;h*h>box2d.b2_maxRotationSquared&&(h=box2d.b2_maxRotation/box2d.b2Abs(h),g*=h);b.SelfMulAdd(a,f);c+=a*g;this.m_positions[d].a=c;this.m_velocities[d].w=g;h=this.m_bodies[d];h.m_sweep.c.Copy(b);h.m_sweep.a=
c;h.m_linearVelocity.Copy(f);h.m_angularVelocity=g;h.SynchronizeTransform()}this.Report(e.m_velocityConstraints)};box2d.b2Island.prototype.Report=function(a){if(null!==this.m_listener)for(var b=0;b<this.m_contactCount;++b){var c=this.m_contacts[b];if(c){var d=a[b],e=box2d.b2Island.s_impulse;e.count=d.pointCount;for(var f=0;f<d.pointCount;++f)e.normalImpulses[f]=d.points[f].normalImpulse,e.tangentImpulses[f]=d.points[f].tangentImpulse;this.m_listener.PostSolve(c,e)}}};box2d.b2Island.s_timer=new box2d.b2Timer;
box2d.b2Island.s_solverData=new box2d.b2SolverData;box2d.b2Island.s_contactSolverDef=new box2d.b2ContactSolverDef;box2d.b2Island.s_contactSolver=new box2d.b2ContactSolver;box2d.b2Island.s_translation=new box2d.b2Vec2;box2d.b2Island.s_impulse=new box2d.b2ContactImpulse;box2d.b2ContactRegister=function(){};box2d.b2ContactRegister.prototype.createFcn=null;box2d.b2ContactRegister.prototype.destroyFcn=null;box2d.b2ContactRegister.prototype.primary=!1;
box2d.b2ContactFactory=function(a){this.m_allocator=a;this.InitializeRegisters()};box2d.b2ContactFactory.prototype.m_allocator=null;
box2d.b2ContactFactory.prototype.AddType=function(a,b,c,d){var e=box2d.b2MakeArray(256,function(b){return a()});b=function(b){return 0<e.length?e.pop():a(b)};var f=function(a,b){e.push(a)};this.m_registers[c][d].pool=e;this.m_registers[c][d].createFcn=b;this.m_registers[c][d].destroyFcn=f;this.m_registers[c][d].primary=!0;c!==d&&(this.m_registers[d][c].pool=e,this.m_registers[d][c].createFcn=b,this.m_registers[d][c].destroyFcn=f,this.m_registers[d][c].primary=!1)};
box2d.b2ContactFactory.prototype.InitializeRegisters=function(){this.m_registers=Array(box2d.b2ShapeType.e_shapeTypeCount);for(var a=0;a<box2d.b2ShapeType.e_shapeTypeCount;a++){this.m_registers[a]=Array(box2d.b2ShapeType.e_shapeTypeCount);for(var b=0;b<box2d.b2ShapeType.e_shapeTypeCount;b++)this.m_registers[a][b]=new box2d.b2ContactRegister}this.AddType(box2d.b2CircleContact.Create,box2d.b2CircleContact.Destroy,box2d.b2ShapeType.e_circleShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2PolygonAndCircleContact.Create,
box2d.b2PolygonAndCircleContact.Destroy,box2d.b2ShapeType.e_polygonShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2PolygonContact.Create,box2d.b2PolygonContact.Destroy,box2d.b2ShapeType.e_polygonShape,box2d.b2ShapeType.e_polygonShape);this.AddType(box2d.b2EdgeAndCircleContact.Create,box2d.b2EdgeAndCircleContact.Destroy,box2d.b2ShapeType.e_edgeShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2EdgeAndPolygonContact.Create,box2d.b2EdgeAndPolygonContact.Destroy,box2d.b2ShapeType.e_edgeShape,
box2d.b2ShapeType.e_polygonShape);this.AddType(box2d.b2ChainAndCircleContact.Create,box2d.b2ChainAndCircleContact.Destroy,box2d.b2ShapeType.e_chainShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2ChainAndPolygonContact.Create,box2d.b2ChainAndPolygonContact.Destroy,box2d.b2ShapeType.e_chainShape,box2d.b2ShapeType.e_polygonShape)};
box2d.b2ContactFactory.prototype.Create=function(a,b,c,d){var e=a.GetType(),f=c.GetType();box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=e&&e<box2d.b2ShapeType.e_shapeTypeCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=f&&f<box2d.b2ShapeType.e_shapeTypeCount);e=this.m_registers[e][f];f=e.createFcn;return null!==f?(e.primary?(e=f(this.m_allocator),e.Reset(a,b,c,d)):(e=f(this.m_allocator),e.Reset(c,d,a,b)),e):null};
box2d.b2ContactFactory.prototype.Destroy=function(a){var b=a.m_fixtureA,c=a.m_fixtureB;0<a.m_manifold.pointCount&&!1===b.IsSensor()&&!1===c.IsSensor()&&(b.GetBody().SetAwake(!0),c.GetBody().SetAwake(!0));b=b.GetType();c=c.GetType();box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=b&&c<box2d.b2ShapeType.e_shapeTypeCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=b&&c<box2d.b2ShapeType.e_shapeTypeCount);c=this.m_registers[b][c].destroyFcn;c(a,this.m_allocator)};box2d.b2GrowableStack=function(a){this.m_stack=Array(a)};
box2d.b2GrowableStack.prototype.m_stack=null;box2d.b2GrowableStack.prototype.m_count=0;box2d.b2GrowableStack.prototype.Reset=function(){this.m_count=0;return this};box2d.b2GrowableStack.prototype.Push=function(a){this.m_stack[this.m_count]=a;++this.m_count};box2d.b2GrowableStack.prototype.Pop=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_count);--this.m_count;var a=this.m_stack[this.m_count];this.m_stack[this.m_count]=null;return a};box2d.b2GrowableStack.prototype.GetCount=function(){return this.m_count};
box2d.b2TreeNode=function(a){this.m_id=a||0;this.aabb=new box2d.b2AABB};box2d.b2TreeNode.prototype.m_id=0;box2d.b2TreeNode.prototype.aabb=null;box2d.b2TreeNode.prototype.userData=null;box2d.b2TreeNode.prototype.parent=null;box2d.b2TreeNode.prototype.child1=null;box2d.b2TreeNode.prototype.child2=null;box2d.b2TreeNode.prototype.height=0;box2d.b2TreeNode.prototype.IsLeaf=function(){return null===this.child1};box2d.b2DynamicTree=function(){};box2d.b2DynamicTree.prototype.m_root=null;
box2d.b2DynamicTree.prototype.m_freeList=null;box2d.b2DynamicTree.prototype.m_path=0;box2d.b2DynamicTree.prototype.m_insertionCount=0;box2d.b2DynamicTree.s_stack=new box2d.b2GrowableStack(256);box2d.b2DynamicTree.s_r=new box2d.b2Vec2;box2d.b2DynamicTree.s_v=new box2d.b2Vec2;box2d.b2DynamicTree.s_abs_v=new box2d.b2Vec2;box2d.b2DynamicTree.s_segmentAABB=new box2d.b2AABB;box2d.b2DynamicTree.s_subInput=new box2d.b2RayCastInput;box2d.b2DynamicTree.s_combinedAABB=new box2d.b2AABB;
box2d.b2DynamicTree.s_aabb=new box2d.b2AABB;box2d.b2DynamicTree.prototype.GetUserData=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==a);return a.userData};box2d.b2DynamicTree.prototype.GetFatAABB=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==a);return a.aabb};
box2d.b2DynamicTree.prototype.Query=function(a,b){if(null!==this.m_root){var c=box2d.b2DynamicTree.s_stack.Reset();for(c.Push(this.m_root);0<c.GetCount();){var d=c.Pop();if(null!==d&&d.aabb.TestOverlap(b))if(d.IsLeaf()){if(!1===a(d))break}else c.Push(d.child1),c.Push(d.child2)}}};
box2d.b2DynamicTree.prototype.RayCast=function(a,b){if(null!==this.m_root){var c=b.p1,d=b.p2,e=box2d.b2SubVV(d,c,box2d.b2DynamicTree.s_r);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<e.GetLengthSquared());e.Normalize();e=box2d.b2CrossOneV(e,box2d.b2DynamicTree.s_v);var f=box2d.b2AbsV(e,box2d.b2DynamicTree.s_abs_v),g=b.maxFraction,h=box2d.b2DynamicTree.s_segmentAABB,k=c.x+g*(d.x-c.x),l=c.y+g*(d.y-c.y);h.lowerBound.x=box2d.b2Min(c.x,k);h.lowerBound.y=box2d.b2Min(c.y,l);h.upperBound.x=box2d.b2Max(c.x,k);h.upperBound.y=
box2d.b2Max(c.y,l);var m=box2d.b2DynamicTree.s_stack.Reset();for(m.Push(this.m_root);0<m.GetCount();)if(k=m.Pop(),null!==k&&!1!==box2d.b2TestOverlapAABB(k.aabb,h)){l=k.aabb.GetCenter();var n=k.aabb.GetExtents();if(!(0<box2d.b2Abs(box2d.b2DotVV(e,box2d.b2SubVV(c,l,box2d.b2Vec2.s_t0)))-box2d.b2DotVV(f,n)))if(k.IsLeaf()){l=box2d.b2DynamicTree.s_subInput;l.p1.Copy(b.p1);l.p2.Copy(b.p2);l.maxFraction=g;k=a(l,k);if(0===k)break;0<k&&(g=k,k=c.x+g*(d.x-c.x),l=c.y+g*(d.y-c.y),h.lowerBound.x=box2d.b2Min(c.x,
k),h.lowerBound.y=box2d.b2Min(c.y,l),h.upperBound.x=box2d.b2Max(c.x,k),h.upperBound.y=box2d.b2Max(c.y,l))}else m.Push(k.child1),m.Push(k.child2)}}};box2d.b2DynamicTree.prototype.AllocateNode=function(){if(this.m_freeList){var a=this.m_freeList;this.m_freeList=a.parent;a.parent=null;a.child1=null;a.child2=null;a.height=0;a.userData=null;return a}return new box2d.b2TreeNode(box2d.b2DynamicTree.prototype.s_node_id++)};box2d.b2DynamicTree.prototype.s_node_id=0;
box2d.b2DynamicTree.prototype.FreeNode=function(a){a.parent=this.m_freeList;a.height=-1;this.m_freeList=a};box2d.b2DynamicTree.prototype.CreateProxy=function(a,b){var c=this.AllocateNode(),d=box2d.b2_aabbExtension,e=box2d.b2_aabbExtension;c.aabb.lowerBound.x=a.lowerBound.x-d;c.aabb.lowerBound.y=a.lowerBound.y-e;c.aabb.upperBound.x=a.upperBound.x+d;c.aabb.upperBound.y=a.upperBound.y+e;c.userData=b;c.height=0;this.InsertLeaf(c);return c};
box2d.b2DynamicTree.prototype.DestroyProxy=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.IsLeaf());this.RemoveLeaf(a);this.FreeNode(a)};
box2d.b2DynamicTree.prototype.MoveProxy=function(a,b,c){box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.IsLeaf());if(a.aabb.Contains(b))return!1;this.RemoveLeaf(a);var d=box2d.b2_aabbExtension+box2d.b2_aabbMultiplier*(0<c.x?c.x:-c.x);c=box2d.b2_aabbExtension+box2d.b2_aabbMultiplier*(0<c.y?c.y:-c.y);a.aabb.lowerBound.x=b.lowerBound.x-d;a.aabb.lowerBound.y=b.lowerBound.y-c;a.aabb.upperBound.x=b.upperBound.x+d;a.aabb.upperBound.y=b.upperBound.y+c;this.InsertLeaf(a);return!0};
box2d.b2DynamicTree.prototype.InsertLeaf=function(a){++this.m_insertionCount;if(null===this.m_root)this.m_root=a,this.m_root.parent=null;else{var b=a.aabb;b.GetCenter();for(var c=this.m_root,d,e;!1===c.IsLeaf();){d=c.child1;e=c.child2;var f=c.aabb.GetPerimeter(),g=box2d.b2DynamicTree.s_combinedAABB;g.Combine2(c.aabb,b);var h=g.GetPerimeter();g=2*h;h=2*(h-f);var k=box2d.b2DynamicTree.s_aabb;if(d.IsLeaf())k.Combine2(b,d.aabb),f=k.GetPerimeter()+h;else{k.Combine2(b,d.aabb);var l=d.aabb.GetPerimeter();
var m=k.GetPerimeter();f=m-l+h}e.IsLeaf()?(k.Combine2(b,e.aabb),h=k.GetPerimeter()+h):(k.Combine2(b,e.aabb),l=e.aabb.GetPerimeter(),m=k.GetPerimeter(),h=m-l+h);if(g<f&&g<h)break;c=f<h?d:e}d=c.parent;e=this.AllocateNode();e.parent=d;e.userData=null;e.aabb.Combine2(b,c.aabb);e.height=c.height+1;d?(d.child1===c?d.child1=e:d.child2=e,e.child1=c,e.child2=a,c.parent=e,a.parent=e):(e.child1=c,e.child2=a,c.parent=e,this.m_root=a.parent=e);for(c=a.parent;null!==c;)c=this.Balance(c),d=c.child1,e=c.child2,box2d.ENABLE_ASSERTS&&
box2d.b2Assert(null!==d),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==e),c.height=1+box2d.b2Max(d.height,e.height),c.aabb.Combine2(d.aabb,e.aabb),c=c.parent}};
box2d.b2DynamicTree.prototype.RemoveLeaf=function(a){if(a===this.m_root)this.m_root=null;else{var b=a.parent,c=b.parent;a=b.child1===a?b.child2:b.child1;if(c)for(c.child1===b?c.child1=a:c.child2=a,a.parent=c,this.FreeNode(b),b=c;b;)b=this.Balance(b),c=b.child1,a=b.child2,b.aabb.Combine2(c.aabb,a.aabb),b.height=1+box2d.b2Max(c.height,a.height),b=b.parent;else this.m_root=a,a.parent=null,this.FreeNode(b)}};
box2d.b2DynamicTree.prototype.Balance=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==a);if(a.IsLeaf()||2>a.height)return a;var b=a.child1,c=a.child2,d=c.height-b.height;if(1<d){d=c.child1;var e=c.child2;c.child1=a;c.parent=a.parent;a.parent=c;null!==c.parent?c.parent.child1===a?c.parent.child1=c:(box2d.ENABLE_ASSERTS&&box2d.b2Assert(c.parent.child2===a),c.parent.child2=c):this.m_root=c;d.height>e.height?(c.child2=d,a.child2=e,e.parent=a,a.aabb.Combine2(b.aabb,e.aabb),c.aabb.Combine2(a.aabb,
d.aabb),a.height=1+box2d.b2Max(b.height,e.height),c.height=1+box2d.b2Max(a.height,d.height)):(c.child2=e,a.child2=d,d.parent=a,a.aabb.Combine2(b.aabb,d.aabb),c.aabb.Combine2(a.aabb,e.aabb),a.height=1+box2d.b2Max(b.height,d.height),c.height=1+box2d.b2Max(a.height,e.height));return c}return-1>d?(d=b.child1,e=b.child2,b.child1=a,b.parent=a.parent,a.parent=b,null!==b.parent?b.parent.child1===a?b.parent.child1=b:(box2d.ENABLE_ASSERTS&&box2d.b2Assert(b.parent.child2===a),b.parent.child2=b):this.m_root=
b,d.height>e.height?(b.child2=d,a.child1=e,e.parent=a,a.aabb.Combine2(c.aabb,e.aabb),b.aabb.Combine2(a.aabb,d.aabb),a.height=1+box2d.b2Max(c.height,e.height),b.height=1+box2d.b2Max(a.height,d.height)):(b.child2=e,a.child1=d,d.parent=a,a.aabb.Combine2(c.aabb,d.aabb),b.aabb.Combine2(a.aabb,e.aabb),a.height=1+box2d.b2Max(c.height,d.height),b.height=1+box2d.b2Max(a.height,e.height)),b):a};box2d.b2DynamicTree.prototype.GetHeight=function(){return null===this.m_root?0:this.m_root.height};
box2d.b2DynamicTree.prototype.GetAreaRatio=function(){if(null===this.m_root)return 0;var a=this.m_root.aabb.GetPerimeter(),b=function(a){if(null===a||a.IsLeaf())return 0;var c=a.aabb.GetPerimeter();c+=b(a.child1);return c+=b(a.child2)};return b(this.m_root)/a};box2d.b2DynamicTree.prototype.ComputeHeightNode=function(a){if(a.IsLeaf())return 0;var b=this.ComputeHeightNode(a.child1);a=this.ComputeHeightNode(a.child2);return 1+box2d.b2Max(b,a)};box2d.b2DynamicTree.prototype.ComputeHeight=function(){return this.ComputeHeightNode(this.m_root)};
box2d.b2DynamicTree.prototype.ValidateStructure=function(a){if(null!==a){a===this.m_root&&box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===a.parent);var b=a.child1,c=a.child2;a.IsLeaf()?(box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===b),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===c),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===a.height)):(box2d.ENABLE_ASSERTS&&box2d.b2Assert(b.parent===a),box2d.ENABLE_ASSERTS&&box2d.b2Assert(c.parent===a),this.ValidateStructure(b),this.ValidateStructure(c))}};
box2d.b2DynamicTree.prototype.ValidateMetrics=function(a){if(null!==a){var b=a.child1,c=a.child2;if(a.IsLeaf())box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===b),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===c),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===a.height);else{var d=1+box2d.b2Max(b.height,c.height);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.height===d);d=box2d.b2DynamicTree.s_aabb;d.Combine2(b.aabb,c.aabb);box2d.ENABLE_ASSERTS&&box2d.b2Assert(d.lowerBound===a.aabb.lowerBound);box2d.ENABLE_ASSERTS&&box2d.b2Assert(d.upperBound===
a.aabb.upperBound);this.ValidateMetrics(b);this.ValidateMetrics(c)}}};box2d.b2DynamicTree.prototype.Validate=function(){this.ValidateStructure(this.m_root);this.ValidateMetrics(this.m_root);for(var a=0,b=this.m_freeList;null!==b;)b=b.parent,++a;box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.GetHeight()===this.ComputeHeight())};
box2d.b2DynamicTree.prototype.GetMaxBalance=function(){var a=this.m_root;null===a?a=0:1>=a.height?a=0:(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===a.IsLeaf()),a=box2d.b2Abs(a.child2.height-a.child1.height),a=box2d.b2Max(0,a));return a};box2d.b2DynamicTree.prototype.RebuildBottomUp=function(){this.Validate()};
box2d.b2DynamicTree.prototype.ShiftOrigin=function(a){var b=function(a,d){if(null!==a&&!(1>=a.height)){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===a.IsLeaf());var c=a.child2;b(a.child1,d);b(c,d);a.aabb.lowerBound.SelfSub(d);a.aabb.upperBound.SelfSub(d)}};b(this.m_root,a)};box2d.b2Pair=function(){};box2d.b2Pair.prototype.proxyA=null;box2d.b2Pair.prototype.proxyB=null;box2d.b2BroadPhase=function(){this.m_tree=new box2d.b2DynamicTree;this.m_moveBuffer=[];this.m_pairBuffer=[]};
box2d.b2BroadPhase.prototype.m_tree=null;box2d.b2BroadPhase.prototype.m_proxyCount=0;box2d.b2BroadPhase.prototype.m_moveCount=0;box2d.b2BroadPhase.prototype.m_moveBuffer=null;box2d.b2BroadPhase.prototype.m_pairCount=0;box2d.b2BroadPhase.prototype.m_pairBuffer=null;box2d.b2BroadPhase.prototype.CreateProxy=function(a,b){var c=this.m_tree.CreateProxy(a,b);++this.m_proxyCount;this.BufferMove(c);return c};box2d.b2BroadPhase.prototype.DestroyProxy=function(a){this.UnBufferMove(a);--this.m_proxyCount;this.m_tree.DestroyProxy(a)};
box2d.b2BroadPhase.prototype.MoveProxy=function(a,b,c){this.m_tree.MoveProxy(a,b,c)&&this.BufferMove(a)};box2d.b2BroadPhase.prototype.TouchProxy=function(a){this.BufferMove(a)};box2d.b2BroadPhase.prototype.GetFatAABB=function(a){return this.m_tree.GetFatAABB(a)};box2d.b2BroadPhase.prototype.GetUserData=function(a){return this.m_tree.GetUserData(a)};box2d.b2BroadPhase.prototype.TestOverlap=function(a,b){var c=this.m_tree.GetFatAABB(a),d=this.m_tree.GetFatAABB(b);return box2d.b2TestOverlapAABB(c,d)};
box2d.b2BroadPhase.prototype.GetProxyCount=function(){return this.m_proxyCount};box2d.b2BroadPhase.prototype.GetTreeHeight=function(){return this.m_tree.GetHeight()};box2d.b2BroadPhase.prototype.GetTreeBalance=function(){return this.m_tree.GetMaxBalance()};box2d.b2BroadPhase.prototype.GetTreeQuality=function(){return this.m_tree.GetAreaRatio()};box2d.b2BroadPhase.prototype.ShiftOrigin=function(a){this.m_tree.ShiftOrigin(a)};
box2d.b2BroadPhase.prototype.UpdatePairs=function(a){for(var b=this.m_pairCount=0;b<this.m_moveCount;++b){var c=this.m_moveBuffer[b];if(null!==c){var d=this,e=this.m_tree.GetFatAABB(c);this.m_tree.Query(function(a){if(a.m_id===c.m_id)return!0;d.m_pairCount===d.m_pairBuffer.length&&(d.m_pairBuffer[d.m_pairCount]=new box2d.b2Pair);var b=d.m_pairBuffer[d.m_pairCount];a.m_id<c.m_id?(b.proxyA=a,b.proxyB=c):(b.proxyA=c,b.proxyB=a);++d.m_pairCount;return!0},e)}}this.m_moveCount=0;this.m_pairBuffer.length=
this.m_pairCount;this.m_pairBuffer.sort(box2d.b2PairLessThan);for(b=0;b<this.m_pairCount;){e=this.m_pairBuffer[b];var f=this.m_tree.GetUserData(e.proxyA),g=this.m_tree.GetUserData(e.proxyB);a.AddPair(f,g);for(++b;b<this.m_pairCount;){f=this.m_pairBuffer[b];if(f.proxyA.m_id!==e.proxyA.m_id||f.proxyB.m_id!==e.proxyB.m_id)break;++b}}};box2d.b2BroadPhase.prototype.Query=function(a,b){this.m_tree.Query(a,b)};box2d.b2BroadPhase.prototype.RayCast=function(a,b){this.m_tree.RayCast(a,b)};
box2d.b2BroadPhase.prototype.BufferMove=function(a){this.m_moveBuffer[this.m_moveCount]=a;++this.m_moveCount};box2d.b2BroadPhase.prototype.UnBufferMove=function(a){a=this.m_moveBuffer.indexOf(a);this.m_moveBuffer[a]=null};box2d.b2PairLessThan=function(a,b){return a.proxyA.m_id===b.proxyA.m_id?a.proxyB.m_id-b.proxyB.m_id:a.proxyA.m_id-b.proxyA.m_id};box2d.b2ContactManager=function(){this.m_broadPhase=new box2d.b2BroadPhase;this.m_contactFactory=new box2d.b2ContactFactory(this.m_allocator)};
box2d.b2ContactManager.prototype.m_broadPhase=null;box2d.b2ContactManager.prototype.m_contactList=null;box2d.b2ContactManager.prototype.m_contactCount=0;box2d.b2ContactManager.prototype.m_contactFilter=box2d.b2ContactFilter.b2_defaultFilter;box2d.b2ContactManager.prototype.m_contactListener=box2d.b2ContactListener.b2_defaultListener;box2d.b2ContactManager.prototype.m_allocator=null;box2d.b2ContactManager.prototype.m_contactFactory=null;
box2d.b2ContactManager.prototype.Destroy=function(a){var b=a.GetFixtureA(),c=a.GetFixtureB();b=b.GetBody();c=c.GetBody();this.m_contactListener&&a.IsTouching()&&this.m_contactListener.EndContact(a);a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);a===this.m_contactList&&(this.m_contactList=a.m_next);a.m_nodeA.prev&&(a.m_nodeA.prev.next=a.m_nodeA.next);a.m_nodeA.next&&(a.m_nodeA.next.prev=a.m_nodeA.prev);a.m_nodeA===b.m_contactList&&(b.m_contactList=a.m_nodeA.next);a.m_nodeB.prev&&
(a.m_nodeB.prev.next=a.m_nodeB.next);a.m_nodeB.next&&(a.m_nodeB.next.prev=a.m_nodeB.prev);a.m_nodeB===c.m_contactList&&(c.m_contactList=a.m_nodeB.next);this.m_contactFactory.Destroy(a);--this.m_contactCount};
box2d.b2ContactManager.prototype.Collide=function(){for(var a=this.m_contactList;a;){var b=a.GetFixtureA(),c=a.GetFixtureB(),d=a.GetChildIndexA(),e=a.GetChildIndexB(),f=b.GetBody(),g=c.GetBody();if(a.m_flags&box2d.b2ContactFlag.e_filterFlag){if(!1===g.ShouldCollide(f)){b=a;a=b.m_next;this.Destroy(b);continue}if(this.m_contactFilter&&!1===this.m_contactFilter.ShouldCollide(b,c)){b=a;a=b.m_next;this.Destroy(b);continue}a.m_flags&=~box2d.b2ContactFlag.e_filterFlag}f=f.IsAwake()&&f.m_type!==box2d.b2BodyType.b2_staticBody;
g=g.IsAwake()&&g.m_type!==box2d.b2BodyType.b2_staticBody;!1===f&&!1===g?a=a.m_next:!1===this.m_broadPhase.TestOverlap(b.m_proxies[d].proxy,c.m_proxies[e].proxy)?(b=a,a=b.m_next,this.Destroy(b)):(a.Update(this.m_contactListener),a=a.m_next)}};box2d.b2ContactManager.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(this)};
box2d.b2ContactManager.prototype.AddPair=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2FixtureProxy);box2d.ENABLE_ASSERTS&&box2d.b2Assert(b instanceof box2d.b2FixtureProxy);var c=a.fixture,d=b.fixture,e=a.childIndex,f=b.childIndex,g=c.GetBody(),h=d.GetBody();if(g!==h){for(var k=h.GetContactList();k;){if(k.other===g){var l=k.contact.GetFixtureA(),m=k.contact.GetFixtureB(),n=k.contact.GetChildIndexA(),p=k.contact.GetChildIndexB();if(l===c&&m===d&&n===e&&p===f||l===d&&m===c&&
n===f&&p===e)return}k=k.next}!1===h.ShouldCollide(g)||this.m_contactFilter&&!1===this.m_contactFilter.ShouldCollide(c,d)||(e=this.m_contactFactory.Create(c,e,d,f),null!==e&&(c=e.GetFixtureA(),d=e.GetFixtureB(),e.GetChildIndexA(),e.GetChildIndexB(),g=c.m_body,h=d.m_body,e.m_prev=null,e.m_next=this.m_contactList,null!==this.m_contactList&&(this.m_contactList.m_prev=e),this.m_contactList=e,e.m_nodeA.contact=e,e.m_nodeA.other=h,e.m_nodeA.prev=null,e.m_nodeA.next=g.m_contactList,null!==g.m_contactList&&
(g.m_contactList.prev=e.m_nodeA),g.m_contactList=e.m_nodeA,e.m_nodeB.contact=e,e.m_nodeB.other=g,e.m_nodeB.prev=null,e.m_nodeB.next=h.m_contactList,null!==h.m_contactList&&(h.m_contactList.prev=e.m_nodeB),h.m_contactList=e.m_nodeB,!1===c.IsSensor()&&!1===d.IsSensor()&&(g.SetAwake(!0),h.SetAwake(!0)),++this.m_contactCount))}};box2d.b2JointFactory={};
box2d.b2JointFactory.Create=function(a,b){var c=null;switch(a.type){case box2d.b2JointType.e_distanceJoint:c=new box2d.b2DistanceJoint(a instanceof box2d.b2DistanceJointDef?a:null);break;case box2d.b2JointType.e_mouseJoint:c=new box2d.b2MouseJoint(a instanceof box2d.b2MouseJointDef?a:null);break;case box2d.b2JointType.e_prismaticJoint:c=new box2d.b2PrismaticJoint(a instanceof box2d.b2PrismaticJointDef?a:null);break;case box2d.b2JointType.e_revoluteJoint:c=new box2d.b2RevoluteJoint(a instanceof box2d.b2RevoluteJointDef?
a:null);break;case box2d.b2JointType.e_pulleyJoint:c=new box2d.b2PulleyJoint(a instanceof box2d.b2PulleyJointDef?a:null);break;case box2d.b2JointType.e_gearJoint:c=new box2d.b2GearJoint(a instanceof box2d.b2GearJointDef?a:null);break;case box2d.b2JointType.e_wheelJoint:c=new box2d.b2WheelJoint(a instanceof box2d.b2WheelJointDef?a:null);break;case box2d.b2JointType.e_weldJoint:c=new box2d.b2WeldJoint(a instanceof box2d.b2WeldJointDef?a:null);break;case box2d.b2JointType.e_frictionJoint:c=new box2d.b2FrictionJoint(a instanceof
box2d.b2FrictionJointDef?a:null);break;case box2d.b2JointType.e_ropeJoint:c=new box2d.b2RopeJoint(a instanceof box2d.b2RopeJointDef?a:null);break;case box2d.b2JointType.e_motorJoint:c=new box2d.b2MotorJoint(a instanceof box2d.b2MotorJointDef?a:null);break;case box2d.b2JointType.e_areaJoint:c=new box2d.b2AreaJoint(a instanceof box2d.b2AreaJointDef?a:null);break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}return c};box2d.b2JointFactory.Destroy=function(a,b){};
box2d.b2Color=function(a,b,c){this.r=a;this.g=b;this.b=c};box2d.b2Color.prototype.r=.5;box2d.b2Color.prototype.g=.5;box2d.b2Color.prototype.b=.5;box2d.b2Color.prototype.SetRGB=function(a,b,c){this.r=a;this.g=b;this.b=c;return this};
box2d.b2Color.prototype.MakeStyleString=function(a){return box2d.b2Color.MakeStyleString(Math.round(Math.max(0,Math.min(255,255*this.r))),Math.round(Math.max(0,Math.min(255,255*this.g))),Math.round(Math.max(0,Math.min(255,255*this.b))),"undefined"===typeof a?1:Math.max(0,Math.min(1,a)))};box2d.b2Color.MakeStyleString=function(a,b,c,d){return 1>d?"rgba("+a+","+b+","+c+","+d+")":"rgb("+a+","+b+","+c+")"};box2d.b2Color.RED=new box2d.b2Color(1,0,0);box2d.b2Color.GREEN=new box2d.b2Color(0,1,0);
box2d.b2Color.BLUE=new box2d.b2Color(0,0,1);box2d.b2DrawFlags={e_none:0,e_shapeBit:1,e_jointBit:2,e_aabbBit:4,e_pairBit:8,e_centerOfMassBit:16,e_controllerBit:32,e_all:63};goog.exportProperty(box2d.b2DrawFlags,"e_none",box2d.b2DrawFlags.e_none);goog.exportProperty(box2d.b2DrawFlags,"e_shapeBit",box2d.b2DrawFlags.e_shapeBit);goog.exportProperty(box2d.b2DrawFlags,"e_jointBit",box2d.b2DrawFlags.e_jointBit);goog.exportProperty(box2d.b2DrawFlags,"e_aabbBit",box2d.b2DrawFlags.e_aabbBit);
goog.exportProperty(box2d.b2DrawFlags,"e_pairBit",box2d.b2DrawFlags.e_pairBit);goog.exportProperty(box2d.b2DrawFlags,"e_centerOfMassBit",box2d.b2DrawFlags.e_centerOfMassBit);goog.exportProperty(box2d.b2DrawFlags,"e_controllerBit",box2d.b2DrawFlags.e_controllerBit);goog.exportProperty(box2d.b2DrawFlags,"e_all",box2d.b2DrawFlags.e_all);box2d.b2Draw=function(){};box2d.b2Draw.prototype.m_drawFlags=box2d.b2DrawFlags.e_none;box2d.b2Draw.prototype.SetFlags=function(a){this.m_drawFlags=a};
box2d.b2Draw.prototype.GetFlags=function(){return this.m_drawFlags};box2d.b2Draw.prototype.AppendFlags=function(a){this.m_drawFlags|=a};box2d.b2Draw.prototype.ClearFlags=function(a){this.m_drawFlags&=~a};box2d.b2Draw.prototype.PushTransform=function(a){};box2d.b2Draw.prototype.PopTransform=function(a){};box2d.b2Draw.prototype.DrawPolygon=function(a,b,c){};box2d.b2Draw.prototype.DrawSolidPolygon=function(a,b,c){};box2d.b2Draw.prototype.DrawCircle=function(a,b,c){};
box2d.b2Draw.prototype.DrawSolidCircle=function(a,b,c,d){};box2d.b2Draw.prototype.DrawSegment=function(a,b,c){};box2d.b2Draw.prototype.DrawTransform=function(a){};box2d.b2Filter=function(){};box2d.b2Filter.prototype.categoryBits=1;box2d.b2Filter.prototype.maskBits=65535;box2d.b2Filter.prototype.groupIndex=0;box2d.b2Filter.prototype.Clone=function(){return(new box2d.b2Filter).Copy(this)};
box2d.b2Filter.prototype.Copy=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this!==a);this.categoryBits=a.categoryBits;this.maskBits=a.maskBits;this.groupIndex=a.groupIndex;return this};box2d.b2FixtureDef=function(){this.filter=new box2d.b2Filter};box2d.b2FixtureDef.prototype.shape=null;box2d.b2FixtureDef.prototype.userData=null;box2d.b2FixtureDef.prototype.friction=.2;box2d.b2FixtureDef.prototype.restitution=0;box2d.b2FixtureDef.prototype.density=0;box2d.b2FixtureDef.prototype.isSensor=!1;
box2d.b2FixtureDef.prototype.filter=null;box2d.b2FixtureProxy=function(){this.aabb=new box2d.b2AABB};box2d.b2FixtureProxy.prototype.aabb=null;box2d.b2FixtureProxy.prototype.fixture=null;box2d.b2FixtureProxy.prototype.childIndex=0;box2d.b2FixtureProxy.prototype.proxy=null;box2d.b2FixtureProxy.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2FixtureProxy})};box2d.b2Fixture=function(){this.m_proxyCount=0;this.m_filter=new box2d.b2Filter};
box2d.b2Fixture.prototype.m_density=0;box2d.b2Fixture.prototype.m_next=null;box2d.b2Fixture.prototype.m_body=null;box2d.b2Fixture.prototype.m_shape=null;box2d.b2Fixture.prototype.m_friction=0;box2d.b2Fixture.prototype.m_restitution=0;box2d.b2Fixture.prototype.m_proxies=null;box2d.b2Fixture.prototype.m_proxyCount=0;box2d.b2Fixture.prototype.m_filter=null;box2d.b2Fixture.prototype.m_isSensor=!1;box2d.b2Fixture.prototype.m_userData=null;box2d.b2Fixture.prototype.GetType=function(){return this.m_shape.GetType()};
box2d.b2Fixture.prototype.GetShape=function(){return this.m_shape};box2d.b2Fixture.prototype.IsSensor=function(){return this.m_isSensor};box2d.b2Fixture.prototype.GetFilterData=function(){return this.m_filter};box2d.b2Fixture.prototype.GetUserData=function(){return this.m_userData};box2d.b2Fixture.prototype.SetUserData=function(a){this.m_userData=a};box2d.b2Fixture.prototype.GetBody=function(){return this.m_body};box2d.b2Fixture.prototype.GetNext=function(){return this.m_next};
box2d.b2Fixture.prototype.SetDensity=function(a){this.m_density=a};box2d.b2Fixture.prototype.GetDensity=function(){return this.m_density};box2d.b2Fixture.prototype.GetFriction=function(){return this.m_friction};box2d.b2Fixture.prototype.SetFriction=function(a){this.m_friction=a};box2d.b2Fixture.prototype.GetRestitution=function(){return this.m_restitution};box2d.b2Fixture.prototype.SetRestitution=function(a){this.m_restitution=a};
box2d.b2Fixture.prototype.TestPoint=function(a){return this.m_shape.TestPoint(this.m_body.GetTransform(),a)};box2d.b2Fixture.prototype.RayCast=function(a,b,c){return this.m_shape.RayCast(a,b,this.m_body.GetTransform(),c)};box2d.b2Fixture.prototype.GetMassData=function(a){a=a||new box2d.b2MassData;this.m_shape.ComputeMass(a,this.m_density);return a};box2d.b2Fixture.prototype.GetAABB=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=a&&a<this.m_proxyCount);return this.m_proxies[a].aabb};
box2d.b2Fixture.prototype.Create=function(a,b){this.m_userData=b.userData;this.m_friction=b.friction;this.m_restitution=b.restitution;this.m_body=a;this.m_next=null;this.m_filter.Copy(b.filter);this.m_isSensor=b.isSensor;this.m_shape=b.shape.Clone();this.m_proxies=box2d.b2FixtureProxy.MakeArray(this.m_shape.GetChildCount());this.m_proxyCount=0;this.m_density=b.density};box2d.b2Fixture.prototype.Destroy=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===this.m_proxyCount);this.m_shape=null};
box2d.b2Fixture.prototype.CreateProxies=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===this.m_proxyCount);this.m_proxyCount=this.m_shape.GetChildCount();for(var c=0;c<this.m_proxyCount;++c){var d=this.m_proxies[c];this.m_shape.ComputeAABB(d.aabb,b,c);d.proxy=a.CreateProxy(d.aabb,d);d.fixture=this;d.childIndex=c}};box2d.b2Fixture.prototype.DestroyProxies=function(a){for(var b=0;b<this.m_proxyCount;++b){var c=this.m_proxies[b];a.DestroyProxy(c.proxy);c.proxy=null}this.m_proxyCount=0};
box2d.b2Fixture.prototype.Synchronize=function(a,b,c){if(0!==this.m_proxyCount)for(var d=0;d<this.m_proxyCount;++d){var e=this.m_proxies[d],f=box2d.b2Fixture.prototype.Synchronize.s_aabb1,g=box2d.b2Fixture.prototype.Synchronize.s_aabb2;this.m_shape.ComputeAABB(f,b,d);this.m_shape.ComputeAABB(g,c,d);e.aabb.Combine2(f,g);f=box2d.b2SubVV(c.p,b.p,box2d.b2Fixture.prototype.Synchronize.s_displacement);a.MoveProxy(e.proxy,e.aabb,f)}};box2d.b2Fixture.prototype.Synchronize.s_aabb1=new box2d.b2AABB;
box2d.b2Fixture.prototype.Synchronize.s_aabb2=new box2d.b2AABB;box2d.b2Fixture.prototype.Synchronize.s_displacement=new box2d.b2Vec2;box2d.b2Fixture.prototype.SetFilterData=function(a){this.m_filter.Copy(a);this.Refilter()};
box2d.b2Fixture.prototype.Refilter=function(){if(!this.m_body){for(var a=this.m_body.GetContactList();a;){var b=a.contact,c=b.GetFixtureA(),d=b.GetFixtureB();c!==this&&d!==this||b.FlagForFiltering();a=a.next}a=this.m_body.GetWorld();if(null!==a)for(a=a.m_contactManager.m_broadPhase,b=0;b<this.m_proxyCount;++b)a.TouchProxy(this.m_proxies[b].proxy)}};box2d.b2Fixture.prototype.SetSensor=function(a){a!==this.m_isSensor&&(this.m_body.SetAwake(!0),this.m_isSensor=a)};
box2d.b2Fixture.prototype.Dump=function(a){box2d.DEBUG&&(box2d.b2Log("    /*box2d.b2FixtureDef*/ var fd = new box2d.b2FixtureDef();\n"),box2d.b2Log("    fd.friction = %.15f;\n",this.m_friction),box2d.b2Log("    fd.restitution = %.15f;\n",this.m_restitution),box2d.b2Log("    fd.density = %.15f;\n",this.m_density),box2d.b2Log("    fd.isSensor = %s;\n",this.m_isSensor?"true":"false"),box2d.b2Log("    fd.filter.categoryBits = %d;\n",this.m_filter.categoryBits),box2d.b2Log("    fd.filter.maskBits = %d;\n",
this.m_filter.maskBits),box2d.b2Log("    fd.filter.groupIndex = %d;\n",this.m_filter.groupIndex),this.m_shape.Dump(),box2d.b2Log("\n"),box2d.b2Log("    fd.shape = shape;\n"),box2d.b2Log("\n"),box2d.b2Log("    bodies[%d].CreateFixture(fd);\n",a))};box2d.b2BodyType={b2_unknown:-1,b2_staticBody:0,b2_kinematicBody:1,b2_dynamicBody:2,b2_bulletBody:3};goog.exportProperty(box2d.b2BodyType,"b2_unknown",box2d.b2BodyType.b2_unknown);goog.exportProperty(box2d.b2BodyType,"b2_staticBody",box2d.b2BodyType.b2_staticBody);
goog.exportProperty(box2d.b2BodyType,"b2_kinematicBody",box2d.b2BodyType.b2_kinematicBody);goog.exportProperty(box2d.b2BodyType,"b2_dynamicBody",box2d.b2BodyType.b2_dynamicBody);goog.exportProperty(box2d.b2BodyType,"b2_bulletBody",box2d.b2BodyType.b2_bulletBody);box2d.b2BodyDef=function(){this.position=new box2d.b2Vec2(0,0);this.linearVelocity=new box2d.b2Vec2(0,0)};box2d.b2BodyDef.prototype.type=box2d.b2BodyType.b2_staticBody;box2d.b2BodyDef.prototype.position=null;
box2d.b2BodyDef.prototype.angle=0;box2d.b2BodyDef.prototype.linearVelocity=null;box2d.b2BodyDef.prototype.angularVelocity=0;box2d.b2BodyDef.prototype.linearDamping=0;box2d.b2BodyDef.prototype.angularDamping=0;box2d.b2BodyDef.prototype.allowSleep=!0;box2d.b2BodyDef.prototype.awake=!0;box2d.b2BodyDef.prototype.fixedRotation=!1;box2d.b2BodyDef.prototype.bullet=!1;box2d.b2BodyDef.prototype.active=!0;box2d.b2BodyDef.prototype.userData=null;box2d.b2BodyDef.prototype.gravityScale=1;
box2d.b2BodyFlag={e_none:0,e_islandFlag:1,e_awakeFlag:2,e_autoSleepFlag:4,e_bulletFlag:8,e_fixedRotationFlag:16,e_activeFlag:32,e_toiFlag:64};goog.exportProperty(box2d.b2BodyFlag,"e_none",box2d.b2BodyFlag.e_none);goog.exportProperty(box2d.b2BodyFlag,"e_islandFlag",box2d.b2BodyFlag.e_islandFlag);goog.exportProperty(box2d.b2BodyFlag,"e_awakeFlag",box2d.b2BodyFlag.e_awakeFlag);goog.exportProperty(box2d.b2BodyFlag,"e_autoSleepFlag",box2d.b2BodyFlag.e_autoSleepFlag);
goog.exportProperty(box2d.b2BodyFlag,"e_bulletFlag",box2d.b2BodyFlag.e_bulletFlag);goog.exportProperty(box2d.b2BodyFlag,"e_fixedRotationFlag",box2d.b2BodyFlag.e_fixedRotationFlag);goog.exportProperty(box2d.b2BodyFlag,"e_activeFlag",box2d.b2BodyFlag.e_activeFlag);goog.exportProperty(box2d.b2BodyFlag,"e_toiFlag",box2d.b2BodyFlag.e_toiFlag);
box2d.b2Body=function(a,b){this.m_xf=new box2d.b2Transform;this.m_out_xf=new box2d.b2Transform;this.m_sweep=new box2d.b2Sweep;this.m_out_sweep=new box2d.b2Sweep;this.m_linearVelocity=new box2d.b2Vec2;this.m_out_linearVelocity=new box2d.b2Vec2;this.m_force=new box2d.b2Vec2;box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.position.IsValid());box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.linearVelocity.IsValid());box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a.angle));box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a.angularVelocity));
box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a.gravityScale)&&0<=a.gravityScale);box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a.angularDamping)&&0<=a.angularDamping);box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a.linearDamping)&&0<=a.linearDamping);this.m_flags=box2d.b2BodyFlag.e_none;a.bullet&&(this.m_flags|=box2d.b2BodyFlag.e_bulletFlag);a.fixedRotation&&(this.m_flags|=box2d.b2BodyFlag.e_fixedRotationFlag);a.allowSleep&&(this.m_flags|=box2d.b2BodyFlag.e_autoSleepFlag);a.awake&&
(this.m_flags|=box2d.b2BodyFlag.e_awakeFlag);a.active&&(this.m_flags|=box2d.b2BodyFlag.e_activeFlag);this.m_world=b;this.m_xf.p.Copy(a.position);this.m_xf.q.SetAngleRadians(a.angle);this.m_sweep.localCenter.SetZero();this.m_sweep.c0.Copy(this.m_xf.p);this.m_sweep.c.Copy(this.m_xf.p);this.m_sweep.a0=a.angle;this.m_sweep.a=a.angle;this.m_sweep.alpha0=0;this.m_linearVelocity.Copy(a.linearVelocity);this.m_angularVelocity=a.angularVelocity;this.m_linearDamping=a.linearDamping;this.m_angularDamping=a.angularDamping;
this.m_gravityScale=a.gravityScale;this.m_force.SetZero();this.m_sleepTime=this.m_torque=0;this.m_type=a.type;this.m_invMass=a.type===box2d.b2BodyType.b2_dynamicBody?this.m_mass=1:this.m_mass=0;this.m_invI=this.m_I=0;this.m_userData=a.userData;this.m_fixtureList=null;this.m_fixtureCount=0;this.m_controllerList=null;this.m_controllerCount=0};box2d.b2Body.prototype.m_flags=box2d.b2BodyFlag.e_none;box2d.b2Body.prototype.m_islandIndex=0;box2d.b2Body.prototype.m_world=null;
box2d.b2Body.prototype.m_xf=null;box2d.b2Body.prototype.m_out_xf=null;box2d.b2Body.prototype.m_sweep=null;box2d.b2Body.prototype.m_out_sweep=null;box2d.b2Body.prototype.m_jointList=null;box2d.b2Body.prototype.m_contactList=null;box2d.b2Body.prototype.m_prev=null;box2d.b2Body.prototype.m_next=null;box2d.b2Body.prototype.m_linearVelocity=null;box2d.b2Body.prototype.m_out_linearVelocity=null;box2d.b2Body.prototype.m_angularVelocity=0;box2d.b2Body.prototype.m_linearDamping=0;
box2d.b2Body.prototype.m_angularDamping=0;box2d.b2Body.prototype.m_gravityScale=1;box2d.b2Body.prototype.m_force=null;box2d.b2Body.prototype.m_torque=0;box2d.b2Body.prototype.m_sleepTime=0;box2d.b2Body.prototype.m_type=box2d.b2BodyType.b2_staticBody;box2d.b2Body.prototype.m_mass=1;box2d.b2Body.prototype.m_invMass=1;box2d.b2Body.prototype.m_I=0;box2d.b2Body.prototype.m_invI=0;box2d.b2Body.prototype.m_userData=null;box2d.b2Body.prototype.m_fixtureList=null;box2d.b2Body.prototype.m_fixtureCount=0;
box2d.b2Body.prototype.m_controllerList=null;box2d.b2Body.prototype.m_controllerCount=0;
box2d.b2Body.prototype.CreateFixture=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked());if(!0===this.m_world.IsLocked())return null;var b=new box2d.b2Fixture;b.Create(this,a);this.m_flags&box2d.b2BodyFlag.e_activeFlag&&b.CreateProxies(this.m_world.m_contactManager.m_broadPhase,this.m_xf);b.m_next=this.m_fixtureList;this.m_fixtureList=b;++this.m_fixtureCount;b.m_body=this;0<b.m_density&&this.ResetMassData();this.m_world.m_flags|=box2d.b2WorldFlag.e_newFixture;return b};
box2d.b2Body.prototype.CreateFixture2=function(a,b){void 0===b&&(b=0);var c=box2d.b2Body.prototype.CreateFixture2.s_def;c.shape=a;c.density=b;return this.CreateFixture(c)};box2d.b2Body.prototype.CreateFixture2.s_def=new box2d.b2FixtureDef;
box2d.b2Body.prototype.DestroyFixture=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked());if(!0!==this.m_world.IsLocked()){box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.m_body===this);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_fixtureCount);for(var b=this.m_fixtureList,c=null,d=!1;null!==b;){if(b===a){c?c.m_next=a.m_next:this.m_fixtureList=a.m_next;d=!0;break}c=b;b=b.m_next}box2d.ENABLE_ASSERTS&&box2d.b2Assert(d);for(b=this.m_contactList;b;){c=b.contact;b=b.next;d=c.GetFixtureA();
var e=c.GetFixtureB();a!==d&&a!==e||this.m_world.m_contactManager.Destroy(c)}this.m_flags&box2d.b2BodyFlag.e_activeFlag&&a.DestroyProxies(this.m_world.m_contactManager.m_broadPhase);a.Destroy();a.m_body=null;a.m_next=null;--this.m_fixtureCount;this.ResetMassData()}};box2d.b2Body.prototype.SetTransformVecRadians=function(a,b){this.SetTransformXYRadians(a.x,a.y,b)};
box2d.b2Body.prototype.SetTransformXYRadians=function(a,b,c){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked());if(!0!==this.m_world.IsLocked()&&(this.m_xf.p.x!==a||this.m_xf.p.y!==b||this.m_xf.q.GetAngleRadians()!==c))for(this.m_xf.q.SetAngleRadians(c),this.m_xf.p.SetXY(a,b),box2d.b2MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.a=c,this.m_sweep.c0.Copy(this.m_sweep.c),this.m_sweep.a0=c,a=this.m_world.m_contactManager.m_broadPhase,b=this.m_fixtureList;b;b=b.m_next)b.Synchronize(a,
this.m_xf,this.m_xf)};box2d.b2Body.prototype.SetTransform=function(a){this.SetTransformVecRadians(a.p,a.GetAngleRadians())};box2d.b2Body.prototype.GetTransform=function(a){a=a||this.m_out_xf;return a.Copy(this.m_xf)};box2d.b2Body.prototype.GetPosition=function(a){a=a||this.m_out_xf.p;return a.Copy(this.m_xf.p)};box2d.b2Body.prototype.SetPosition=function(a){this.SetTransformVecRadians(a,this.GetAngleRadians())};box2d.b2Body.prototype.SetPositionXY=function(a,b){this.SetTransformXYRadians(a,b,this.GetAngleRadians())};
box2d.b2Body.prototype.GetAngle=function(){return this.m_sweep.a};box2d.b2Body.prototype.GetAngleRadians=box2d.b2Body.prototype.GetAngle;box2d.b2Body.prototype.GetAngleDegrees=function(){return box2d.b2RadToDeg(this.GetAngle())};box2d.b2Body.prototype.SetAngle=function(a){this.SetTransformVecRadians(this.GetPosition(),a)};box2d.b2Body.prototype.SetAngleRadians=box2d.b2Body.prototype.SetAngle;box2d.b2Body.prototype.SetAngleDegrees=function(a){this.SetAngle(box2d.b2DegToRad(a))};
box2d.b2Body.prototype.GetWorldCenter=function(a){a=a||this.m_out_sweep.c;return a.Copy(this.m_sweep.c)};box2d.b2Body.prototype.GetLocalCenter=function(a){a=a||this.m_out_sweep.localCenter;return a.Copy(this.m_sweep.localCenter)};box2d.b2Body.prototype.SetLinearVelocity=function(a){this.m_type!==box2d.b2BodyType.b2_staticBody&&(0<box2d.b2DotVV(a,a)&&this.SetAwake(!0),this.m_linearVelocity.Copy(a))};box2d.b2Body.prototype.GetLinearVelocity=function(a){a=a||this.m_out_linearVelocity;return a.Copy(this.m_linearVelocity)};
box2d.b2Body.prototype.SetAngularVelocity=function(a){this.m_type!==box2d.b2BodyType.b2_staticBody&&(0<a*a&&this.SetAwake(!0),this.m_angularVelocity=a)};box2d.b2Body.prototype.GetAngularVelocity=function(){return this.m_angularVelocity};
box2d.b2Body.prototype.GetDefinition=function(a){a.type=this.GetType();a.allowSleep=(this.m_flags&box2d.b2BodyFlag.e_autoSleepFlag)===box2d.b2BodyFlag.e_autoSleepFlag;a.angle=this.GetAngleRadians();a.angularDamping=this.m_angularDamping;a.gravityScale=this.m_gravityScale;a.angularVelocity=this.m_angularVelocity;a.fixedRotation=(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)===box2d.b2BodyFlag.e_fixedRotationFlag;a.bullet=(this.m_flags&box2d.b2BodyFlag.e_bulletFlag)===box2d.b2BodyFlag.e_bulletFlag;
a.awake=(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)===box2d.b2BodyFlag.e_awakeFlag;a.linearDamping=this.m_linearDamping;a.linearVelocity.Copy(this.GetLinearVelocity());a.position.Copy(this.GetPosition());a.userData=this.GetUserData();return a};
box2d.b2Body.prototype.ApplyForce=function(a,b,c){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(0===(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_force.x+=a.x,this.m_force.y+=a.y,this.m_torque+=(b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x))};
box2d.b2Body.prototype.ApplyForceToCenter=function(a,b){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(0===(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_force.x+=a.x,this.m_force.y+=a.y))};box2d.b2Body.prototype.ApplyTorque=function(a,b){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(0===(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_torque+=a))};
box2d.b2Body.prototype.ApplyLinearImpulse=function(a,b,c){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(0===(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*a.x,this.m_linearVelocity.y+=this.m_invMass*a.y,this.m_angularVelocity+=this.m_invI*((b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x)))};
box2d.b2Body.prototype.ApplyAngularImpulse=function(a,b){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(0===(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_angularVelocity+=this.m_invI*a))};box2d.b2Body.prototype.GetMass=function(){return this.m_mass};box2d.b2Body.prototype.GetInertia=function(){return this.m_I+this.m_mass*box2d.b2DotVV(this.m_sweep.localCenter,this.m_sweep.localCenter)};
box2d.b2Body.prototype.GetMassData=function(a){a.mass=this.m_mass;a.I=this.m_I+this.m_mass*box2d.b2DotVV(this.m_sweep.localCenter,this.m_sweep.localCenter);a.center.Copy(this.m_sweep.localCenter);return a};
box2d.b2Body.prototype.SetMassData=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked());if(!0!==this.m_world.IsLocked()&&this.m_type===box2d.b2BodyType.b2_dynamicBody){this.m_invI=this.m_I=this.m_invMass=0;this.m_mass=a.mass;0>=this.m_mass&&(this.m_mass=1);this.m_invMass=1/this.m_mass;0<a.I&&0===(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)&&(this.m_I=a.I-this.m_mass*box2d.b2DotVV(a.center,a.center),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_I),this.m_invI=1/this.m_I);
var b=box2d.b2Body.prototype.SetMassData.s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(a.center);box2d.b2MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c);this.m_sweep.c0.Copy(this.m_sweep.c);box2d.b2AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,box2d.b2SubVV(this.m_sweep.c,b,box2d.b2Vec2.s_t0),this.m_linearVelocity)}};box2d.b2Body.prototype.SetMassData.s_oldCenter=new box2d.b2Vec2;
box2d.b2Body.prototype.ResetMassData=function(){this.m_invI=this.m_I=this.m_invMass=this.m_mass=0;this.m_sweep.localCenter.SetZero();if(this.m_type===box2d.b2BodyType.b2_staticBody||this.m_type===box2d.b2BodyType.b2_kinematicBody)this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),this.m_sweep.a0=this.m_sweep.a;else{box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_type===box2d.b2BodyType.b2_dynamicBody);for(var a=box2d.b2Body.prototype.ResetMassData.s_localCenter.SetZero(),b=this.m_fixtureList;b;b=
b.m_next)if(0!==b.m_density){var c=b.GetMassData(box2d.b2Body.prototype.ResetMassData.s_massData);this.m_mass+=c.mass;a.x+=c.center.x*c.mass;a.y+=c.center.y*c.mass;this.m_I+=c.I}0<this.m_mass?(this.m_invMass=1/this.m_mass,a.x*=this.m_invMass,a.y*=this.m_invMass):this.m_invMass=this.m_mass=1;0<this.m_I&&0===(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)?(this.m_I-=this.m_mass*box2d.b2DotVV(a,a),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_I),this.m_invI=1/this.m_I):this.m_invI=this.m_I=0;b=box2d.b2Body.prototype.ResetMassData.s_oldCenter.Copy(this.m_sweep.c);
this.m_sweep.localCenter.Copy(a);box2d.b2MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c);this.m_sweep.c0.Copy(this.m_sweep.c);box2d.b2AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,box2d.b2SubVV(this.m_sweep.c,b,box2d.b2Vec2.s_t0),this.m_linearVelocity)}};box2d.b2Body.prototype.ResetMassData.s_localCenter=new box2d.b2Vec2;box2d.b2Body.prototype.ResetMassData.s_oldCenter=new box2d.b2Vec2;box2d.b2Body.prototype.ResetMassData.s_massData=new box2d.b2MassData;
box2d.b2Body.prototype.GetWorldPoint=function(a,b){return box2d.b2MulXV(this.m_xf,a,b)};box2d.b2Body.prototype.GetWorldVector=function(a,b){return box2d.b2MulRV(this.m_xf.q,a,b)};box2d.b2Body.prototype.GetLocalPoint=function(a,b){return box2d.b2MulTXV(this.m_xf,a,b)};box2d.b2Body.prototype.GetLocalVector=function(a,b){return box2d.b2MulTRV(this.m_xf.q,a,b)};
box2d.b2Body.prototype.GetLinearVelocityFromWorldPoint=function(a,b){return box2d.b2AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,box2d.b2SubVV(a,this.m_sweep.c,box2d.b2Vec2.s_t0),b)};box2d.b2Body.prototype.GetLinearVelocityFromLocalPoint=function(a,b){return this.GetLinearVelocityFromWorldPoint(this.GetWorldPoint(a,b),b)};box2d.b2Body.prototype.GetLinearDamping=function(){return this.m_linearDamping};box2d.b2Body.prototype.SetLinearDamping=function(a){this.m_linearDamping=a};
box2d.b2Body.prototype.GetAngularDamping=function(){return this.m_angularDamping};box2d.b2Body.prototype.SetAngularDamping=function(a){this.m_angularDamping=a};box2d.b2Body.prototype.GetGravityScale=function(){return this.m_gravityScale};box2d.b2Body.prototype.SetGravityScale=function(a){this.m_gravityScale=a};
box2d.b2Body.prototype.SetType=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked());if(!0!==this.m_world.IsLocked()&&this.m_type!==a){this.m_type=a;this.ResetMassData();this.m_type===box2d.b2BodyType.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_sweep.a0=this.m_sweep.a,this.m_sweep.c0.Copy(this.m_sweep.c),this.SynchronizeFixtures());this.SetAwake(!0);this.m_force.SetZero();this.m_torque=0;for(a=this.m_contactList;a;){var b=a;a=a.next;this.m_world.m_contactManager.Destroy(b.contact)}this.m_contactList=
null;a=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;b;b=b.m_next)for(var c=b.m_proxyCount,d=0;d<c;++d)a.TouchProxy(b.m_proxies[d].proxy)}};box2d.b2Body.prototype.GetType=function(){return this.m_type};box2d.b2Body.prototype.SetBullet=function(a){this.m_flags=a?this.m_flags|box2d.b2BodyFlag.e_bulletFlag:this.m_flags&~box2d.b2BodyFlag.e_bulletFlag};box2d.b2Body.prototype.IsBullet=function(){return(this.m_flags&box2d.b2BodyFlag.e_bulletFlag)===box2d.b2BodyFlag.e_bulletFlag};
box2d.b2Body.prototype.SetSleepingAllowed=function(a){a?this.m_flags|=box2d.b2BodyFlag.e_autoSleepFlag:(this.m_flags&=~box2d.b2BodyFlag.e_autoSleepFlag,this.SetAwake(!0))};box2d.b2Body.prototype.IsSleepingAllowed=function(){return(this.m_flags&box2d.b2BodyFlag.e_autoSleepFlag)===box2d.b2BodyFlag.e_autoSleepFlag};
box2d.b2Body.prototype.SetAwake=function(a){a?0===(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&(this.m_flags|=box2d.b2BodyFlag.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~box2d.b2BodyFlag.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)};box2d.b2Body.prototype.IsAwake=function(){return(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)===box2d.b2BodyFlag.e_awakeFlag};
box2d.b2Body.prototype.SetActive=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked());if(a!==this.IsActive())if(a){this.m_flags|=box2d.b2BodyFlag.e_activeFlag;a=this.m_world.m_contactManager.m_broadPhase;for(var b=this.m_fixtureList;b;b=b.m_next)b.CreateProxies(a,this.m_xf)}else{this.m_flags&=~box2d.b2BodyFlag.e_activeFlag;a=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;b;b=b.m_next)b.DestroyProxies(a);for(a=this.m_contactList;a;)b=a,a=a.next,this.m_world.m_contactManager.Destroy(b.contact);
this.m_contactList=null}};box2d.b2Body.prototype.IsActive=function(){return(this.m_flags&box2d.b2BodyFlag.e_activeFlag)===box2d.b2BodyFlag.e_activeFlag};box2d.b2Body.prototype.SetFixedRotation=function(a){(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)===box2d.b2BodyFlag.e_fixedRotationFlag!==a&&(this.m_flags=a?this.m_flags|box2d.b2BodyFlag.e_fixedRotationFlag:this.m_flags&~box2d.b2BodyFlag.e_fixedRotationFlag,this.m_angularVelocity=0,this.ResetMassData())};
box2d.b2Body.prototype.IsFixedRotation=function(){return(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)===box2d.b2BodyFlag.e_fixedRotationFlag};box2d.b2Body.prototype.GetFixtureList=function(){return this.m_fixtureList};box2d.b2Body.prototype.GetJointList=function(){return this.m_jointList};box2d.b2Body.prototype.GetContactList=function(){return this.m_contactList};box2d.b2Body.prototype.GetNext=function(){return this.m_next};box2d.b2Body.prototype.GetUserData=function(){return this.m_userData};
box2d.b2Body.prototype.SetUserData=function(a){this.m_userData=a};box2d.b2Body.prototype.GetWorld=function(){return this.m_world};box2d.b2Body.prototype.SynchronizeFixtures=function(){var a=box2d.b2Body.prototype.SynchronizeFixtures.s_xf1;a.q.SetAngleRadians(this.m_sweep.a0);box2d.b2MulRV(a.q,this.m_sweep.localCenter,a.p);box2d.b2SubVV(this.m_sweep.c0,a.p,a.p);for(var b=this.m_world.m_contactManager.m_broadPhase,c=this.m_fixtureList;c;c=c.m_next)c.Synchronize(b,a,this.m_xf)};
box2d.b2Body.prototype.SynchronizeFixtures.s_xf1=new box2d.b2Transform;box2d.b2Body.prototype.SynchronizeTransform=function(){this.m_xf.q.SetAngleRadians(this.m_sweep.a);box2d.b2MulRV(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p);box2d.b2SubVV(this.m_sweep.c,this.m_xf.p,this.m_xf.p)};
box2d.b2Body.prototype.ShouldCollide=function(a){if(this.m_type!==box2d.b2BodyType.b2_dynamicBody&&a.m_type!==box2d.b2BodyType.b2_dynamicBody)return!1;for(var b=this.m_jointList;b;b=b.next)if(b.other===a&&!1===b.joint.m_collideConnected)return!1;return!0};
box2d.b2Body.prototype.Advance=function(a){this.m_sweep.Advance(a);this.m_sweep.c.Copy(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;this.m_xf.q.SetAngleRadians(this.m_sweep.a);box2d.b2MulRV(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p);box2d.b2SubVV(this.m_sweep.c,this.m_xf.p,this.m_xf.p)};
box2d.b2Body.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_islandIndex;box2d.b2Log("if (true)\n");box2d.b2Log("{\n");box2d.b2Log("  /*box2d.b2BodyDef*/ var bd = new box2d.b2BodyDef();\n");var b="";switch(this.m_type){case box2d.b2BodyType.b2_staticBody:b="box2d.b2BodyType.b2_staticBody";break;case box2d.b2BodyType.b2_kinematicBody:b="box2d.b2BodyType.b2_kinematicBody";break;case box2d.b2BodyType.b2_dynamicBody:b="box2d.b2BodyType.b2_dynamicBody";break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}box2d.b2Log("  bd.type = %s;\n",
b);box2d.b2Log("  bd.position.SetXY(%.15f, %.15f);\n",this.m_xf.p.x,this.m_xf.p.y);box2d.b2Log("  bd.angle = %.15f;\n",this.m_sweep.a);box2d.b2Log("  bd.linearVelocity.SetXY(%.15f, %.15f);\n",this.m_linearVelocity.x,this.m_linearVelocity.y);box2d.b2Log("  bd.angularVelocity = %.15f;\n",this.m_angularVelocity);box2d.b2Log("  bd.linearDamping = %.15f;\n",this.m_linearDamping);box2d.b2Log("  bd.angularDamping = %.15f;\n",this.m_angularDamping);box2d.b2Log("  bd.allowSleep = %s;\n",this.m_flags&box2d.b2BodyFlag.e_autoSleepFlag?
"true":"false");box2d.b2Log("  bd.awake = %s;\n",this.m_flags&box2d.b2BodyFlag.e_awakeFlag?"true":"false");box2d.b2Log("  bd.fixedRotation = %s;\n",this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag?"true":"false");box2d.b2Log("  bd.bullet = %s;\n",this.m_flags&box2d.b2BodyFlag.e_bulletFlag?"true":"false");box2d.b2Log("  bd.active = %s;\n",this.m_flags&box2d.b2BodyFlag.e_activeFlag?"true":"false");box2d.b2Log("  bd.gravityScale = %.15f;\n",this.m_gravityScale);box2d.b2Log("\n");box2d.b2Log("  bodies[%d] = this.m_world.CreateBody(bd);\n",
this.m_islandIndex);box2d.b2Log("\n");for(b=this.m_fixtureList;b;b=b.m_next)box2d.b2Log("  if (true)\n"),box2d.b2Log("  {\n"),b.Dump(a),box2d.b2Log("  }\n");box2d.b2Log("}\n")}};box2d.b2Body.prototype.GetControllerList=function(){return this.m_controllerList};box2d.b2Body.prototype.GetControllerCount=function(){return this.m_controllerCount};box2d.b2WorldFlag={e_none:0,e_newFixture:1,e_locked:2,e_clearForces:4};goog.exportProperty(box2d.b2WorldFlag,"e_none",box2d.b2WorldFlag.e_none);
goog.exportProperty(box2d.b2WorldFlag,"e_newFixture",box2d.b2WorldFlag.e_newFixture);goog.exportProperty(box2d.b2WorldFlag,"e_locked",box2d.b2WorldFlag.e_locked);goog.exportProperty(box2d.b2WorldFlag,"e_clearForces",box2d.b2WorldFlag.e_clearForces);
box2d.b2World=function(a){this.m_flags=box2d.b2WorldFlag.e_clearForces;this.m_contactManager=new box2d.b2ContactManager;this.m_gravity=a.Clone();this.m_out_gravity=new box2d.b2Vec2;this.m_allowSleep=!0;this.m_debugDraw=this.m_destructionListener=null;this.m_continuousPhysics=this.m_warmStarting=!0;this.m_subStepping=!1;this.m_stepComplete=!0;this.m_profile=new box2d.b2Profile;this.m_island=new box2d.b2Island;this.s_stack=[]};box2d.b2World.prototype.m_flags=box2d.b2WorldFlag.e_none;
box2d.b2World.prototype.m_contactManager=null;box2d.b2World.prototype.m_bodyList=null;box2d.b2World.prototype.m_jointList=null;box2d.b2World.prototype.m_bodyCount=0;box2d.b2World.prototype.m_jointCount=0;box2d.b2World.prototype.m_gravity=null;box2d.b2World.prototype.m_out_gravity=null;box2d.b2World.prototype.m_allowSleep=!0;box2d.b2World.prototype.m_destructionListener=null;box2d.b2World.prototype.m_debugDraw=null;box2d.b2World.prototype.m_inv_dt0=0;box2d.b2World.prototype.m_warmStarting=!0;
box2d.b2World.prototype.m_continuousPhysics=!0;box2d.b2World.prototype.m_subStepping=!1;box2d.b2World.prototype.m_stepComplete=!0;box2d.b2World.prototype.m_profile=null;box2d.b2World.prototype.m_island=null;box2d.b2World.prototype.s_stack=null;box2d.b2World.prototype.m_controllerList=null;box2d.b2World.prototype.m_controllerCount=0;box2d.b2World.prototype.SetAllowSleeping=function(a){if(a!==this.m_allowSleep&&(this.m_allowSleep=a,!1===this.m_allowSleep))for(a=this.m_bodyList;a;a=a.m_next)a.SetAwake(!0)};
box2d.b2World.prototype.GetAllowSleeping=function(){return this.m_allowSleep};box2d.b2World.prototype.SetWarmStarting=function(a){this.m_warmStarting=a};box2d.b2World.prototype.GetWarmStarting=function(){return this.m_warmStarting};box2d.b2World.prototype.SetContinuousPhysics=function(a){this.m_continuousPhysics=a};box2d.b2World.prototype.GetContinuousPhysics=function(){return this.m_continuousPhysics};box2d.b2World.prototype.SetSubStepping=function(a){this.m_subStepping=a};
box2d.b2World.prototype.GetSubStepping=function(){return this.m_subStepping};box2d.b2World.prototype.GetBodyList=function(){return this.m_bodyList};box2d.b2World.prototype.GetJointList=function(){return this.m_jointList};box2d.b2World.prototype.GetContactList=function(){return this.m_contactManager.m_contactList};box2d.b2World.prototype.GetBodyCount=function(){return this.m_bodyCount};box2d.b2World.prototype.GetJointCount=function(){return this.m_jointCount};
box2d.b2World.prototype.GetContactCount=function(){return this.m_contactManager.m_contactCount};box2d.b2World.prototype.SetGravity=function(a,b){b=b||!0;if(this.m_gravity.x!==a.x||this.m_gravity.y!==a.y)if(this.m_gravity.Copy(a),b)for(var c=this.m_bodyList;c;c=c.m_next)c.SetAwake(!0)};box2d.b2World.prototype.GetGravity=function(a){a=a||this.m_out_gravity;return a.Copy(this.m_gravity)};box2d.b2World.prototype.IsLocked=function(){return 0<(this.m_flags&box2d.b2WorldFlag.e_locked)};
box2d.b2World.prototype.SetAutoClearForces=function(a){this.m_flags=a?this.m_flags|box2d.b2WorldFlag.e_clearForces:this.m_flags&~box2d.b2WorldFlag.e_clearForces};box2d.b2World.prototype.GetAutoClearForces=function(){return(this.m_flags&box2d.b2WorldFlag.e_clearForces)===box2d.b2WorldFlag.e_clearForces};box2d.b2World.prototype.GetContactManager=function(){return this.m_contactManager};box2d.b2World.prototype.GetProfile=function(){return this.m_profile};
box2d.b2World.prototype.SetDestructionListener=function(a){this.m_destructionListener=a};box2d.b2World.prototype.SetContactFilter=function(a){this.m_contactManager.m_contactFilter=a};box2d.b2World.prototype.SetContactListener=function(a){this.m_contactManager.m_contactListener=a};box2d.b2World.prototype.SetDebugDraw=function(a){this.m_debugDraw=a};
box2d.b2World.prototype.CreateBody=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked());if(this.IsLocked())return null;a=new box2d.b2Body(a,this);a.m_prev=null;if(a.m_next=this.m_bodyList)this.m_bodyList.m_prev=a;this.m_bodyList=a;++this.m_bodyCount;return a};
box2d.b2World.prototype.DestroyBody=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_bodyCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked());if(!this.IsLocked()){for(var b=a.m_jointList;b;){var c=b;b=b.next;this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(c.joint);this.DestroyJoint(c.joint);a.m_jointList=b}a.m_jointList=null;for(b=a.m_controllerList;b;)c=b,b=b.nextController,c.controller.RemoveBody(a);for(b=a.m_contactList;b;)c=b,b=b.next,this.m_contactManager.Destroy(c.contact);
a.m_contactList=null;for(b=a.m_fixtureList;b;)c=b,b=b.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(c),c.DestroyProxies(this.m_contactManager.m_broadPhase),c.Destroy(),a.m_fixtureList=b,--a.m_fixtureCount;a.m_fixtureList=null;a.m_fixtureCount=0;a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);a===this.m_bodyList&&(this.m_bodyList=a.m_next);--this.m_bodyCount}};
box2d.b2World.prototype.CreateJoint=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked());if(this.IsLocked())return null;var b=box2d.b2JointFactory.Create(a,null);b.m_prev=null;if(b.m_next=this.m_jointList)this.m_jointList.m_prev=b;this.m_jointList=b;++this.m_jointCount;b.m_edgeA.joint=b;b.m_edgeA.other=b.m_bodyB;b.m_edgeA.prev=null;if(b.m_edgeA.next=b.m_bodyA.m_jointList)b.m_bodyA.m_jointList.prev=b.m_edgeA;b.m_bodyA.m_jointList=b.m_edgeA;b.m_edgeB.joint=b;b.m_edgeB.other=b.m_bodyA;
b.m_edgeB.prev=null;if(b.m_edgeB.next=b.m_bodyB.m_jointList)b.m_bodyB.m_jointList.prev=b.m_edgeB;b.m_bodyB.m_jointList=b.m_edgeB;var c=a.bodyA,d=a.bodyB;if(!1===a.collideConnected)for(a=d.GetContactList();a;)a.other===c&&a.contact.FlagForFiltering(),a=a.next;return b};
box2d.b2World.prototype.DestroyJoint=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked());if(!this.IsLocked()){var b=a.m_collideConnected;a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);a===this.m_jointList&&(this.m_jointList=a.m_next);var c=a.m_bodyA,d=a.m_bodyB;c.SetAwake(!0);d.SetAwake(!0);a.m_edgeA.prev&&(a.m_edgeA.prev.next=a.m_edgeA.next);a.m_edgeA.next&&(a.m_edgeA.next.prev=a.m_edgeA.prev);a.m_edgeA===c.m_jointList&&(c.m_jointList=a.m_edgeA.next);
a.m_edgeA.prev=null;a.m_edgeA.next=null;a.m_edgeB.prev&&(a.m_edgeB.prev.next=a.m_edgeB.next);a.m_edgeB.next&&(a.m_edgeB.next.prev=a.m_edgeB.prev);a.m_edgeB===d.m_jointList&&(d.m_jointList=a.m_edgeB.next);a.m_edgeB.prev=null;a.m_edgeB.next=null;box2d.b2JointFactory.Destroy(a,null);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_jointCount);--this.m_jointCount;if(!1===b)for(a=d.GetContactList();a;)a.other===c&&a.contact.FlagForFiltering(),a=a.next}};
box2d.b2World.prototype.Solve=function(a){for(var b=this.m_controllerList;b;b=b.m_next)b.Step(a);this.m_profile.solveInit=0;this.m_profile.solveVelocity=0;this.m_profile.solvePosition=0;b=this.m_island;b.Initialize(this.m_bodyCount,this.m_contactManager.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener);for(var c=this.m_bodyList;c;c=c.m_next)c.m_flags&=~box2d.b2BodyFlag.e_islandFlag;for(var d=this.m_contactManager.m_contactList;d;d=d.m_next)d.m_flags&=~box2d.b2ContactFlag.e_islandFlag;
for(d=this.m_jointList;d;d=d.m_next)d.m_islandFlag=!1;d=this.m_bodyCount;for(var e=this.s_stack,f=this.m_bodyList;f;f=f.m_next)if(!(f.m_flags&box2d.b2BodyFlag.e_islandFlag)&&!1!==f.IsAwake()&&!1!==f.IsActive()&&f.GetType()!==box2d.b2BodyType.b2_staticBody){b.Clear();var g=0;e[g++]=f;for(f.m_flags|=box2d.b2BodyFlag.e_islandFlag;0<g;)if(c=e[--g],box2d.ENABLE_ASSERTS&&box2d.b2Assert(!0===c.IsActive()),b.AddBody(c),c.SetAwake(!0),c.GetType()!==box2d.b2BodyType.b2_staticBody){for(var h=c.m_contactList;h;h=
h.next){var k=h.contact;if(!(k.m_flags&box2d.b2ContactFlag.e_islandFlag)&&!1!==k.IsEnabled()&&!1!==k.IsTouching()){var l=k.m_fixtureB.m_isSensor;k.m_fixtureA.m_isSensor||l||(b.AddContact(k),k.m_flags|=box2d.b2ContactFlag.e_islandFlag,k=h.other,k.m_flags&box2d.b2BodyFlag.e_islandFlag||(box2d.ENABLE_ASSERTS&&box2d.b2Assert(g<d),e[g++]=k,k.m_flags|=box2d.b2BodyFlag.e_islandFlag))}}for(c=c.m_jointList;c;c=c.next)!0!==c.joint.m_islandFlag&&(k=c.other,!1!==k.IsActive()&&(b.AddJoint(c.joint),c.joint.m_islandFlag=
!0,k.m_flags&box2d.b2BodyFlag.e_islandFlag||(box2d.ENABLE_ASSERTS&&box2d.b2Assert(g<d),e[g++]=k,k.m_flags|=box2d.b2BodyFlag.e_islandFlag)))}c=new box2d.b2Profile;b.Solve(c,a,this.m_gravity,this.m_allowSleep);this.m_profile.solveInit+=c.solveInit;this.m_profile.solveVelocity+=c.solveVelocity;this.m_profile.solvePosition+=c.solvePosition;for(g=0;g<b.m_bodyCount;++g)c=b.m_bodies[g],c.GetType()===box2d.b2BodyType.b2_staticBody&&(c.m_flags&=~box2d.b2BodyFlag.e_islandFlag)}for(g=0;g<e.length&&e[g];++g)e[g]=
null;a=new box2d.b2Timer;for(c=this.m_bodyList;c;c=c.m_next)0!==(c.m_flags&box2d.b2BodyFlag.e_islandFlag)&&c.GetType()!==box2d.b2BodyType.b2_staticBody&&c.SynchronizeFixtures();this.m_contactManager.FindNewContacts();this.m_profile.broadphase=a.GetMilliseconds()};
box2d.b2World.prototype.SolveTOI=function(a){var b=this.m_island;b.Initialize(2*box2d.b2_maxTOIContacts,box2d.b2_maxTOIContacts,0,null,this.m_contactManager.m_contactListener);if(this.m_stepComplete){for(var c=this.m_bodyList;c;c=c.m_next)c.m_flags&=~box2d.b2BodyFlag.e_islandFlag,c.m_sweep.alpha0=0;for(var d=this.m_contactManager.m_contactList;d;d=d.m_next)d.m_flags&=~(box2d.b2ContactFlag.e_toiFlag|box2d.b2ContactFlag.e_islandFlag),d.m_toiCount=0,d.m_toi=1}for(;;){var e=null;c=1;for(d=this.m_contactManager.m_contactList;d;d=
d.m_next)if(!1!==d.IsEnabled()&&!(d.m_toiCount>box2d.b2_maxSubSteps)){if(d.m_flags&box2d.b2ContactFlag.e_toiFlag)var f=d.m_toi;else{var g=d.GetFixtureA(),h=d.GetFixtureB();if(g.IsSensor()||h.IsSensor())continue;f=g.GetBody();var k=h.GetBody(),l=f.m_type,m=k.m_type;box2d.ENABLE_ASSERTS&&box2d.b2Assert(l===box2d.b2BodyType.b2_dynamicBody||m===box2d.b2BodyType.b2_dynamicBody);var n=f.IsAwake()&&l!==box2d.b2BodyType.b2_staticBody,p=k.IsAwake()&&m!==box2d.b2BodyType.b2_staticBody;if(!1===n&&!1===p)continue;
l=f.IsBullet()||l!==box2d.b2BodyType.b2_dynamicBody;m=k.IsBullet()||m!==box2d.b2BodyType.b2_dynamicBody;if(!1===l&&!1===m)continue;m=f.m_sweep.alpha0;f.m_sweep.alpha0<k.m_sweep.alpha0?(m=k.m_sweep.alpha0,f.m_sweep.Advance(m)):k.m_sweep.alpha0<f.m_sweep.alpha0&&(m=f.m_sweep.alpha0,k.m_sweep.Advance(m));box2d.ENABLE_ASSERTS&&box2d.b2Assert(1>m);n=d.GetChildIndexA();p=d.GetChildIndexB();l=box2d.b2World.prototype.SolveTOI.s_toi_input;l.proxyA.SetShape(g.GetShape(),n);l.proxyB.SetShape(h.GetShape(),p);
l.sweepA.Copy(f.m_sweep);l.sweepB.Copy(k.m_sweep);l.tMax=1;f=box2d.b2World.prototype.SolveTOI.s_toi_output;box2d.b2TimeOfImpact(f,l);k=f.t;f=f.state===box2d.b2TOIOutputState.e_touching?box2d.b2Min(m+(1-m)*k,1):1;d.m_toi=f;d.m_flags|=box2d.b2ContactFlag.e_toiFlag}f<c&&(e=d,c=f)}if(null===e||1-10*box2d.b2_epsilon<c){this.m_stepComplete=!0;break}g=e.GetFixtureA();h=e.GetFixtureB();f=g.GetBody();k=h.GetBody();d=box2d.b2World.prototype.SolveTOI.s_backup1.Copy(f.m_sweep);g=box2d.b2World.prototype.SolveTOI.s_backup2.Copy(k.m_sweep);
f.Advance(c);k.Advance(c);e.Update(this.m_contactManager.m_contactListener);e.m_flags&=~box2d.b2ContactFlag.e_toiFlag;++e.m_toiCount;if(!1===e.IsEnabled()||!1===e.IsTouching())e.SetEnabled(!1),f.m_sweep.Copy(d),k.m_sweep.Copy(g),f.SynchronizeTransform(),k.SynchronizeTransform();else{f.SetAwake(!0);k.SetAwake(!0);b.Clear();b.AddBody(f);b.AddBody(k);b.AddContact(e);f.m_flags|=box2d.b2BodyFlag.e_islandFlag;k.m_flags|=box2d.b2BodyFlag.e_islandFlag;e.m_flags|=box2d.b2ContactFlag.e_islandFlag;for(e=0;2>
e;++e)if(d=0===e?f:k,d.m_type===box2d.b2BodyType.b2_dynamicBody)for(g=d.m_contactList;g&&b.m_bodyCount!==b.m_bodyCapacity&&b.m_contactCount!==b.m_contactCapacity;g=g.next)h=g.contact,h.m_flags&box2d.b2ContactFlag.e_islandFlag||(m=g.other,m.m_type===box2d.b2BodyType.b2_dynamicBody&&!1===d.IsBullet()&&!1===m.IsBullet())||(l=h.m_fixtureB.m_isSensor,h.m_fixtureA.m_isSensor||l||(l=box2d.b2World.prototype.SolveTOI.s_backup.Copy(m.m_sweep),0===(m.m_flags&box2d.b2BodyFlag.e_islandFlag)&&m.Advance(c),h.Update(this.m_contactManager.m_contactListener),
!1===h.IsEnabled()?(m.m_sweep.Copy(l),m.SynchronizeTransform()):!1===h.IsTouching()?(m.m_sweep.Copy(l),m.SynchronizeTransform()):(h.m_flags|=box2d.b2ContactFlag.e_islandFlag,b.AddContact(h),m.m_flags&box2d.b2BodyFlag.e_islandFlag||(m.m_flags|=box2d.b2BodyFlag.e_islandFlag,m.m_type!==box2d.b2BodyType.b2_staticBody&&m.SetAwake(!0),b.AddBody(m)))));e=box2d.b2World.prototype.SolveTOI.s_subStep;e.dt=(1-c)*a.dt;e.inv_dt=1/e.dt;e.dtRatio=1;e.positionIterations=20;e.velocityIterations=a.velocityIterations;
e.warmStarting=!1;b.SolveTOI(e,f.m_islandIndex,k.m_islandIndex);for(e=0;e<b.m_bodyCount;++e)if(d=b.m_bodies[e],d.m_flags&=~box2d.b2BodyFlag.e_islandFlag,d.m_type===box2d.b2BodyType.b2_dynamicBody)for(d.SynchronizeFixtures(),g=d.m_contactList;g;g=g.next)g.contact.m_flags&=~(box2d.b2ContactFlag.e_toiFlag|box2d.b2ContactFlag.e_islandFlag);this.m_contactManager.FindNewContacts();if(this.m_subStepping){this.m_stepComplete=!1;break}}}};box2d.b2World.prototype.SolveTOI.s_subStep=new box2d.b2TimeStep;
box2d.b2World.prototype.SolveTOI.s_backup=new box2d.b2Sweep;box2d.b2World.prototype.SolveTOI.s_backup1=new box2d.b2Sweep;box2d.b2World.prototype.SolveTOI.s_backup2=new box2d.b2Sweep;box2d.b2World.prototype.SolveTOI.s_toi_input=new box2d.b2TOIInput;box2d.b2World.prototype.SolveTOI.s_toi_output=new box2d.b2TOIOutput;
box2d.b2World.prototype.Step=function(a,b,c){var d=new box2d.b2Timer;this.m_flags&box2d.b2WorldFlag.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~box2d.b2WorldFlag.e_newFixture);this.m_flags|=box2d.b2WorldFlag.e_locked;var e=box2d.b2World.prototype.Step.s_step;e.dt=a;e.velocityIterations=b;e.positionIterations=c;e.inv_dt=0<a?1/a:0;e.dtRatio=this.m_inv_dt0*a;e.warmStarting=this.m_warmStarting;a=new box2d.b2Timer;this.m_contactManager.Collide();this.m_profile.collide=a.GetMilliseconds();
this.m_stepComplete&&0<e.dt&&(a=new box2d.b2Timer,this.Solve(e),this.m_profile.solve=a.GetMilliseconds());this.m_continuousPhysics&&0<e.dt&&(a=new box2d.b2Timer,this.SolveTOI(e),this.m_profile.solveTOI=a.GetMilliseconds());0<e.dt&&(this.m_inv_dt0=e.inv_dt);this.m_flags&box2d.b2WorldFlag.e_clearForces&&this.ClearForces();this.m_flags&=~box2d.b2WorldFlag.e_locked;this.m_profile.step=d.GetMilliseconds()};box2d.b2World.prototype.Step.s_step=new box2d.b2TimeStep;
box2d.b2World.prototype.ClearForces=function(){for(var a=this.m_bodyList;a;a=a.m_next)a.m_force.SetZero(),a.m_torque=0};box2d.b2World.prototype.QueryAABB=function(a,b){var c=this.m_contactManager.m_broadPhase;c.Query(function(b){b=c.GetUserData(b);box2d.ENABLE_ASSERTS&&box2d.b2Assert(b instanceof box2d.b2FixtureProxy);b=b.fixture;return a instanceof box2d.b2QueryCallback?a.ReportFixture(b):a(b)},b)};
box2d.b2World.prototype.QueryShape=function(a,b,c){var d=this.m_contactManager.m_broadPhase,e=box2d.b2World.prototype.QueryShape.s_aabb;b.ComputeAABB(e,c,0);d.Query(function(e){e=d.GetUserData(e);box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2FixtureProxy);e=e.fixture;return box2d.b2TestOverlapShape(b,0,e.GetShape(),0,c,e.GetBody().GetTransform())?a instanceof box2d.b2QueryCallback?a.ReportFixture(e):a(e):!0},e)};box2d.b2World.prototype.QueryShape.s_aabb=new box2d.b2AABB;
box2d.b2World.prototype.QueryPoint=function(a,b){var c=this.m_contactManager.m_broadPhase,d=box2d.b2World.prototype.QueryPoint.s_aabb;d.lowerBound.SetXY(b.x-box2d.b2_linearSlop,b.y-box2d.b2_linearSlop);d.upperBound.SetXY(b.x+box2d.b2_linearSlop,b.y+box2d.b2_linearSlop);c.Query(function(d){d=c.GetUserData(d);box2d.ENABLE_ASSERTS&&box2d.b2Assert(d instanceof box2d.b2FixtureProxy);d=d.fixture;return d.TestPoint(b)?a instanceof box2d.b2QueryCallback?a.ReportFixture(d):a(d):!0},d)};
box2d.b2World.prototype.QueryPoint.s_aabb=new box2d.b2AABB;
box2d.b2World.prototype.RayCast=function(a,b,c){var d=this.m_contactManager.m_broadPhase,e=box2d.b2World.prototype.RayCast.s_input;e.maxFraction=1;e.p1.Copy(b);e.p2.Copy(c);d.RayCast(function(e,g){var f=d.GetUserData(g);box2d.ENABLE_ASSERTS&&box2d.b2Assert(f instanceof box2d.b2FixtureProxy);var k=f.fixture,l=box2d.b2World.prototype.RayCast.s_output;if(k.RayCast(l,e,f.childIndex)){f=l.fraction;var m=box2d.b2World.prototype.RayCast.s_point;m.SetXY((1-f)*b.x+f*c.x,(1-f)*b.y+f*c.y);return a instanceof
box2d.b2RayCastCallback?a.ReportFixture(k,m,l.normal,f):a(k,m,l.normal,f)}return e.maxFraction},e)};box2d.b2World.prototype.RayCast.s_input=new box2d.b2RayCastInput;box2d.b2World.prototype.RayCast.s_output=new box2d.b2RayCastOutput;box2d.b2World.prototype.RayCast.s_point=new box2d.b2Vec2;box2d.b2World.prototype.RayCastOne=function(a,b){var c=null,d=1;this.RayCast(function(a,b,g,h){h<d&&(d=h,c=a);return d},a,b);return c};
box2d.b2World.prototype.RayCastAll=function(a,b,c){c.length=0;this.RayCast(function(a,b,f,g){c.push(a);return 1},a,b);return c};
box2d.b2World.prototype.DrawShape=function(a,b){var c=a.GetShape();switch(c.m_type){case box2d.b2ShapeType.e_circleShape:c=c instanceof box2d.b2CircleShape?c:null;this.m_debugDraw.DrawSolidCircle(c.m_p,c.m_radius,box2d.b2Vec2.UNITX,b);break;case box2d.b2ShapeType.e_edgeShape:var d=c instanceof box2d.b2EdgeShape?c:null;c=d.m_vertex1;var e=d.m_vertex2;this.m_debugDraw.DrawSegment(c,e,b);break;case box2d.b2ShapeType.e_chainShape:c=c instanceof box2d.b2ChainShape?c:null;d=c.m_count;var f=c.m_vertices;
c=f[0];for(var g=0;g<d;++g)e=f[g],this.m_debugDraw.DrawSegment(c,e,b),this.m_debugDraw.DrawCircle(e,.05,b),c=e;break;case box2d.b2ShapeType.e_polygonShape:d=c instanceof box2d.b2PolygonShape?c:null,c=d.m_count,f=d.m_vertices,this.m_debugDraw.DrawSolidPolygon(f,c,b)}};
box2d.b2World.prototype.DrawJoint=function(a){var b=a.GetBodyA(),c=a.GetBodyB(),d=b.m_xf.p,e=c.m_xf.p;c=a.GetAnchorA(box2d.b2World.prototype.DrawJoint.s_p1);b=a.GetAnchorB(box2d.b2World.prototype.DrawJoint.s_p2);var f=box2d.b2World.prototype.DrawJoint.s_color.SetRGB(.5,.8,.8);switch(a.m_type){case box2d.b2JointType.e_distanceJoint:this.m_debugDraw.DrawSegment(c,b,f);break;case box2d.b2JointType.e_pulleyJoint:d=a instanceof box2d.b2PulleyJoint?a:null;a=d.GetGroundAnchorA(box2d.b2World.prototype.DrawJoint.s_s1);
d=d.GetGroundAnchorB(box2d.b2World.prototype.DrawJoint.s_s2);this.m_debugDraw.DrawSegment(a,c,f);this.m_debugDraw.DrawSegment(d,b,f);this.m_debugDraw.DrawSegment(a,d,f);break;case box2d.b2JointType.e_mouseJoint:this.m_debugDraw.DrawSegment(c,b,f);break;default:this.m_debugDraw.DrawSegment(d,c,f),this.m_debugDraw.DrawSegment(c,b,f),this.m_debugDraw.DrawSegment(e,b,f)}};box2d.b2World.prototype.DrawJoint.s_p1=new box2d.b2Vec2;box2d.b2World.prototype.DrawJoint.s_p2=new box2d.b2Vec2;
box2d.b2World.prototype.DrawJoint.s_color=new box2d.b2Color(.5,.8,.8);box2d.b2World.prototype.DrawJoint.s_s1=new box2d.b2Vec2;box2d.b2World.prototype.DrawJoint.s_s2=new box2d.b2Vec2;
box2d.b2World.prototype.DrawDebugData=function(){if(null!==this.m_debugDraw){var a=this.m_debugDraw.GetFlags(),b=box2d.b2World.prototype.DrawDebugData.s_color.SetRGB(0,0,0);if(a&box2d.b2DrawFlags.e_shapeBit)for(var c=this.m_bodyList;c;c=c.m_next){var d=c.m_xf;this.m_debugDraw.PushTransform(d);for(var e=c.GetFixtureList();e;e=e.m_next)!1===c.IsActive()?b.SetRGB(.5,.5,.3):c.GetType()===box2d.b2BodyType.b2_staticBody?b.SetRGB(.5,.9,.5):c.GetType()===box2d.b2BodyType.b2_kinematicBody?b.SetRGB(.5,.5,.9):
!1===c.IsAwake()?b.SetRGB(.6,.6,.6):b.SetRGB(.9,.7,.7),this.DrawShape(e,b);this.m_debugDraw.PopTransform(d)}if(a&box2d.b2DrawFlags.e_jointBit)for(c=this.m_jointList;c;c=c.m_next)this.DrawJoint(c);if(a&box2d.b2DrawFlags.e_aabbBit){b.SetRGB(.9,.3,.9);d=this.m_contactManager.m_broadPhase;var f=box2d.b2World.prototype.DrawDebugData.s_vs;for(c=this.m_bodyList;c;c=c.m_next)if(!1!==c.IsActive())for(e=c.GetFixtureList();e;e=e.m_next)for(var g=0;g<e.m_proxyCount;++g){var h=d.GetFatAABB(e.m_proxies[g].proxy);
f[0].SetXY(h.lowerBound.x,h.lowerBound.y);f[1].SetXY(h.upperBound.x,h.lowerBound.y);f[2].SetXY(h.upperBound.x,h.upperBound.y);f[3].SetXY(h.lowerBound.x,h.upperBound.y);this.m_debugDraw.DrawPolygon(f,4,b)}}if(a&box2d.b2DrawFlags.e_centerOfMassBit)for(c=this.m_bodyList;c;c=c.m_next)d=box2d.b2World.prototype.DrawDebugData.s_xf,d.q.Copy(c.m_xf.q),d.p.Copy(c.GetWorldCenter()),this.m_debugDraw.DrawTransform(d);if(a&box2d.b2DrawFlags.e_controllerBit)for(a=this.m_controllerList;a;a=a.m_next)a.Draw(this.m_debugDraw)}};
box2d.b2World.prototype.DrawDebugData.s_color=new box2d.b2Color(0,0,0);box2d.b2World.prototype.DrawDebugData.s_vs=box2d.b2Vec2.MakeArray(4);box2d.b2World.prototype.DrawDebugData.s_xf=new box2d.b2Transform;box2d.b2World.prototype.SetBroadPhase=function(a){var b=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=a;for(var c=this.m_bodyList;c;c=c.m_next)for(var d=c.m_fixtureList;d;d=d.m_next)d.m_proxy=a.CreateProxy(b.GetFatAABB(d.m_proxy),d)};
box2d.b2World.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()};box2d.b2World.prototype.GetTreeHeight=function(){return this.m_contactManager.m_broadPhase.GetTreeHeight()};box2d.b2World.prototype.GetTreeBalance=function(){return this.m_contactManager.m_broadPhase.GetTreeBalance()};box2d.b2World.prototype.GetTreeQuality=function(){return this.m_contactManager.m_broadPhase.GetTreeQuality()};
box2d.b2World.prototype.ShiftOrigin=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked());if(!this.IsLocked()){for(var b=this.m_bodyList;b;b=b.m_next)b.m_xf.p.SelfSub(a),b.m_sweep.c0.SelfSub(a),b.m_sweep.c.SelfSub(a);for(b=this.m_jointList;b;b=b.m_next)b.ShiftOrigin(a);this.m_contactManager.m_broadPhase.ShiftOrigin(a)}};
box2d.b2World.prototype.Dump=function(){if(box2d.DEBUG&&(this.m_flags&box2d.b2WorldFlag.e_locked)!==box2d.b2WorldFlag.e_locked){box2d.b2Log("/** @type {box2d.b2Vec2} */ var g = new box2d.b2Vec2(%.15f, %.15f);\n",this.m_gravity.x,this.m_gravity.y);box2d.b2Log("this.m_world.SetGravity(g);\n");box2d.b2Log("/** @type {Array.<box2d.b2Body>} */ var bodies = new Array(%d);\n",this.m_bodyCount);box2d.b2Log("/** @type {Array.<box2d.b2Joint>} */ var joints = new Array(%d);\n",this.m_jointCount);for(var a=0,
b=this.m_bodyList;b;b=b.m_next)b.m_islandIndex=a,b.Dump(),++a;a=0;for(b=this.m_jointList;b;b=b.m_next)b.m_index=a,++a;for(b=this.m_jointList;b;b=b.m_next)b.m_type!==box2d.b2JointType.e_gearJoint&&(box2d.b2Log("if (true)\n"),box2d.b2Log("{\n"),b.Dump(),box2d.b2Log("}\n"));for(b=this.m_jointList;b;b=b.m_next)b.m_type===box2d.b2JointType.e_gearJoint&&(box2d.b2Log("if (true)\n"),box2d.b2Log("{\n"),b.Dump(),box2d.b2Log("}\n"))}};
box2d.b2World.prototype.AddController=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===a.m_world,"Controller can only be a member of one world");a.m_world=this;a.m_next=this.m_controllerList;a.m_prev=null;this.m_controllerList&&(this.m_controllerList.m_prev=a);this.m_controllerList=a;++this.m_controllerCount;return a};
box2d.b2World.prototype.RemoveController=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.m_world===this,"Controller is not a member of this world");a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);this.m_controllerList===a&&(this.m_controllerList=a.m_next);--this.m_controllerCount;a.m_prev=null;a.m_next=null;a.m_world=null};box2d.b2AreaJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_areaJoint);this.bodies=[]};goog.inherits(box2d.b2AreaJointDef,box2d.b2JointDef);
box2d.b2AreaJointDef.prototype.world=null;box2d.b2AreaJointDef.prototype.bodies=null;box2d.b2AreaJointDef.prototype.frequencyHz=0;box2d.b2AreaJointDef.prototype.dampingRatio=0;box2d.b2AreaJointDef.prototype.AddBody=function(a){this.bodies.push(a);1===this.bodies.length?this.bodyA=a:2===this.bodies.length&&(this.bodyB=a)};
box2d.b2AreaJoint=function(a){box2d.b2Joint.call(this,a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=a.bodies.length,"You cannot create an area joint with less than three bodies.");this.m_bodies=a.bodies;this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_targetLengths=box2d.b2MakeNumberArray(a.bodies.length);this.m_normals=box2d.b2Vec2.MakeArray(a.bodies.length);this.m_joints=Array(a.bodies.length);this.m_deltas=box2d.b2Vec2.MakeArray(a.bodies.length);this.m_delta=new box2d.b2Vec2;
var b=new box2d.b2DistanceJointDef;b.frequencyHz=a.frequencyHz;b.dampingRatio=a.dampingRatio;for(var c=this.m_targetArea=0,d=this.m_bodies.length;c<d;++c){var e=this.m_bodies[c],f=this.m_bodies[(c+1)%d],g=e.GetWorldCenter(),h=f.GetWorldCenter();this.m_targetLengths[c]=box2d.b2DistanceVV(g,h);this.m_targetArea+=box2d.b2CrossVV(g,h);b.Initialize(e,f,g,h);this.m_joints[c]=a.world.CreateJoint(b)}this.m_targetArea*=.5};goog.inherits(box2d.b2AreaJoint,box2d.b2Joint);
box2d.b2AreaJoint.prototype.m_bodies=null;box2d.b2AreaJoint.prototype.m_frequencyHz=0;box2d.b2AreaJoint.prototype.m_dampingRatio=0;box2d.b2AreaJoint.prototype.m_impulse=0;box2d.b2AreaJoint.prototype.m_targetLengths=null;box2d.b2AreaJoint.prototype.m_targetArea=0;box2d.b2AreaJoint.prototype.m_normals=null;box2d.b2AreaJoint.prototype.m_joints=null;box2d.b2AreaJoint.prototype.m_deltas=null;box2d.b2AreaJoint.prototype.m_delta=null;box2d.b2AreaJoint.prototype.GetAnchorA=function(a){return a.SetZero()};
box2d.b2AreaJoint.prototype.GetAnchorB=function(a){return a.SetZero()};box2d.b2AreaJoint.prototype.GetReactionForce=function(a,b){return b.SetZero()};box2d.b2AreaJoint.prototype.GetReactionTorque=function(a){return 0};box2d.b2AreaJoint.prototype.SetFrequency=function(a){this.m_frequencyHz=a;for(var b=0,c=this.m_joints.length;b<c;++b)this.m_joints[b].SetFrequency(a)};box2d.b2AreaJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};
box2d.b2AreaJoint.prototype.SetDampingRatio=function(a){this.m_dampingRatio=a;for(var b=0,c=this.m_joints.length;b<c;++b)this.m_joints[b].SetDampingRatio(a)};box2d.b2AreaJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};box2d.b2AreaJoint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("Area joint dumping is not supported.\n")};
box2d.b2AreaJoint.prototype.InitVelocityConstraints=function(a){for(var b=0,c=this.m_bodies.length;b<c;++b){var d=this.m_deltas[b];box2d.b2SubVV(a.positions[this.m_bodies[(b+1)%c].m_islandIndex].c,a.positions[this.m_bodies[(b+c-1)%c].m_islandIndex].c,d)}if(a.step.warmStarting)for(this.m_impulse*=a.step.dtRatio,b=0,c=this.m_bodies.length;b<c;++b){var e=this.m_bodies[b],f=a.velocities[e.m_islandIndex].v;d=this.m_deltas[b];f.x+=e.m_invMass*d.y*.5*this.m_impulse;f.y+=e.m_invMass*-d.x*.5*this.m_impulse}else this.m_impulse=
0};box2d.b2AreaJoint.prototype.SolveVelocityConstraints=function(a){for(var b=0,c=0,d=0,e=this.m_bodies.length;d<e;++d){var f=this.m_bodies[d],g=a.velocities[f.m_islandIndex].v,h=this.m_deltas[d];b+=h.GetLengthSquared()/f.GetMass();c+=box2d.b2CrossVV(g,h)}b=-2*c/b;this.m_impulse+=b;d=0;for(e=this.m_bodies.length;d<e;++d)f=this.m_bodies[d],g=a.velocities[f.m_islandIndex].v,h=this.m_deltas[d],g.x+=f.m_invMass*h.y*.5*b,g.y+=f.m_invMass*-h.x*.5*b};
box2d.b2AreaJoint.prototype.SolvePositionConstraints=function(a){for(var b=0,c=0,d=0,e=this.m_bodies.length;d<e;++d){var f=this.m_bodies[d];f=a.positions[f.m_islandIndex].c;var g=a.positions[this.m_bodies[(d+1)%e].m_islandIndex].c,h=box2d.b2SubVV(g,f,this.m_delta),k=h.GetLength();k<box2d.b2_epsilon&&(k=1);this.m_normals[d].x=h.y/k;this.m_normals[d].y=-h.x/k;b+=k;c+=box2d.b2CrossVV(f,g)}b=.5*(this.m_targetArea-.5*c)/b;c=!0;d=0;for(e=this.m_bodies.length;d<e;++d)f=this.m_bodies[d],f=a.positions[f.m_islandIndex].c,
h=box2d.b2AddVV(this.m_normals[d],this.m_normals[(d+1)%e],this.m_delta),h.SelfMul(b),g=h.GetLengthSquared(),g>box2d.b2Sq(box2d.b2_maxLinearCorrection)&&h.SelfMul(box2d.b2_maxLinearCorrection/box2d.b2Sqrt(g)),g>box2d.b2Sq(box2d.b2_linearSlop)&&(c=!1),f.x+=h.x,f.y+=h.y;return c};box2d.b2BuoyancyController=function(){box2d.b2Controller.call(this);this.normal=new box2d.b2Vec2(0,1);this.velocity=new box2d.b2Vec2(0,0);this.gravity=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2BuoyancyController,box2d.b2Controller);
box2d.b2BuoyancyController.prototype.normal=null;box2d.b2BuoyancyController.prototype.offset=0;box2d.b2BuoyancyController.prototype.density=0;box2d.b2BuoyancyController.prototype.velocity=null;box2d.b2BuoyancyController.prototype.linearDrag=0;box2d.b2BuoyancyController.prototype.angularDrag=0;box2d.b2BuoyancyController.prototype.useDensity=!1;box2d.b2BuoyancyController.prototype.useWorldGravity=!0;box2d.b2BuoyancyController.prototype.gravity=null;
box2d.b2BuoyancyController.prototype.Step=function(a){if(this.m_bodyList)for(this.useWorldGravity&&this.gravity.Copy(this.GetWorld().GetGravity()),a=this.m_bodyList;a;a=a.nextBody){var b=a.body;if(!1!==b.IsAwake()){for(var c=new box2d.b2Vec2,d=new box2d.b2Vec2,e=0,f=0,g=b.GetFixtureList();g;g=g.m_next){var h=new box2d.b2Vec2,k=g.GetShape().ComputeSubmergedArea(this.normal,this.offset,b.GetTransform(),h);e+=k;c.x+=k*h.x;c.y+=k*h.y;var l=this.useDensity?g.GetDensity():1;f+=k*l;d.x+=k*h.x*l;d.y+=k*h.y*
l}c.x/=e;c.y/=e;d.x/=f;d.y/=f;e<box2d.b2_epsilon||(f=box2d.b2NegV(this.gravity,new box2d.b2Vec2),f.SelfMul(this.density*e),b.ApplyForce(f,d),d=b.GetLinearVelocityFromWorldPoint(c,new box2d.b2Vec2),d.SelfSub(this.velocity),d.SelfMul(-this.linearDrag*e),b.ApplyForce(d,c),b.ApplyTorque(-b.GetInertia()/b.GetMass()*e*b.GetAngularVelocity()*this.angularDrag))}}};
box2d.b2BuoyancyController.prototype.Draw=function(a){var b=new box2d.b2Vec2,c=new box2d.b2Vec2;b.x=this.normal.x*this.offset+100*this.normal.y;b.y=this.normal.y*this.offset-100*this.normal.x;c.x=this.normal.x*this.offset-100*this.normal.y;c.y=this.normal.y*this.offset+100*this.normal.x;var d=new box2d.b2Color(0,0,.8);a.DrawSegment(b,c,d)};box2d.b2TensorDampingController=function(){box2d.b2Controller.call(this);this.T=new box2d.b2Mat22;this.maxTimestep=0};
goog.inherits(box2d.b2TensorDampingController,box2d.b2Controller);box2d.b2TensorDampingController.prototype.T=new box2d.b2Mat22;box2d.b2TensorDampingController.prototype.maxTimestep=0;
box2d.b2TensorDampingController.prototype.Step=function(a){a=a.dt;if(!(a<=box2d.b2_epsilon)){a>this.maxTimestep&&0<this.maxTimestep&&(a=this.maxTimestep);for(var b=this.m_bodyList;b;b=b.nextBody){var c=b.body;if(c.IsAwake()){var d=c.GetWorldVector(box2d.b2MulMV(this.T,c.GetLocalVector(c.GetLinearVelocity(),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t1),box2d.b2TensorDampingController.prototype.Step.s_damping);c.SetLinearVelocity(box2d.b2AddVV(c.GetLinearVelocity(),box2d.b2MulSV(a,d,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t1))}}}};
box2d.b2TensorDampingController.prototype.Step.s_damping=new box2d.b2Vec2;box2d.b2TensorDampingController.prototype.SetAxisAligned=function(a,b){this.T.ex.x=-a;this.T.ex.y=0;this.T.ey.x=0;this.T.ey.y=-b;this.maxTimestep=0<a||0<b?1/box2d.b2Max(a,b):0};box2d.b2DistanceJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_distanceJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2};goog.inherits(box2d.b2DistanceJointDef,box2d.b2JointDef);
box2d.b2DistanceJointDef.prototype.localAnchorA=null;box2d.b2DistanceJointDef.prototype.localAnchorB=null;box2d.b2DistanceJointDef.prototype.length=1;box2d.b2DistanceJointDef.prototype.frequencyHz=0;box2d.b2DistanceJointDef.prototype.dampingRatio=0;
box2d.b2DistanceJointDef.prototype.Initialize=function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.bodyA.GetLocalPoint(c,this.localAnchorA);this.bodyB.GetLocalPoint(d,this.localAnchorB);this.length=box2d.b2DistanceVV(c,d);this.dampingRatio=this.frequencyHz=0};
box2d.b2DistanceJoint=function(a){box2d.b2Joint.call(this,a);this.m_u=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_localAnchorA=a.localAnchorA.Clone();this.m_localAnchorB=a.localAnchorB.Clone();this.m_length=a.length};
goog.inherits(box2d.b2DistanceJoint,box2d.b2Joint);box2d.b2DistanceJoint.prototype.m_frequencyHz=0;box2d.b2DistanceJoint.prototype.m_dampingRatio=0;box2d.b2DistanceJoint.prototype.m_bias=0;box2d.b2DistanceJoint.prototype.m_localAnchorA=null;box2d.b2DistanceJoint.prototype.m_localAnchorB=null;box2d.b2DistanceJoint.prototype.m_gamma=0;box2d.b2DistanceJoint.prototype.m_impulse=0;box2d.b2DistanceJoint.prototype.m_length=0;box2d.b2DistanceJoint.prototype.m_indexA=0;
box2d.b2DistanceJoint.prototype.m_indexB=0;box2d.b2DistanceJoint.prototype.m_u=null;box2d.b2DistanceJoint.prototype.m_rA=null;box2d.b2DistanceJoint.prototype.m_rB=null;box2d.b2DistanceJoint.prototype.m_localCenterA=null;box2d.b2DistanceJoint.prototype.m_localCenterB=null;box2d.b2DistanceJoint.prototype.m_invMassA=0;box2d.b2DistanceJoint.prototype.m_invMassB=0;box2d.b2DistanceJoint.prototype.m_invIA=0;box2d.b2DistanceJoint.prototype.m_invIB=0;box2d.b2DistanceJoint.prototype.m_mass=0;
box2d.b2DistanceJoint.prototype.m_qA=null;box2d.b2DistanceJoint.prototype.m_qB=null;box2d.b2DistanceJoint.prototype.m_lalcA=null;box2d.b2DistanceJoint.prototype.m_lalcB=null;box2d.b2DistanceJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};box2d.b2DistanceJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};
box2d.b2DistanceJoint.prototype.GetReactionForce=function(a,b){return b.SetXY(a*this.m_impulse*this.m_u.x,a*this.m_impulse*this.m_u.y)};box2d.b2DistanceJoint.prototype.GetReactionTorque=function(a){return 0};box2d.b2DistanceJoint.prototype.GetLocalAnchorA=function(a){return a.Copy(this.m_localAnchorA)};box2d.b2DistanceJoint.prototype.GetLocalAnchorB=function(a){return a.Copy(this.m_localAnchorB)};box2d.b2DistanceJoint.prototype.SetLength=function(a){this.m_length=a};
box2d.b2DistanceJoint.prototype.GetLength=function(){return this.m_length};box2d.b2DistanceJoint.prototype.SetFrequency=function(a){this.m_frequencyHz=a};box2d.b2DistanceJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};box2d.b2DistanceJoint.prototype.SetDampingRatio=function(a){this.m_dampingRatio=a};box2d.b2DistanceJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};
box2d.b2DistanceJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2DistanceJointDef*/ var jd = new box2d.b2DistanceJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",
this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.length = %.15f;\n",this.m_length);box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz);box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};
box2d.b2DistanceJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexA].c,c=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,
e=a.positions[this.m_indexB].c,f=a.positions[this.m_indexB].a,g=a.velocities[this.m_indexB].v,h=a.velocities[this.m_indexB].w,k=this.m_qA.SetAngleRadians(a.positions[this.m_indexA].a);f=this.m_qB.SetAngleRadians(f);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2MulRV(k,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2MulRV(f,this.m_lalcB,this.m_rB);this.m_u.x=e.x+this.m_rB.x-b.x-this.m_rA.x;this.m_u.y=e.y+this.m_rB.y-
b.y-this.m_rA.y;e=this.m_u.GetLength();e>box2d.b2_linearSlop?this.m_u.SelfMul(1/e):this.m_u.SetZero();b=box2d.b2CrossVV(this.m_rA,this.m_u);k=box2d.b2CrossVV(this.m_rB,this.m_u);b=this.m_invMassA+this.m_invIA*b*b+this.m_invMassB+this.m_invIB*k*k;this.m_mass=0!==b?1/b:0;if(0<this.m_frequencyHz){e-=this.m_length;k=2*box2d.b2_pi*this.m_frequencyHz;f=this.m_mass*k*k;var l=a.step.dt;this.m_gamma=l*(2*this.m_mass*this.m_dampingRatio*k+l*f);this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0;this.m_bias=e*l*
f*this.m_gamma;b+=this.m_gamma;this.m_mass=0!==b?1/b:0}else this.m_bias=this.m_gamma=0;a.step.warmStarting?(this.m_impulse*=a.step.dtRatio,b=box2d.b2MulSV(this.m_impulse,this.m_u,box2d.b2DistanceJoint.prototype.InitVelocityConstraints.s_P),c.SelfMulSub(this.m_invMassA,b),d-=this.m_invIA*box2d.b2CrossVV(this.m_rA,b),g.SelfMulAdd(this.m_invMassB,b),h+=this.m_invIB*box2d.b2CrossVV(this.m_rB,b)):this.m_impulse=0;a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=h};
box2d.b2DistanceJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2DistanceJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,c=a.velocities[this.m_indexA].w,d=a.velocities[this.m_indexB].v,e=a.velocities[this.m_indexB].w,f=box2d.b2AddVCrossSV(b,c,this.m_rA,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpA),g=box2d.b2AddVCrossSV(d,e,this.m_rB,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpB);f=box2d.b2DotVV(this.m_u,box2d.b2SubVV(g,f,box2d.b2Vec2.s_t0));f=-this.m_mass*(f+this.m_bias+this.m_gamma*
this.m_impulse);this.m_impulse+=f;f=box2d.b2MulSV(f,this.m_u,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_P);b.SelfMulSub(this.m_invMassA,f);c-=this.m_invIA*box2d.b2CrossVV(this.m_rA,f);d.SelfMulAdd(this.m_invMassB,f);e+=this.m_invIB*box2d.b2CrossVV(this.m_rB,f);a.velocities[this.m_indexA].w=c;a.velocities[this.m_indexB].w=e};box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2;box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2;
box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2DistanceJoint.prototype.SolvePositionConstraints=function(a){if(0<this.m_frequencyHz)return!0;var b=a.positions[this.m_indexA].c,c=a.positions[this.m_indexA].a,d=a.positions[this.m_indexB].c,e=a.positions[this.m_indexB].a;this.m_qA.SetAngleRadians(c);this.m_qB.SetAngleRadians(e);var f=box2d.b2MulRV(this.m_qA,this.m_lalcA,this.m_rA),g=box2d.b2MulRV(this.m_qB,this.m_lalcB,this.m_rB),h=this.m_u;h.x=d.x+g.x-b.x-f.x;h.y=d.y+g.y-b.y-f.y;var k=this.m_u.Normalize()-this.m_length;k=box2d.b2Clamp(k,
-box2d.b2_maxLinearCorrection,box2d.b2_maxLinearCorrection);h=box2d.b2MulSV(-this.m_mass*k,h,box2d.b2DistanceJoint.prototype.SolvePositionConstraints.s_P);b.SelfMulSub(this.m_invMassA,h);c-=this.m_invIA*box2d.b2CrossVV(f,h);d.SelfMulAdd(this.m_invMassB,h);e+=this.m_invIB*box2d.b2CrossVV(g,h);a.positions[this.m_indexA].a=c;a.positions[this.m_indexB].a=e;return box2d.b2Abs(k)<box2d.b2_linearSlop};box2d.b2DistanceJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;
box2d.b2FrictionJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_frictionJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2};goog.inherits(box2d.b2FrictionJointDef,box2d.b2JointDef);box2d.b2FrictionJointDef.prototype.localAnchorA=null;box2d.b2FrictionJointDef.prototype.localAnchorB=null;box2d.b2FrictionJointDef.prototype.maxForce=0;box2d.b2FrictionJointDef.prototype.maxTorque=0;
box2d.b2FrictionJointDef.prototype.Initialize=function(a,b,c){this.bodyA=a;this.bodyB=b;this.bodyA.GetLocalPoint(c,this.localAnchorA);this.bodyB.GetLocalPoint(c,this.localAnchorB)};
box2d.b2FrictionJoint=function(a){box2d.b2Joint.call(this,a);this.m_localAnchorA=a.localAnchorA.Clone();this.m_localAnchorB=a.localAnchorB.Clone();this.m_linearImpulse=(new box2d.b2Vec2).SetZero();this.m_maxForce=a.maxForce;this.m_maxTorque=a.maxTorque;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_linearMass=(new box2d.b2Mat22).SetZero();this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;
this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat22};goog.inherits(box2d.b2FrictionJoint,box2d.b2Joint);box2d.b2FrictionJoint.prototype.m_localAnchorA=null;box2d.b2FrictionJoint.prototype.m_localAnchorB=null;box2d.b2FrictionJoint.prototype.m_linearImpulse=null;box2d.b2FrictionJoint.prototype.m_angularImpulse=0;box2d.b2FrictionJoint.prototype.m_maxForce=0;box2d.b2FrictionJoint.prototype.m_maxTorque=0;box2d.b2FrictionJoint.prototype.m_indexA=0;box2d.b2FrictionJoint.prototype.m_indexB=0;
box2d.b2FrictionJoint.prototype.m_rA=null;box2d.b2FrictionJoint.prototype.m_rB=null;box2d.b2FrictionJoint.prototype.m_localCenterA=null;box2d.b2FrictionJoint.prototype.m_localCenterB=null;box2d.b2FrictionJoint.prototype.m_invMassA=0;box2d.b2FrictionJoint.prototype.m_invMassB=0;box2d.b2FrictionJoint.prototype.m_invIA=0;box2d.b2FrictionJoint.prototype.m_invIB=0;box2d.b2FrictionJoint.prototype.m_linearMass=null;box2d.b2FrictionJoint.prototype.m_angularMass=0;box2d.b2FrictionJoint.prototype.m_qA=null;
box2d.b2FrictionJoint.prototype.m_qB=null;box2d.b2FrictionJoint.prototype.m_lalcA=null;box2d.b2FrictionJoint.prototype.m_lalcB=null;box2d.b2FrictionJoint.prototype.m_K=null;
box2d.b2FrictionJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.velocities[this.m_indexA].v,c=a.velocities[this.m_indexA].w,d=a.positions[this.m_indexB].a,
e=a.velocities[this.m_indexB].v,f=a.velocities[this.m_indexB].w,g=this.m_qA.SetAngleRadians(a.positions[this.m_indexA].a);d=this.m_qB.SetAngleRadians(d);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);g=box2d.b2MulRV(g,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var h=box2d.b2MulRV(d,this.m_lalcB,this.m_rB);d=this.m_invMassA;var k=this.m_invMassB,l=this.m_invIA,m=this.m_invIB,n=this.m_K;n.ex.x=d+k+l*g.y*g.y+m*h.y*h.y;n.ex.y=-l*g.x*
g.y-m*h.x*h.y;n.ey.x=n.ex.y;n.ey.y=d+k+l*g.x*g.x+m*h.x*h.x;n.GetInverse(this.m_linearMass);this.m_angularMass=l+m;0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass);a.step.warmStarting?(this.m_linearImpulse.SelfMul(a.step.dtRatio),this.m_angularImpulse*=a.step.dtRatio,g=this.m_linearImpulse,b.SelfMulSub(d,g),c-=l*(box2d.b2CrossVV(this.m_rA,g)+this.m_angularImpulse),e.SelfMulAdd(k,g),f+=m*(box2d.b2CrossVV(this.m_rB,g)+this.m_angularImpulse)):(this.m_linearImpulse.SetZero(),this.m_angularImpulse=
0);a.velocities[this.m_indexA].w=c;a.velocities[this.m_indexB].w=f};
box2d.b2FrictionJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,c=a.velocities[this.m_indexA].w,d=a.velocities[this.m_indexB].v,e=a.velocities[this.m_indexB].w,f=this.m_invMassA,g=this.m_invMassB,h=this.m_invIA,k=this.m_invIB,l=a.step.dt,m=-this.m_angularMass*(e-c),n=this.m_angularImpulse;var p=l*this.m_maxTorque;this.m_angularImpulse=box2d.b2Clamp(this.m_angularImpulse+m,-p,p);m=this.m_angularImpulse-n;c-=h*m;e+=k*m;p=box2d.b2SubVV(box2d.b2AddVCrossSV(d,e,
this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(b,c,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_Cdot);m=box2d.b2MulMV(this.m_linearMass,p,box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_impulseV).SelfNeg();n=box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_oldImpulseV.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(m);p=l*this.m_maxForce;this.m_linearImpulse.GetLengthSquared()>p*p&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(p));
box2d.b2SubVV(this.m_linearImpulse,n,m);b.SelfMulSub(f,m);c-=h*box2d.b2CrossVV(this.m_rA,m);d.SelfMulAdd(g,m);e+=k*box2d.b2CrossVV(this.m_rB,m);a.velocities[this.m_indexA].w=c;a.velocities[this.m_indexB].w=e};box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_impulseV=new box2d.b2Vec2;box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_oldImpulseV=new box2d.b2Vec2;
box2d.b2FrictionJoint.prototype.SolvePositionConstraints=function(a){return!0};box2d.b2FrictionJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};box2d.b2FrictionJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};box2d.b2FrictionJoint.prototype.GetReactionForce=function(a,b){return b.SetXY(a*this.m_linearImpulse.x,a*this.m_linearImpulse.y)};
box2d.b2FrictionJoint.prototype.GetReactionTorque=function(a){return a*this.m_angularImpulse};box2d.b2FrictionJoint.prototype.GetLocalAnchorA=function(a){return a.Copy(this.m_localAnchorA)};box2d.b2FrictionJoint.prototype.GetLocalAnchorB=function(a){return a.Copy(this.m_localAnchorB)};box2d.b2FrictionJoint.prototype.SetMaxForce=function(a){this.m_maxForce=a};box2d.b2FrictionJoint.prototype.GetMaxForce=function(){return this.m_maxForce};
box2d.b2FrictionJoint.prototype.SetMaxTorque=function(a){this.m_maxTorque=a};box2d.b2FrictionJoint.prototype.GetMaxTorque=function(){return this.m_maxTorque};
box2d.b2FrictionJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2FrictionJointDef*/ var jd = new box2d.b2FrictionJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",
this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.maxForce = %.15f;\n",this.m_maxForce);box2d.b2Log("  jd.maxTorque = %.15f;\n",this.m_maxTorque);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};box2d.b2MouseJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_mouseJoint);this.target=new box2d.b2Vec2};goog.inherits(box2d.b2MouseJointDef,box2d.b2JointDef);box2d.b2MouseJointDef.prototype.target=null;box2d.b2MouseJointDef.prototype.maxForce=0;
box2d.b2MouseJointDef.prototype.frequencyHz=5;box2d.b2MouseJointDef.prototype.dampingRatio=.7;
box2d.b2MouseJoint=function(a){box2d.b2Joint.call(this,a);this.m_localAnchorB=new box2d.b2Vec2;this.m_targetA=new box2d.b2Vec2;this.m_impulse=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_mass=new box2d.b2Mat22;this.m_C=new box2d.b2Vec2;this.m_qB=new box2d.b2Rot;this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat22;box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.target.IsValid());box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a.maxForce)&&0<=a.maxForce);box2d.ENABLE_ASSERTS&&
box2d.b2Assert(box2d.b2IsValid(a.frequencyHz)&&0<=a.frequencyHz);box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a.dampingRatio)&&0<=a.dampingRatio);this.m_targetA.Copy(a.target);box2d.b2MulTXV(this.m_bodyB.GetTransform(),this.m_targetA,this.m_localAnchorB);this.m_maxForce=a.maxForce;this.m_impulse.SetZero();this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_gamma=this.m_beta=0};goog.inherits(box2d.b2MouseJoint,box2d.b2Joint);
box2d.b2MouseJoint.prototype.m_localAnchorB=null;box2d.b2MouseJoint.prototype.m_targetA=null;box2d.b2MouseJoint.prototype.m_frequencyHz=0;box2d.b2MouseJoint.prototype.m_dampingRatio=0;box2d.b2MouseJoint.prototype.m_beta=0;box2d.b2MouseJoint.prototype.m_impulse=null;box2d.b2MouseJoint.prototype.m_maxForce=0;box2d.b2MouseJoint.prototype.m_gamma=0;box2d.b2MouseJoint.prototype.m_indexA=0;box2d.b2MouseJoint.prototype.m_indexB=0;box2d.b2MouseJoint.prototype.m_rB=null;
box2d.b2MouseJoint.prototype.m_localCenterB=null;box2d.b2MouseJoint.prototype.m_invMassB=0;box2d.b2MouseJoint.prototype.m_invIB=0;box2d.b2MouseJoint.prototype.m_mass=null;box2d.b2MouseJoint.prototype.m_C=null;box2d.b2MouseJoint.prototype.m_qB=null;box2d.b2MouseJoint.prototype.m_lalcB=null;box2d.b2MouseJoint.prototype.m_K=null;box2d.b2MouseJoint.prototype.SetTarget=function(a){!1===this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0);this.m_targetA.Copy(a)};box2d.b2MouseJoint.prototype.GetTarget=function(a){return a.Copy(this.m_targetA)};
box2d.b2MouseJoint.prototype.SetMaxForce=function(a){this.m_maxForce=a};box2d.b2MouseJoint.prototype.GetMaxForce=function(){return this.m_maxForce};box2d.b2MouseJoint.prototype.SetFrequency=function(a){this.m_frequencyHz=a};box2d.b2MouseJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};box2d.b2MouseJoint.prototype.SetDampingRatio=function(a){this.m_dampingRatio=a};box2d.b2MouseJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};
box2d.b2MouseJoint.prototype.InitVelocityConstraints=function(a){this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexB].c,c=a.velocities[this.m_indexB].v,d=a.velocities[this.m_indexB].w,e=this.m_qB.SetAngleRadians(a.positions[this.m_indexB].a),f=this.m_bodyB.GetMass(),g=2*box2d.b2_pi*this.m_frequencyHz,h=2*f*this.m_dampingRatio*g;f*=g*g;g=a.step.dt;
box2d.ENABLE_ASSERTS&&box2d.b2Assert(h+g*f>box2d.b2_epsilon);this.m_gamma=g*(h+g*f);0!==this.m_gamma&&(this.m_gamma=1/this.m_gamma);this.m_beta=g*f*this.m_gamma;box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2MulRV(e,this.m_lalcB,this.m_rB);e=this.m_K;e.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma;e.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y;e.ey.x=e.ex.y;e.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma;e.GetInverse(this.m_mass);
this.m_C.x=b.x+this.m_rB.x-this.m_targetA.x;this.m_C.y=b.y+this.m_rB.y-this.m_targetA.y;this.m_C.SelfMul(this.m_beta);d*=.98;a.step.warmStarting?(this.m_impulse.SelfMul(a.step.dtRatio),c.x+=this.m_invMassB*this.m_impulse.x,c.y+=this.m_invMassB*this.m_impulse.y,d+=this.m_invIB*box2d.b2CrossVV(this.m_rB,this.m_impulse)):this.m_impulse.SetZero();a.velocities[this.m_indexB].w=d};
box2d.b2MouseJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexB].v,c=a.velocities[this.m_indexB].w,d=box2d.b2AddVCrossSV(b,c,this.m_rB,box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_Cdot);d=box2d.b2MulMV(this.m_mass,box2d.b2AddVV(d,box2d.b2AddVV(this.m_C,box2d.b2MulSV(this.m_gamma,this.m_impulse,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0).SelfNeg(),box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_impulse);var e=box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_oldImpulse.Copy(this.m_impulse);
this.m_impulse.SelfAdd(d);var f=a.step.dt*this.m_maxForce;this.m_impulse.GetLengthSquared()>f*f&&this.m_impulse.SelfMul(f/this.m_impulse.GetLength());box2d.b2SubVV(this.m_impulse,e,d);b.SelfMulAdd(this.m_invMassB,d);c+=this.m_invIB*box2d.b2CrossVV(this.m_rB,d);a.velocities[this.m_indexB].w=c};box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec2;
box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_oldImpulse=new box2d.b2Vec2;box2d.b2MouseJoint.prototype.SolvePositionConstraints=function(a){return!0};box2d.b2MouseJoint.prototype.GetAnchorA=function(a){return a.Copy(this.m_targetA)};box2d.b2MouseJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};box2d.b2MouseJoint.prototype.GetReactionForce=function(a,b){return box2d.b2MulSV(a,this.m_impulse,b)};
box2d.b2MouseJoint.prototype.GetReactionTorque=function(a){return 0};box2d.b2MouseJoint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("Mouse joint dumping is not supported.\n")};box2d.b2MouseJoint.prototype.ShiftOrigin=function(a){this.m_targetA.SelfSub(a)};box2d.b2ConstantForceController=function(){box2d.b2Controller.call(this);this.F=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2ConstantForceController,box2d.b2Controller);box2d.b2ConstantAccelController.prototype.F=null;
box2d.b2ConstantForceController.prototype.Step=function(a){for(a=this.m_bodyList;a;a=a.nextBody){var b=a.body;b.IsAwake()&&b.ApplyForce(this.F,b.GetWorldCenter())}};box2d.b2_minPulleyLength=2;box2d.b2PulleyJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_pulleyJoint);this.collideConnected=!0;this.groundAnchorA=new box2d.b2Vec2(-1,1);this.groundAnchorB=new box2d.b2Vec2(1,1);this.localAnchorA=new box2d.b2Vec2(-1,0);this.localAnchorB=new box2d.b2Vec2(1,0)};
goog.inherits(box2d.b2PulleyJointDef,box2d.b2JointDef);box2d.b2PulleyJointDef.prototype.groundAnchorA=null;box2d.b2PulleyJointDef.prototype.groundAnchorB=null;box2d.b2PulleyJointDef.prototype.localAnchorA=null;box2d.b2PulleyJointDef.prototype.localAnchorB=null;box2d.b2PulleyJointDef.prototype.lengthA=0;box2d.b2PulleyJointDef.prototype.lengthB=0;box2d.b2PulleyJointDef.prototype.ratio=1;
box2d.b2PulleyJointDef.prototype.Initialize=function(a,b,c,d,e,f,g){this.bodyA=a;this.bodyB=b;this.groundAnchorA.Copy(c);this.groundAnchorB.Copy(d);this.bodyA.GetLocalPoint(e,this.localAnchorA);this.bodyB.GetLocalPoint(f,this.localAnchorB);this.lengthA=box2d.b2DistanceVV(e,c);this.lengthB=box2d.b2DistanceVV(f,d);this.ratio=g;box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.ratio>box2d.b2_epsilon)};
box2d.b2PulleyJoint=function(a){box2d.b2Joint.call(this,a);this.m_groundAnchorA=new box2d.b2Vec2;this.m_groundAnchorB=new box2d.b2Vec2;this.m_localAnchorA=new box2d.b2Vec2;this.m_localAnchorB=new box2d.b2Vec2;this.m_uA=new box2d.b2Vec2;this.m_uB=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;
this.m_groundAnchorA.Copy(a.groundAnchorA);this.m_groundAnchorB.Copy(a.groundAnchorB);this.m_localAnchorA.Copy(a.localAnchorA);this.m_localAnchorB.Copy(a.localAnchorB);this.m_lengthA=a.lengthA;this.m_lengthB=a.lengthB;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0!==a.ratio);this.m_ratio=a.ratio;this.m_constant=a.lengthA+this.m_ratio*a.lengthB;this.m_impulse=0};goog.inherits(box2d.b2PulleyJoint,box2d.b2Joint);box2d.b2PulleyJoint.prototype.m_groundAnchorA=null;
box2d.b2PulleyJoint.prototype.m_groundAnchorB=null;box2d.b2PulleyJoint.prototype.m_lengthA=0;box2d.b2PulleyJoint.prototype.m_lengthB=0;box2d.b2PulleyJoint.prototype.m_localAnchorA=null;box2d.b2PulleyJoint.prototype.m_localAnchorB=null;box2d.b2PulleyJoint.prototype.m_constant=0;box2d.b2PulleyJoint.prototype.m_ratio=0;box2d.b2PulleyJoint.prototype.m_impulse=0;box2d.b2PulleyJoint.prototype.m_indexA=0;box2d.b2PulleyJoint.prototype.m_indexB=0;box2d.b2PulleyJoint.prototype.m_uA=null;
box2d.b2PulleyJoint.prototype.m_uB=null;box2d.b2PulleyJoint.prototype.m_rA=null;box2d.b2PulleyJoint.prototype.m_rB=null;box2d.b2PulleyJoint.prototype.m_localCenterA=null;box2d.b2PulleyJoint.prototype.m_localCenterB=null;box2d.b2PulleyJoint.prototype.m_invMassA=0;box2d.b2PulleyJoint.prototype.m_invMassB=0;box2d.b2PulleyJoint.prototype.m_invIA=0;box2d.b2PulleyJoint.prototype.m_invIB=0;box2d.b2PulleyJoint.prototype.m_mass=0;box2d.b2PulleyJoint.prototype.m_qA=null;box2d.b2PulleyJoint.prototype.m_qB=null;
box2d.b2PulleyJoint.prototype.m_lalcA=null;box2d.b2PulleyJoint.prototype.m_lalcB=null;
box2d.b2PulleyJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexA].c,c=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,
e=a.positions[this.m_indexB].c,f=a.positions[this.m_indexB].a,g=a.velocities[this.m_indexB].v,h=a.velocities[this.m_indexB].w,k=this.m_qA.SetAngleRadians(a.positions[this.m_indexA].a);f=this.m_qB.SetAngleRadians(f);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2MulRV(k,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2MulRV(f,this.m_lalcB,this.m_rB);this.m_uA.Copy(b).SelfAdd(this.m_rA).SelfSub(this.m_groundAnchorA);this.m_uB.Copy(e).SelfAdd(this.m_rB).SelfSub(this.m_groundAnchorB);
b=this.m_uA.GetLength();e=this.m_uB.GetLength();b>10*box2d.b2_linearSlop?this.m_uA.SelfMul(1/b):this.m_uA.SetZero();e>10*box2d.b2_linearSlop?this.m_uB.SelfMul(1/e):this.m_uB.SetZero();b=box2d.b2CrossVV(this.m_rA,this.m_uA);e=box2d.b2CrossVV(this.m_rB,this.m_uB);this.m_mass=this.m_invMassA+this.m_invIA*b*b+this.m_ratio*this.m_ratio*(this.m_invMassB+this.m_invIB*e*e);0<this.m_mass&&(this.m_mass=1/this.m_mass);a.step.warmStarting?(this.m_impulse*=a.step.dtRatio,b=box2d.b2MulSV(-this.m_impulse,this.m_uA,
box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PA),e=box2d.b2MulSV(-this.m_ratio*this.m_impulse,this.m_uB,box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PB),c.SelfMulAdd(this.m_invMassA,b),d+=this.m_invIA*box2d.b2CrossVV(this.m_rA,b),g.SelfMulAdd(this.m_invMassB,e),h+=this.m_invIB*box2d.b2CrossVV(this.m_rB,e)):this.m_impulse=0;a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=h};box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PA=new box2d.b2Vec2;
box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PB=new box2d.b2Vec2;
box2d.b2PulleyJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,c=a.velocities[this.m_indexA].w,d=a.velocities[this.m_indexB].v,e=a.velocities[this.m_indexB].w,f=box2d.b2AddVCrossSV(b,c,this.m_rA,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpA),g=box2d.b2AddVCrossSV(d,e,this.m_rB,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpB);f=-box2d.b2DotVV(this.m_uA,f)-this.m_ratio*box2d.b2DotVV(this.m_uB,g);g=-this.m_mass*f;this.m_impulse+=g;f=
box2d.b2MulSV(-g,this.m_uA,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PA);g=box2d.b2MulSV(-this.m_ratio*g,this.m_uB,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PB);b.SelfMulAdd(this.m_invMassA,f);c+=this.m_invIA*box2d.b2CrossVV(this.m_rA,f);d.SelfMulAdd(this.m_invMassB,g);e+=this.m_invIB*box2d.b2CrossVV(this.m_rB,g);a.velocities[this.m_indexA].w=c;a.velocities[this.m_indexB].w=e};box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2;
box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PA=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PB=new box2d.b2Vec2;
box2d.b2PulleyJoint.prototype.SolvePositionConstraints=function(a){var b=a.positions[this.m_indexA].c,c=a.positions[this.m_indexA].a,d=a.positions[this.m_indexB].c,e=a.positions[this.m_indexB].a,f=this.m_qA.SetAngleRadians(c),g=this.m_qB.SetAngleRadians(e);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);f=box2d.b2MulRV(f,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);g=box2d.b2MulRV(g,this.m_lalcB,this.m_rB);var h=this.m_uA.Copy(b).SelfAdd(f).SelfSub(this.m_groundAnchorA),
k=this.m_uB.Copy(d).SelfAdd(g).SelfSub(this.m_groundAnchorB),l=h.GetLength(),m=k.GetLength();l>10*box2d.b2_linearSlop?h.SelfMul(1/l):h.SetZero();m>10*box2d.b2_linearSlop?k.SelfMul(1/m):k.SetZero();var n=box2d.b2CrossVV(f,h),p=box2d.b2CrossVV(g,k);n=this.m_invMassA+this.m_invIA*n*n+this.m_ratio*this.m_ratio*(this.m_invMassB+this.m_invIB*p*p);0<n&&(n=1/n);m=this.m_constant-l-this.m_ratio*m;l=box2d.b2Abs(m);m*=-n;h=box2d.b2MulSV(-m,h,box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PA);k=box2d.b2MulSV(-this.m_ratio*
m,k,box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PB);b.SelfMulAdd(this.m_invMassA,h);c+=this.m_invIA*box2d.b2CrossVV(f,h);d.SelfMulAdd(this.m_invMassB,k);e+=this.m_invIB*box2d.b2CrossVV(g,k);a.positions[this.m_indexA].a=c;a.positions[this.m_indexB].a=e;return l<box2d.b2_linearSlop};box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PA=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PB=new box2d.b2Vec2;
box2d.b2PulleyJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};box2d.b2PulleyJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};box2d.b2PulleyJoint.prototype.GetReactionForce=function(a,b){return b.SetXY(a*this.m_impulse*this.m_uB.x,a*this.m_impulse*this.m_uB.y)};box2d.b2PulleyJoint.prototype.GetReactionTorque=function(a){return 0};box2d.b2PulleyJoint.prototype.GetGroundAnchorA=function(a){return a.Copy(this.m_groundAnchorA)};
box2d.b2PulleyJoint.prototype.GetGroundAnchorB=function(a){return a.Copy(this.m_groundAnchorB)};box2d.b2PulleyJoint.prototype.GetLengthA=function(){return this.m_lengthA};box2d.b2PulleyJoint.prototype.GetLengthB=function(){return this.m_lengthB};box2d.b2PulleyJoint.prototype.GetRatio=function(){return this.m_ratio};
box2d.b2PulleyJoint.prototype.GetCurrentLengthA=function(){var a=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,box2d.b2PulleyJoint.prototype.GetCurrentLengthA.s_p);return box2d.b2DistanceVV(a,this.m_groundAnchorA)};box2d.b2PulleyJoint.prototype.GetCurrentLengthA.s_p=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.GetCurrentLengthB=function(){var a=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,box2d.b2PulleyJoint.prototype.GetCurrentLengthB.s_p);return box2d.b2DistanceVV(a,this.m_groundAnchorB)};
box2d.b2PulleyJoint.prototype.GetCurrentLengthB.s_p=new box2d.b2Vec2;
box2d.b2PulleyJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2PulleyJointDef*/ var jd = new box2d.b2PulleyJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.groundAnchorA.SetXY(%.15f, %.15f);\n",this.m_groundAnchorA.x,this.m_groundAnchorA.y);box2d.b2Log("  jd.groundAnchorB.SetXY(%.15f, %.15f);\n",
this.m_groundAnchorB.x,this.m_groundAnchorB.y);box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.lengthA = %.15f;\n",this.m_lengthA);box2d.b2Log("  jd.lengthB = %.15f;\n",this.m_lengthB);box2d.b2Log("  jd.ratio = %.15f;\n",this.m_ratio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};
box2d.b2PulleyJoint.prototype.ShiftOrigin=function(a){this.m_groundAnchorA.SelfSub(a);this.m_groundAnchorB.SelfSub(a)};box2d.b2CircleShape=function(a){box2d.b2Shape.call(this,box2d.b2ShapeType.e_circleShape,a||0);this.m_p=new box2d.b2Vec2};goog.inherits(box2d.b2CircleShape,box2d.b2Shape);box2d.b2CircleShape.prototype.m_p=null;box2d.b2CircleShape.prototype.Clone=function(){return(new box2d.b2CircleShape).Copy(this)};
box2d.b2CircleShape.prototype.Copy=function(a){box2d.b2CircleShape.superClass_.Copy.call(this,a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2CircleShape);this.m_p.Copy(a.m_p);return this};box2d.b2CircleShape.prototype.GetChildCount=function(){return 1};box2d.b2CircleShape.prototype.TestPoint=function(a,b){var c=box2d.b2MulXV(a,this.m_p,box2d.b2CircleShape.prototype.TestPoint.s_center);c=box2d.b2SubVV(b,c,box2d.b2CircleShape.prototype.TestPoint.s_d);return box2d.b2DotVV(c,c)<=box2d.b2Sq(this.m_radius)};
box2d.b2CircleShape.prototype.TestPoint.s_center=new box2d.b2Vec2;box2d.b2CircleShape.prototype.TestPoint.s_d=new box2d.b2Vec2;
box2d.b2CircleShape.prototype.RayCast=function(a,b,c,d){c=box2d.b2MulXV(c,this.m_p,box2d.b2CircleShape.prototype.RayCast.s_position);c=box2d.b2SubVV(b.p1,c,box2d.b2CircleShape.prototype.RayCast.s_s);var e=box2d.b2DotVV(c,c)-box2d.b2Sq(this.m_radius);d=box2d.b2SubVV(b.p2,b.p1,box2d.b2CircleShape.prototype.RayCast.s_r);var f=box2d.b2DotVV(c,d),g=box2d.b2DotVV(d,d);e=f*f-g*e;if(0>e||g<box2d.b2_epsilon)return!1;f=-(f+box2d.b2Sqrt(e));return 0<=f&&f<=b.maxFraction*g?(f/=g,a.fraction=f,box2d.b2AddVMulSV(c,
f,d,a.normal).SelfNormalize(),!0):!1};box2d.b2CircleShape.prototype.RayCast.s_position=new box2d.b2Vec2;box2d.b2CircleShape.prototype.RayCast.s_s=new box2d.b2Vec2;box2d.b2CircleShape.prototype.RayCast.s_r=new box2d.b2Vec2;box2d.b2CircleShape.prototype.ComputeAABB=function(a,b,c){b=box2d.b2MulXV(b,this.m_p,box2d.b2CircleShape.prototype.ComputeAABB.s_p);a.lowerBound.SetXY(b.x-this.m_radius,b.y-this.m_radius);a.upperBound.SetXY(b.x+this.m_radius,b.y+this.m_radius)};
box2d.b2CircleShape.prototype.ComputeAABB.s_p=new box2d.b2Vec2;box2d.b2CircleShape.prototype.ComputeMass=function(a,b){var c=box2d.b2Sq(this.m_radius);a.mass=b*box2d.b2_pi*c;a.center.Copy(this.m_p);a.I=a.mass*(.5*c+box2d.b2DotVV(this.m_p,this.m_p))};box2d.b2CircleShape.prototype.SetupDistanceProxy=function(a,b){a.m_vertices=[1,!0];a.m_vertices[0]=this.m_p;a.m_count=1;a.m_radius=this.m_radius};
box2d.b2CircleShape.prototype.ComputeSubmergedArea=function(a,b,c,d){c=box2d.b2MulXV(c,this.m_p,new box2d.b2Vec2);var e=-(box2d.b2DotVV(a,c)-b);if(e<-this.m_radius+box2d.b2_epsilon)return 0;if(e>this.m_radius)return d.Copy(c),box2d.b2_pi*this.m_radius*this.m_radius;b=this.m_radius*this.m_radius;var f=e*e;e=b*(box2d.b2Asin(e/this.m_radius)+box2d.b2_pi/2)+e*box2d.b2Sqrt(b-f);b=-2/3*box2d.b2Pow(b-f,1.5)/e;d.x=c.x+a.x*b;d.y=c.y+a.y*b;return e};
box2d.b2CircleShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2CircleShape*/ var shape = new box2d.b2CircleShape();\n");box2d.b2Log("    shape.m_radius = %.15f;\n",this.m_radius);box2d.b2Log("    shape.m_p.SetXY(%.15f, %.15f);\n",this.m_p.x,this.m_p.y)};box2d.b2RopeDef=function(){this.vertices=[];this.masses=[];this.gravity=new box2d.b2Vec2};box2d.b2RopeDef.prototype.vertices=null;box2d.b2RopeDef.prototype.count=0;box2d.b2RopeDef.prototype.masses=null;box2d.b2RopeDef.prototype.gravity=null;
box2d.b2RopeDef.prototype.damping=.1;box2d.b2RopeDef.prototype.k2=.9;box2d.b2RopeDef.prototype.k3=.1;box2d.b2Rope=function(){this.m_gravity=new box2d.b2Vec2};box2d.b2Rope.prototype.m_count=0;box2d.b2Rope.prototype.m_ps=null;box2d.b2Rope.prototype.m_p0s=null;box2d.b2Rope.prototype.m_vs=null;box2d.b2Rope.prototype.m_ims=null;box2d.b2Rope.prototype.m_Ls=null;box2d.b2Rope.prototype.m_as=null;box2d.b2Rope.prototype.m_gravity=null;box2d.b2Rope.prototype.m_damping=0;box2d.b2Rope.prototype.m_k2=1;
box2d.b2Rope.prototype.m_k3=.1;box2d.b2Rope.prototype.GetVertexCount=function(){return this.m_count};box2d.b2Rope.prototype.GetVertices=function(){return this.m_ps};
box2d.b2Rope.prototype.Initialize=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=a.count);this.m_count=a.count;this.m_ps=box2d.b2Vec2.MakeArray(this.m_count);this.m_p0s=box2d.b2Vec2.MakeArray(this.m_count);this.m_vs=box2d.b2Vec2.MakeArray(this.m_count);this.m_ims=box2d.b2MakeNumberArray(this.m_count);for(var b=0;b<this.m_count;++b){this.m_ps[b].Copy(a.vertices[b]);this.m_p0s[b].Copy(a.vertices[b]);this.m_vs[b].SetZero();var c=a.masses[b];this.m_ims[b]=0<c?1/c:0}var d=this.m_count-1;c=this.m_count-
2;this.m_Ls=box2d.b2MakeNumberArray(d);this.m_as=box2d.b2MakeNumberArray(c);for(b=0;b<d;++b){var e=this.m_ps[b],f=this.m_ps[b+1];this.m_Ls[b]=box2d.b2DistanceVV(e,f)}for(b=0;b<c;++b)e=this.m_ps[b],f=this.m_ps[b+1],d=this.m_ps[b+2],e=box2d.b2SubVV(f,e,box2d.b2Vec2.s_t0),d=box2d.b2SubVV(d,f,box2d.b2Vec2.s_t1),f=box2d.b2CrossVV(e,d),e=box2d.b2DotVV(e,d),this.m_as[b]=box2d.b2Atan2(f,e);this.m_gravity.Copy(a.gravity);this.m_damping=a.damping;this.m_k2=a.k2;this.m_k3=a.k3};
box2d.b2Rope.prototype.Step=function(a,b){if(0!==a){for(var c=Math.exp(-a*this.m_damping),d=0;d<this.m_count;++d)this.m_p0s[d].Copy(this.m_ps[d]),0<this.m_ims[d]&&this.m_vs[d].SelfMulAdd(a,this.m_gravity),this.m_vs[d].SelfMul(c),this.m_ps[d].SelfMulAdd(a,this.m_vs[d]);for(d=0;d<b;++d)this.SolveC2(),this.SolveC3(),this.SolveC2();c=1/a;for(d=0;d<this.m_count;++d)box2d.b2MulSV(c,box2d.b2SubVV(this.m_ps[d],this.m_p0s[d],box2d.b2Vec2.s_t0),this.m_vs[d])}};
box2d.b2Rope.prototype.SolveC2=function(){for(var a=this.m_count-1,b=0;b<a;++b){var c=this.m_ps[b],d=this.m_ps[b+1],e=box2d.b2SubVV(d,c,box2d.b2Rope.s_d),f=e.Normalize(),g=this.m_ims[b],h=this.m_ims[b+1];if(0!==g+h){var k=h/(g+h);c.SelfMulSub(g/(g+h)*this.m_k2*(this.m_Ls[b]-f),e);d.SelfMulAdd(this.m_k2*k*(this.m_Ls[b]-f),e)}}};box2d.b2Rope.s_d=new box2d.b2Vec2;box2d.b2Rope.prototype.SetAngleRadians=function(a){for(var b=this.m_count-2,c=0;c<b;++c)this.m_as[c]=a};
box2d.b2Rope.prototype.SolveC3=function(){for(var a=this.m_count-2,b=0;b<a;++b){var c=this.m_ps[b],d=this.m_ps[b+1],e=this.m_ps[b+2],f=this.m_ims[b],g=this.m_ims[b+1],h=this.m_ims[b+2],k=box2d.b2SubVV(d,c,box2d.b2Rope.s_d1),l=box2d.b2SubVV(e,d,box2d.b2Rope.s_d2),m=k.GetLengthSquared(),n=l.GetLengthSquared();if(0!==m*n){var p=box2d.b2CrossVV(k,l),q=box2d.b2DotVV(k,l);p=box2d.b2Atan2(p,q);k=box2d.b2MulSV(-1/m,k.SelfSkew(),box2d.b2Rope.s_Jd1);m=box2d.b2MulSV(1/n,l.SelfSkew(),box2d.b2Rope.s_Jd2);l=box2d.b2NegV(k,
box2d.b2Rope.s_J1);n=box2d.b2SubVV(k,m,box2d.b2Rope.s_J2);k=m;m=f*box2d.b2DotVV(l,l)+g*box2d.b2DotVV(n,n)+h*box2d.b2DotVV(k,k);if(0!==m){m=1/m;for(q=p-this.m_as[b];q>box2d.b2_pi;)p-=2*box2d.b2_pi,q=p-this.m_as[b];for(;q<-box2d.b2_pi;)p+=2*box2d.b2_pi,q=p-this.m_as[b];p=-this.m_k3*m*q;c.SelfMulAdd(f*p,l);d.SelfMulAdd(g*p,n);e.SelfMulAdd(h*p,k)}}}};box2d.b2Rope.s_d1=new box2d.b2Vec2;box2d.b2Rope.s_d2=new box2d.b2Vec2;box2d.b2Rope.s_Jd1=new box2d.b2Vec2;box2d.b2Rope.s_Jd2=new box2d.b2Vec2;
box2d.b2Rope.s_J1=new box2d.b2Vec2;box2d.b2Rope.s_J2=new box2d.b2Vec2;box2d.b2Rope.prototype.Draw=function(a){for(var b=new box2d.b2Color(.4,.5,.7),c=0;c<this.m_count-1;++c)a.DrawSegment(this.m_ps[c],this.m_ps[c+1],b)};box2d.b2WheelJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_wheelJoint);this.localAnchorA=new box2d.b2Vec2(0,0);this.localAnchorB=new box2d.b2Vec2(0,0);this.localAxisA=new box2d.b2Vec2(1,0)};goog.inherits(box2d.b2WheelJointDef,box2d.b2JointDef);
box2d.b2WheelJointDef.prototype.localAnchorA=null;box2d.b2WheelJointDef.prototype.localAnchorB=null;box2d.b2WheelJointDef.prototype.localAxisA=null;box2d.b2WheelJointDef.prototype.enableMotor=!1;box2d.b2WheelJointDef.prototype.maxMotorTorque=0;box2d.b2WheelJointDef.prototype.motorSpeed=0;box2d.b2WheelJointDef.prototype.frequencyHz=2;box2d.b2WheelJointDef.prototype.dampingRatio=.7;
box2d.b2WheelJointDef.prototype.Initialize=function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.bodyA.GetLocalPoint(c,this.localAnchorA);this.bodyB.GetLocalPoint(c,this.localAnchorB);this.bodyA.GetLocalVector(d,this.localAxisA)};
box2d.b2WheelJoint=function(a){box2d.b2Joint.call(this,a);this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_localAnchorA=a.localAnchorA.Clone();this.m_localAnchorB=a.localAnchorB.Clone();this.m_localXAxisA=a.localAxisA.Clone();this.m_localYAxisA=box2d.b2CrossOneV(this.m_localXAxisA,new box2d.b2Vec2);this.m_maxMotorTorque=a.maxMotorTorque;this.m_motorSpeed=a.motorSpeed;this.m_enableMotor=a.enableMotor;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;
this.m_ax=new box2d.b2Vec2;this.m_ay=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_ax.SetZero();this.m_ay.SetZero()};goog.inherits(box2d.b2WheelJoint,box2d.b2Joint);box2d.b2WheelJoint.prototype.m_frequencyHz=0;box2d.b2WheelJoint.prototype.m_dampingRatio=0;box2d.b2WheelJoint.prototype.m_localAnchorA=null;box2d.b2WheelJoint.prototype.m_localAnchorB=null;
box2d.b2WheelJoint.prototype.m_localXAxisA=null;box2d.b2WheelJoint.prototype.m_localYAxisA=null;box2d.b2WheelJoint.prototype.m_impulse=0;box2d.b2WheelJoint.prototype.m_motorImpulse=0;box2d.b2WheelJoint.prototype.m_springImpulse=0;box2d.b2WheelJoint.prototype.m_maxMotorTorque=0;box2d.b2WheelJoint.prototype.m_motorSpeed=0;box2d.b2WheelJoint.prototype.m_enableMotor=!1;box2d.b2WheelJoint.prototype.m_indexA=0;box2d.b2WheelJoint.prototype.m_indexB=0;box2d.b2WheelJoint.prototype.m_localCenterA=null;
box2d.b2WheelJoint.prototype.m_localCenterB=null;box2d.b2WheelJoint.prototype.m_invMassA=0;box2d.b2WheelJoint.prototype.m_invMassB=0;box2d.b2WheelJoint.prototype.m_invIA=0;box2d.b2WheelJoint.prototype.m_invIB=0;box2d.b2WheelJoint.prototype.m_ax=null;box2d.b2WheelJoint.prototype.m_ay=null;box2d.b2WheelJoint.prototype.m_sAx=0;box2d.b2WheelJoint.prototype.m_sBx=0;box2d.b2WheelJoint.prototype.m_sAy=0;box2d.b2WheelJoint.prototype.m_sBy=0;box2d.b2WheelJoint.prototype.m_mass=0;
box2d.b2WheelJoint.prototype.m_motorMass=0;box2d.b2WheelJoint.prototype.m_springMass=0;box2d.b2WheelJoint.prototype.m_bias=0;box2d.b2WheelJoint.prototype.m_gamma=0;box2d.b2WheelJoint.prototype.m_qA=null;box2d.b2WheelJoint.prototype.m_qB=null;box2d.b2WheelJoint.prototype.m_lalcA=null;box2d.b2WheelJoint.prototype.m_lalcB=null;box2d.b2WheelJoint.prototype.m_rA=null;box2d.b2WheelJoint.prototype.m_rB=null;box2d.b2WheelJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};
box2d.b2WheelJoint.prototype.GetMaxMotorTorque=function(){return this.m_maxMotorTorque};box2d.b2WheelJoint.prototype.SetSpringFrequencyHz=function(a){this.m_frequencyHz=a};box2d.b2WheelJoint.prototype.GetSpringFrequencyHz=function(){return this.m_frequencyHz};box2d.b2WheelJoint.prototype.SetSpringDampingRatio=function(a){this.m_dampingRatio=a};box2d.b2WheelJoint.prototype.GetSpringDampingRatio=function(){return this.m_dampingRatio};
box2d.b2WheelJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=this.m_invMassA,c=this.m_invMassB,d=this.m_invIA,e=this.m_invIB,f=a.positions[this.m_indexA].c,
g=a.velocities[this.m_indexA].v,h=a.velocities[this.m_indexA].w,k=a.positions[this.m_indexB].c,l=a.positions[this.m_indexB].a,m=a.velocities[this.m_indexB].v,n=a.velocities[this.m_indexB].w,p=this.m_qA.SetAngleRadians(a.positions[this.m_indexA].a),q=this.m_qB.SetAngleRadians(l);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);l=box2d.b2MulRV(p,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);q=box2d.b2MulRV(q,this.m_lalcB,this.m_rB);f=
box2d.b2SubVV(box2d.b2AddVV(k,q,box2d.b2Vec2.s_t0),box2d.b2AddVV(f,l,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_d);box2d.b2MulRV(p,this.m_localYAxisA,this.m_ay);this.m_sAy=box2d.b2CrossVV(box2d.b2AddVV(f,l,box2d.b2Vec2.s_t0),this.m_ay);this.m_sBy=box2d.b2CrossVV(q,this.m_ay);this.m_mass=b+c+d*this.m_sAy*this.m_sAy+e*this.m_sBy*this.m_sBy;0<this.m_mass&&(this.m_mass=1/this.m_mass);this.m_gamma=this.m_bias=this.m_springMass=0;0<this.m_frequencyHz?(box2d.b2MulRV(p,this.m_localXAxisA,
this.m_ax),this.m_sAx=box2d.b2CrossVV(box2d.b2AddVV(f,l,box2d.b2Vec2.s_t0),this.m_ax),this.m_sBx=box2d.b2CrossVV(q,this.m_ax),b=b+c+d*this.m_sAx*this.m_sAx+e*this.m_sBx*this.m_sBx,0<b&&(this.m_springMass=1/b,c=box2d.b2DotVV(f,this.m_ax),p=2*box2d.b2_pi*this.m_frequencyHz,f=this.m_springMass*p*p,k=a.step.dt,this.m_gamma=k*(2*this.m_springMass*this.m_dampingRatio*p+k*f),0<this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_bias=c*k*f*this.m_gamma,this.m_springMass=b+this.m_gamma,0<this.m_springMass&&
(this.m_springMass=1/this.m_springMass))):this.m_springImpulse=0;this.m_enableMotor?(this.m_motorMass=d+e,0<this.m_motorMass&&(this.m_motorMass=1/this.m_motorMass)):this.m_motorImpulse=this.m_motorMass=0;a.step.warmStarting?(this.m_impulse*=a.step.dtRatio,this.m_springImpulse*=a.step.dtRatio,this.m_motorImpulse*=a.step.dtRatio,d=box2d.b2AddVV(box2d.b2MulSV(this.m_impulse,this.m_ay,box2d.b2Vec2.s_t0),box2d.b2MulSV(this.m_springImpulse,this.m_ax,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_P),
e=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,b=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse,g.SelfMulSub(this.m_invMassA,d),h-=this.m_invIA*e,m.SelfMulAdd(this.m_invMassB,d),n+=this.m_invIB*b):this.m_motorImpulse=this.m_springImpulse=this.m_impulse=0;a.velocities[this.m_indexA].w=h;a.velocities[this.m_indexB].w=n};box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_d=new box2d.b2Vec2;
box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2WheelJoint.prototype.SolveVelocityConstraints=function(a){var b=this.m_invMassA,c=this.m_invMassB,d=this.m_invIA,e=this.m_invIB,f=a.velocities[this.m_indexA].v,g=a.velocities[this.m_indexA].w,h=a.velocities[this.m_indexB].v,k=a.velocities[this.m_indexB].w,l=box2d.b2DotVV(this.m_ax,box2d.b2SubVV(h,f,box2d.b2Vec2.s_t0))+this.m_sBx*k-this.m_sAx*g;l=-this.m_springMass*(l+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=l;var m=box2d.b2MulSV(l,this.m_ax,box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P),
n=l*this.m_sAx;l*=this.m_sBx;f.SelfMulSub(b,m);g-=d*n;h.SelfMulAdd(c,m);k+=e*l;l=k-g-this.m_motorSpeed;l*=-this.m_motorMass;m=this.m_motorImpulse;n=a.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+l,-n,n);l=this.m_motorImpulse-m;g-=d*l;k+=e*l;l=box2d.b2DotVV(this.m_ay,box2d.b2SubVV(h,f,box2d.b2Vec2.s_t0))+this.m_sBy*k-this.m_sAy*g;l*=-this.m_mass;this.m_impulse+=l;m=box2d.b2MulSV(l,this.m_ay,box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P);n=l*this.m_sAy;
l*=this.m_sBy;f.SelfMulSub(b,m);g-=d*n;h.SelfMulAdd(c,m);a.velocities[this.m_indexA].w=g;a.velocities[this.m_indexB].w=k+e*l};box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2WheelJoint.prototype.SolvePositionConstraints=function(a){var b=a.positions[this.m_indexA].c,c=a.positions[this.m_indexA].a,d=a.positions[this.m_indexB].c,e=a.positions[this.m_indexB].a,f=this.m_qA.SetAngleRadians(c),g=this.m_qB.SetAngleRadians(e);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var h=box2d.b2MulRV(f,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);g=box2d.b2MulRV(g,this.m_lalcB,this.m_rB);var k=box2d.b2AddVV(box2d.b2SubVV(d,
b,box2d.b2Vec2.s_t0),box2d.b2SubVV(g,h,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_d);f=box2d.b2MulRV(f,this.m_localYAxisA,this.m_ay);h=box2d.b2CrossVV(box2d.b2AddVV(k,h,box2d.b2Vec2.s_t0),f);g=box2d.b2CrossVV(g,f);k=box2d.b2DotVV(k,this.m_ay);var l=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;l=0!==l?-k/l:0;f=box2d.b2MulSV(l,f,box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_P);h*=l;g*=l;b.SelfMulSub(this.m_invMassA,
f);c-=this.m_invIA*h;d.SelfMulAdd(this.m_invMassB,f);e+=this.m_invIB*g;a.positions[this.m_indexA].a=c;a.positions[this.m_indexB].a=e;return box2d.b2Abs(k)<=box2d.b2_linearSlop};box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_d=new box2d.b2Vec2;box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2WheelJoint.prototype.GetDefinition=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);return a};
box2d.b2WheelJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};box2d.b2WheelJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};box2d.b2WheelJoint.prototype.GetReactionForce=function(a,b){b.x=a*(this.m_impulse*this.m_ay.x+this.m_springImpulse*this.m_ax.x);b.y=a*(this.m_impulse*this.m_ay.y+this.m_springImpulse*this.m_ax.y);return b};box2d.b2WheelJoint.prototype.GetReactionTorque=function(a){return a*this.m_motorImpulse};
box2d.b2WheelJoint.prototype.GetLocalAnchorA=function(a){return a.Copy(this.m_localAnchorA)};box2d.b2WheelJoint.prototype.GetLocalAnchorB=function(a){return a.Copy(this.m_localAnchorB)};box2d.b2WheelJoint.prototype.GetLocalAxisA=function(a){return a.Copy(this.m_localXAxisA)};
box2d.b2WheelJoint.prototype.GetJointTranslation=function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.GetWorldPoint(this.m_localAnchorA,new box2d.b2Vec2);b=b.GetWorldPoint(this.m_localAnchorB,new box2d.b2Vec2);c=box2d.b2SubVV(b,c,new box2d.b2Vec2);a=a.GetWorldVector(this.m_localXAxisA,new box2d.b2Vec2);return box2d.b2DotVV(c,a)};box2d.b2WheelJoint.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity};box2d.b2WheelJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor};
box2d.b2WheelJoint.prototype.EnableMotor=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=a};box2d.b2WheelJoint.prototype.SetMotorSpeed=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=a};box2d.b2WheelJoint.prototype.SetMaxMotorTorque=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorTorque=a};box2d.b2WheelJoint.prototype.GetMotorTorque=function(a){return a*this.m_motorImpulse};
box2d.b2WheelJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2WheelJointDef*/ var jd = new box2d.b2WheelJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",
this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y);box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false");box2d.b2Log("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed);box2d.b2Log("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque);box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz);box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",
this.m_index)}};box2d.b2MotorJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_motorJoint);this.linearOffset=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2MotorJointDef,box2d.b2JointDef);box2d.b2MotorJointDef.prototype.linearOffset=null;box2d.b2MotorJointDef.prototype.angularOffset=0;box2d.b2MotorJointDef.prototype.maxForce=1;box2d.b2MotorJointDef.prototype.maxTorque=1;box2d.b2MotorJointDef.prototype.correctionFactor=.3;
box2d.b2MotorJointDef.prototype.Initialize=function(a,b){this.bodyA=a;this.bodyB=b;this.bodyA.GetLocalPoint(this.bodyB.GetPosition(),this.linearOffset);var c=this.bodyA.GetAngleRadians();this.angularOffset=this.bodyB.GetAngleRadians()-c};
box2d.b2MotorJoint=function(a){box2d.b2Joint.call(this,a);this.m_linearOffset=a.linearOffset.Clone();this.m_linearImpulse=new box2d.b2Vec2(0,0);this.m_maxForce=a.maxForce;this.m_maxTorque=a.maxTorque;this.m_correctionFactor=a.correctionFactor;this.m_rA=new box2d.b2Vec2(0,0);this.m_rB=new box2d.b2Vec2(0,0);this.m_localCenterA=new box2d.b2Vec2(0,0);this.m_localCenterB=new box2d.b2Vec2(0,0);this.m_linearError=new box2d.b2Vec2(0,0);this.m_linearMass=new box2d.b2Mat22;this.m_qA=new box2d.b2Rot;this.m_qB=
new box2d.b2Rot;this.m_K=new box2d.b2Mat22};goog.inherits(box2d.b2MotorJoint,box2d.b2Joint);box2d.b2MotorJoint.prototype.m_linearOffset=null;box2d.b2MotorJoint.prototype.m_angularOffset=0;box2d.b2MotorJoint.prototype.m_linearImpulse=null;box2d.b2MotorJoint.prototype.m_angularImpulse=0;box2d.b2MotorJoint.prototype.m_maxForce=0;box2d.b2MotorJoint.prototype.m_maxTorque=0;box2d.b2MotorJoint.prototype.m_correctionFactor=.3;box2d.b2MotorJoint.prototype.m_indexA=0;box2d.b2MotorJoint.prototype.m_indexB=0;
box2d.b2MotorJoint.prototype.m_rA=null;box2d.b2MotorJoint.prototype.m_rB=null;box2d.b2MotorJoint.prototype.m_localCenterA=null;box2d.b2MotorJoint.prototype.m_localCenterB=null;box2d.b2MotorJoint.prototype.m_linearError=null;box2d.b2MotorJoint.prototype.m_angularError=0;box2d.b2MotorJoint.prototype.m_invMassA=0;box2d.b2MotorJoint.prototype.m_invMassB=0;box2d.b2MotorJoint.prototype.m_invIA=0;box2d.b2MotorJoint.prototype.m_invIB=0;box2d.b2MotorJoint.prototype.m_linearMass=null;
box2d.b2MotorJoint.prototype.m_angularMass=0;box2d.b2MotorJoint.prototype.m_qA=null;box2d.b2MotorJoint.prototype.m_qB=null;box2d.b2MotorJoint.prototype.m_K=null;box2d.b2MotorJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetPosition(a)};box2d.b2MotorJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetPosition(a)};box2d.b2MotorJoint.prototype.GetReactionForce=function(a,b){return box2d.b2MulSV(a,this.m_linearImpulse,b)};
box2d.b2MotorJoint.prototype.GetReactionTorque=function(a){return a*this.m_angularImpulse};box2d.b2MotorJoint.prototype.SetCorrectionFactor=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a)&&0<=a&&1>=a);this._correctionFactor=a};box2d.b2MotorJoint.prototype.GetCorrectionFactor=function(){return this.m_correctionFactor};box2d.b2MotorJoint.prototype.SetLinearOffset=function(a){box2d.b2IsEqualToV(a,this.m_linearOffset)||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_linearOffset.Copy(a))};
box2d.b2MotorJoint.prototype.GetLinearOffset=function(a){return a.Copy(this.m_linearOffset)};box2d.b2MotorJoint.prototype.SetAngularOffset=function(a){a!==this.m_angularOffset&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_angularOffset=a)};box2d.b2MotorJoint.prototype.GetAngularOffset=function(){return this.m_angularOffset};box2d.b2MotorJoint.prototype.SetMaxForce=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a)&&0<=a);this.m_maxForce=a};
box2d.b2MotorJoint.prototype.GetMaxForce=function(){return this.m_maxForce};box2d.b2MotorJoint.prototype.SetMaxTorque=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a)&&0<=a);this.m_maxTorque=a};box2d.b2MotorJoint.prototype.GetMaxTorque=function(){return this.m_maxTorque};
box2d.b2MotorJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexA].c,c=a.positions[this.m_indexA].a,d=a.velocities[this.m_indexA].v,
e=a.velocities[this.m_indexA].w,f=a.positions[this.m_indexB].c,g=a.positions[this.m_indexB].a,h=a.velocities[this.m_indexB].v,k=a.velocities[this.m_indexB].w,l=this.m_qA.SetAngleRadians(c),m=this.m_qB.SetAngleRadians(g),n=box2d.b2MulRV(l,box2d.b2NegV(this.m_localCenterA,box2d.b2Vec2.s_t0),this.m_rA);m=box2d.b2MulRV(m,box2d.b2NegV(this.m_localCenterB,box2d.b2Vec2.s_t0),this.m_rB);var p=this.m_invMassA,q=this.m_invMassB,r=this.m_invIA,t=this.m_invIB,u=this.m_K;u.ex.x=p+q+r*n.y*n.y+t*m.y*m.y;u.ex.y=
-r*n.x*n.y-t*m.x*m.y;u.ey.x=u.ex.y;u.ey.y=p+q+r*n.x*n.x+t*m.x*m.x;u.GetInverse(this.m_linearMass);this.m_angularMass=r+t;0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass);box2d.b2SubVV(box2d.b2SubVV(box2d.b2AddVV(f,m,box2d.b2Vec2.s_t0),box2d.b2AddVV(b,n,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t2),box2d.b2MulRV(l,this.m_linearOffset,box2d.b2Vec2.s_t3),this.m_linearError);this.m_angularError=g-c-this.m_angularOffset;a.step.warmStarting?(this.m_linearImpulse.SelfMul(a.step.dtRatio),this.m_angularImpulse*=
a.step.dtRatio,b=this.m_linearImpulse,d.SelfMulSub(p,b),e-=r*(box2d.b2CrossVV(n,b)+this.m_angularImpulse),h.SelfMulAdd(q,b),k+=t*(box2d.b2CrossVV(m,b)+this.m_angularImpulse)):(this.m_linearImpulse.SetZero(),this.m_angularImpulse=0);a.velocities[this.m_indexA].w=e;a.velocities[this.m_indexB].w=k};
box2d.b2MotorJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,c=a.velocities[this.m_indexA].w,d=a.velocities[this.m_indexB].v,e=a.velocities[this.m_indexB].w,f=this.m_invMassA,g=this.m_invMassB,h=this.m_invIA,k=this.m_invIB,l=a.step.dt,m=a.step.inv_dt,n=e-c+m*this.m_correctionFactor*this.m_angularError;n*=-this.m_angularMass;var p=this.m_angularImpulse,q=l*this.m_maxTorque;this.m_angularImpulse=box2d.b2Clamp(this.m_angularImpulse+n,-q,q);n=this.m_angularImpulse-
p;c-=h*n;e+=k*n;var r=this.m_rA,t=this.m_rB;n=box2d.b2AddVV(box2d.b2SubVV(box2d.b2AddVV(d,box2d.b2CrossSV(e,t,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2AddVV(b,box2d.b2CrossSV(c,r,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t2),box2d.b2MulSV(m*this.m_correctionFactor,this.m_linearError,box2d.b2Vec2.s_t3),box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_Cdot);n=box2d.b2MulMV(this.m_linearMass,n,box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_impulse).SelfNeg();p=box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_oldImpulse.Copy(this.m_linearImpulse);
this.m_linearImpulse.SelfAdd(n);q=l*this.m_maxForce;this.m_linearImpulse.GetLengthSquared()>q*q&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(q));box2d.b2SubVV(this.m_linearImpulse,p,n);b.SelfMulSub(f,n);c-=h*box2d.b2CrossVV(r,n);d.SelfMulAdd(g,n);e+=k*box2d.b2CrossVV(t,n);a.velocities[this.m_indexA].w=c;a.velocities[this.m_indexB].w=e};box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec2;
box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_oldImpulse=new box2d.b2Vec2;box2d.b2MotorJoint.prototype.SolvePositionConstraints=function(a){return!0};
box2d.b2MotorJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2MotorJointDef*/ var jd = new box2d.b2MotorJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.linearOffset.SetXY(%.15f, %.15f);\n",this.m_linearOffset.x,this.m_linearOffset.y);box2d.b2Log("  jd.angularOffset = %.15f;\n",
this.m_angularOffset);box2d.b2Log("  jd.maxForce = %.15f;\n",this.m_maxForce);box2d.b2Log("  jd.maxTorque = %.15f;\n",this.m_maxTorque);box2d.b2Log("  jd.correctionFactor = %.15f;\n",this.m_correctionFactor);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};
Phaser.Physics.Box2D=function(a,b){this.game=a;this.version="1.0.2";this.ptmRatio=50;this.world=new box2d.b2World(new box2d.b2Vec2(0,0));this.debugDraw=new Phaser.Physics.Box2D.DefaultDebugDraw(this.mpx(1));this.world.SetDebugDraw(this.debugDraw);this.contactListener=new Phaser.Physics.Box2D.DefaultContactListener;this.world.SetContactListener(this.contactListener);this.nextFixtureId=this.nextBodyId=0;this.gravity=new Phaser.Physics.Box2D.PointProxy(this,this.world,this.world.GetGravity,this.world.SetGravity);
this.friction=.2;this.restitution=0;this.density=1;this.frameRate=1/60;this.velocityIterations=8;this.positionIterations=3;this.paused=this.useElapsedTime=!1;this.particleSystem=null;var c=new box2d.b2BodyDef;this.mouseJointBody=this.world.CreateBody(c);this.mouseJoint=null;b.hasOwnProperty("mpx")&&b.hasOwnProperty("pxm")&&(this.mpx=b.mpx,this.pxm=b.pxm);this.walls={left:null,right:null,top:null,bottom:null};this.onBodyAdded=new Phaser.Signal;this.onBodyRemoved=new Phaser.Signal;this._toRemove=[]};
Phaser.Physics.Box2D.worldBoundsFilterCategory=32768;
Phaser.Physics.Box2D.prototype={getNextBodyId:function(){var a=this.nextBodyId;this.nextBodyId+=1;return a},getNextFixtureId:function(){var a=this.nextFixtureId;this.nextFixtureId+=1;return a},removeBodyNextStep:function(a){this._toRemove.push(a)},preUpdate:function(){for(var a=this._toRemove.length;a--;)this.removeBody(this._toRemove[a]);this._toRemove.length=0},enable:function(a,b){"undefined"===typeof b&&(b=!0);var c;if(Array.isArray(a))for(c=a.length;c--;)a[c]instanceof Phaser.Group?this.enable(a[c].children,
b):(this.enableBody(a[c]),b&&a[c].hasOwnProperty("children")&&0<a[c].children.length&&this.enable(a[c],!0));else a instanceof Phaser.Group?this.enable(a.children,b):(this.enableBody(a),b&&a.hasOwnProperty("children")&&0<a.children.length&&this.enable(a.children,!0))},enableBody:function(a){a.hasOwnProperty("body")&&null===a.body&&(a.body=new Phaser.Physics.Box2D.Body(this.game,a,a.x,a.y,2),a.anchor.set(.5))},setBoundsToWorld:function(a,b,c,d,e,f){"undefined"===typeof a&&(a=!0);"undefined"===typeof b&&
(b=!0);"undefined"===typeof c&&(c=!0);"undefined"===typeof d&&(d=!0);"undefined"===typeof e&&(e=1);"undefined"===typeof f&&(e=4294967295);this.setBounds(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,a,b,c,d,e,f)},setBounds:function(a,b,c,d,e,f,g,h,k,l){"undefined"===typeof e&&(e=!0);"undefined"===typeof f&&(f=!0);"undefined"===typeof g&&(g=!0);"undefined"===typeof h&&(h=!0);this.walls.left&&this.removeBody(this.walls.left);this.walls.right&&
this.removeBody(this.walls.right);this.walls.top&&this.removeBody(this.walls.top);this.walls.bottom&&this.removeBody(this.walls.bottom);a=new box2d.b2PolygonShape;b=new box2d.b2FixtureDef;b.shape=a;b.filter.categoryBits=Phaser.Physics.Box2D.worldBoundsFilterCategory;b.filter.maskBits=65535;c=this.pxm(100);d=this.game.world.bounds;e&&(this.walls.left=this.createBody(0,0,0),a.SetAsOrientedBox(c,this.pxm(d.height)+c,new box2d.b2Vec2(c,0),0),e=this.walls.left.data.CreateFixture(b),e.id=this.getNextFixtureId());
f&&(this.walls.right=this.createBody(0,0,0),a.SetAsOrientedBox(c,this.pxm(d.height)+c,new box2d.b2Vec2(this.pxm(-d.width)-c,0),0),e=this.walls.right.data.CreateFixture(b),e.id=this.getNextFixtureId());g&&(this.walls.top=this.createBody(0,0,0),a.SetAsOrientedBox(this.pxm(d.width)+c,c,new box2d.b2Vec2(0,c),0),e=this.walls.top.data.CreateFixture(b),e.id=this.getNextFixtureId());h&&(this.walls.bottom=this.createBody(0,0,0),a.SetAsOrientedBox(this.pxm(d.width)+c,c,new box2d.b2Vec2(0,this.pxm(-d.height)-
c),0),e=this.walls.bottom.data.CreateFixture(b),e.id=this.getNextFixtureId())},pause:function(){this.paused=!0},resume:function(){this.paused=!1},update:function(){this.paused||(this.useElapsedTime?this.world.Step(this.game.time.physicsElapsed,this.velocityIterations,this.positionIterations):this.world.Step(this.frameRate,this.velocityIterations,this.positionIterations))},reset:function(){this.clear()},clear:function(){var a=this.world.GetGravity().Clone();this.world=new box2d.b2World(a);this.world.SetDebugDraw(this.debugDraw);
this.world.SetContactListener(this.contactListener);this._toRemove=[]},destroy:function(){this.clear();this.game=this.world=this.gravity=null},createBody:function(a,b,c){return new Phaser.Physics.Box2D.Body(this.game,null,a,b,c,this)},createCircle:function(a,b,c,d,e){return this.createBody(a,b,2).setCircle(c,d,e)},createRectangle:function(a,b,c,d,e,f,g){return this.createBody(a,b,2).setRectangle(c,d,e,f,g)},createPolygon:function(a,b,c,d,e){return this.createBody(a,b,2).setPolygon(c,d,e)},addBody:function(a){if(a.data.world)return!1;
a.data=this.world.CreateBody(a.bodyDef);a.data.world=this.world;a.data.parent=a;this.onBodyAdded.dispatch(a);return!0},removeBody:function(a){a.data.world==this.world&&(this.world.DestroyBody(a.data),this.onBodyRemoved.dispatch(a));return a},getBodies:function(){for(var a=[],b=this.world.GetBodyList();b;b=b.GetNext())a.push(b);return a},getBody:function(a){return a instanceof box2d.b2Body?a:a instanceof Phaser.Physics.Box2D.Body?a.data:a.body&&a.body.type===Phaser.Physics.BOX2D?a.body.data:null},
toJSON:function(){return this.world.toJSON()},mpx:function(a){return a*this.ptmRatio},pxm:function(a){return a/this.ptmRatio},renderDebugDraw:function(a){if(this.game.physics.box2d){var b=this.game.physics.box2d;b.debugDraw.start(a);b.world.DrawDebugData();b.debugDraw.stop()}},renderBodyInfo:function(a,b){a.line("Position: x: "+b.x.toFixed(3)+" y: "+b.y.toFixed(3));a.line("Rotation: "+b.rotation.toFixed(3)+" degrees");a.line("Velocity: x: "+b.velocity.x.toFixed(3)+" y: "+b.velocity.y.toFixed(3));
a.line("Angular velocity: "+b.angularVelocity.toFixed(3)+" degrees/sec")},getFixturesAtPoint:function(a,b,c,d){"undefined"===typeof c&&(c=!1);"undefined"===typeof d&&(d=!1);a=this.pxm(-a);b=this.pxm(-b);var e=new box2d.b2Vec2(a,b);b=new box2d.b2AABB;a=new box2d.b2Vec2;a.SetXY(.001,.001);box2d.b2SubVV(e,a,b.lowerBound);box2d.b2AddVV(e,a,b.upperBound);var f=[];this.world.QueryAABB(function(a){return d&&a.GetBody().GetType()!==box2d.b2BodyType.b2_dynamicBody?!0:a.TestPoint(e)?(f.push(a),!c):!0},b);return f},
getBodiesAtPoint:function(a,b,c,d){"undefined"===typeof c&&(c=!1);"undefined"===typeof d&&(d=!1);a=this.getFixturesAtPoint(a,b,c,d);if(1>a.length)return a;var e=[];for(b=0;b<a.length;b++)e.push(a[b].GetBody().parent);e.filter(function(a,b){return e.indexOf(a)===b});return e},mouseDragStart:function(a){this.mouseDragEnd();var b=this.getFixturesAtPoint(a.x,a.y,!0,!0);if(!(1>b.length)){var c=this.pxm(-a.x);a=this.pxm(-a.y);c=new box2d.b2Vec2(c,a);a=new box2d.b2MouseJointDef;a.bodyA=this.mouseJointBody;
a.bodyB=b[0].GetBody();a.target.Copy(c);a.maxForce=1E20*a.bodyB.GetMass();this.mouseJoint=this.world.CreateJoint(a);a.bodyB.SetAwake(!0)}},mouseDragMove:function(a){if(this.mouseJoint){var b=this.pxm(-a.x);a=this.pxm(-a.y);b=new box2d.b2Vec2(b,a);this.mouseJoint.SetTarget(b)}},mouseDragEnd:function(){this.mouseJoint&&(this.world.DestroyJoint(this.mouseJoint),this.mouseJoint=null)},distanceJoint:function(a,b,c,d,e,f,g,h,k){"undefined"===typeof d&&(d=0);"undefined"===typeof e&&(e=0);"undefined"===typeof f&&
(f=0);"undefined"===typeof g&&(g=0);"undefined"===typeof h&&(h=0);"undefined"===typeof k&&(k=0);d=this.pxm(-d);e=this.pxm(-e);f=this.pxm(-f);g=this.pxm(-g);a.body&&(a=a.body);b.body&&(b=b.body);var l=new box2d.b2DistanceJointDef;l.bodyA=a.data;l.bodyB=b.data;l.localAnchorA.SetXY(d,e);l.localAnchorB.SetXY(f,g);null===c||"undefined"===typeof c?(a=new box2d.b2Vec2,b=new box2d.b2Vec2,l.bodyA.GetWorldPoint(l.localAnchorA,a),l.bodyB.GetWorldPoint(l.localAnchorB,b),a.SelfSub(b),c=a.Length()):c=this.pxm(c);
l.length=c;l.frequencyHz=h;l.dampingRatio=k;return this.world.CreateJoint(l)},ropeJoint:function(a,b,c,d,e,f,g){"undefined"===typeof d&&(d=0);"undefined"===typeof e&&(e=0);"undefined"===typeof f&&(f=0);"undefined"===typeof g&&(g=0);d=this.pxm(-d);e=this.pxm(-e);f=this.pxm(-f);g=this.pxm(-g);a.body&&(a=a.body);b.body&&(b=b.body);var h=new box2d.b2RopeJointDef;h.bodyA=a.data;h.bodyB=b.data;h.localAnchorA.SetXY(d,e);h.localAnchorB.SetXY(f,g);null===c||"undefined"===typeof c?(a=new box2d.b2Vec2,b=new box2d.b2Vec2,
h.bodyA.GetWorldPoint(h.localAnchorA,a),h.bodyB.GetWorldPoint(h.localAnchorB,b),a.SelfSub(b),c=a.Length()):c=this.pxm(c);h.maxLength=c;return this.world.CreateJoint(h)},revoluteJoint:function(a,b,c,d,e,f,g,h,k,l,m,n){"undefined"===typeof c&&(c=0);"undefined"===typeof d&&(d=0);"undefined"===typeof e&&(e=0);"undefined"===typeof f&&(f=0);"undefined"===typeof g&&(g=0);"undefined"===typeof h&&(h=0);"undefined"===typeof k&&(k=!1);"undefined"===typeof l&&(l=0);"undefined"===typeof m&&(m=0);"undefined"===
typeof n&&(n=!1);c=this.pxm(-c);d=this.pxm(-d);e=this.pxm(-e);f=this.pxm(-f);a.body&&(a=a.body);b.body&&(b=b.body);var p=new box2d.b2RevoluteJointDef;p.bodyA=a.data;p.bodyB=b.data;p.localAnchorA.SetXY(c,d);p.localAnchorB.SetXY(e,f);p.motorSpeed=Phaser.Math.degToRad(-g);p.maxMotorTorque=h;p.enableMotor=k;p.lowerAngle=Phaser.Math.degToRad(l);p.upperAngle=Phaser.Math.degToRad(m);p.enableLimit=n;return this.world.CreateJoint(p)},prismaticJoint:function(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r){"undefined"===typeof c&&
(c=1);"undefined"===typeof d&&(d=0);"undefined"===typeof e&&(e=0);"undefined"===typeof f&&(f=0);"undefined"===typeof g&&(g=0);"undefined"===typeof h&&(h=0);"undefined"===typeof k&&(k=0);"undefined"===typeof l&&(l=0);"undefined"===typeof n&&(n=0);"undefined"===typeof p&&(p=0);"undefined"===typeof q&&(q=!1);"undefined"===typeof m&&(m=!1);"undefined"===typeof r&&(r=0);c*=-1;d*=-1;e=this.pxm(-e);f=this.pxm(-f);g=this.pxm(-g);h=this.pxm(-h);k=this.pxm(k);n=this.pxm(n);p=this.pxm(p);a.body&&(a=a.body);
b.body&&(b=b.body);var t=new box2d.b2PrismaticJointDef;t.bodyA=a.data;t.bodyB=b.data;t.localAxisA.SetXY(c,d);t.localAnchorA.SetXY(e,f);t.localAnchorB.SetXY(g,h);t.motorSpeed=k;t.maxMotorForce=l;t.enableMotor=m;t.lowerTranslation=n;t.upperTranslation=p;t.enableLimit=q;t.referenceAngle=Phaser.Math.degToRad(-r);return this.world.CreateJoint(t)},frictionJoint:function(a,b,c,d,e,f,g,h){"undefined"===typeof e&&(e=0);"undefined"===typeof f&&(f=0);"undefined"===typeof g&&(g=0);"undefined"===typeof h&&(h=
0);"undefined"===typeof c&&(c=0);"undefined"===typeof d&&(d=0);e=this.pxm(-e);f=this.pxm(-f);g=this.pxm(-g);h=this.pxm(-h);a.body&&(a=a.body);b.body&&(b=b.body);var k=new box2d.b2FrictionJointDef;k.bodyA=a.data;k.bodyB=b.data;k.localAnchorA.SetXY(e,f);k.localAnchorB.SetXY(g,h);k.maxForce=c;k.maxTorque=d;return this.world.CreateJoint(k)},weldJoint:function(a,b,c,d,e,f,g,h){"undefined"===typeof c&&(c=0);"undefined"===typeof d&&(d=0);"undefined"===typeof e&&(e=0);"undefined"===typeof f&&(f=0);"undefined"===
typeof g&&(g=0);"undefined"===typeof h&&(h=0);c=this.pxm(-c);d=this.pxm(-d);e=this.pxm(-e);f=this.pxm(-f);a.body&&(a=a.body);b.body&&(b=b.body);var k=new box2d.b2WeldJointDef;k.bodyA=a.data;k.bodyB=b.data;k.localAnchorA.SetXY(c,d);k.localAnchorB.SetXY(e,f);k.frequencyHz=g;k.dampingRatio=h;return this.world.CreateJoint(k)},motorJoint:function(a,b,c,d,e,f,g,h){"undefined"===typeof f&&(f=0);"undefined"===typeof g&&(g=0);"undefined"===typeof h&&(h=0);"undefined"===typeof c&&(c=0);"undefined"===typeof d&&
(d=0);"undefined"===typeof e&&(e=1);f=this.pxm(-f);g=this.pxm(-g);a.body&&(a=a.body);b.body&&(b=b.body);var k=new box2d.b2MotorJointDef;k.bodyA=a.data;k.bodyB=b.data;k.linearOffset.SetXY(f,g);k.maxForce=c;k.maxTorque=d;k.angularOffset=Phaser.Math.degToRad(-h);k.correctionFactor=e;return this.world.CreateJoint(k)},wheelJoint:function(a,b,c,d,e,f,g,h,k,l,m,n,p){"undefined"===typeof g&&(g=0);"undefined"===typeof h&&(h=1);"undefined"===typeof c&&(c=0);"undefined"===typeof d&&(d=0);"undefined"===typeof e&&
(e=0);"undefined"===typeof f&&(f=0);"undefined"===typeof m&&(m=0);"undefined"===typeof n&&(n=0);"undefined"===typeof p&&(p=!1);"undefined"===typeof k&&(k=0);"undefined"===typeof l&&(l=0);g*=-1;h*=-1;c=this.pxm(-c);d=this.pxm(-d);e=this.pxm(-e);f=this.pxm(-f);a.body&&(a=a.body);b.body&&(b=b.body);var q=new box2d.b2WheelJointDef;q.bodyA=a.data;q.bodyB=b.data;q.localAxisA.SetXY(g,h);q.localAnchorA.SetXY(c,d);q.localAnchorB.SetXY(e,f);q.motorSpeed=Phaser.Math.degToRad(-m);q.maxMotorTorque=n;q.enableMotor=
p;q.frequencyHz=k;q.dampingRatio=l;return this.world.CreateJoint(q)},pulleyJoint:function(a,b,c,d,e,f,g,h,k,l,m,n,p){"undefined"===typeof c&&(c=0);"undefined"===typeof d&&(d=0);"undefined"===typeof e&&(e=0);"undefined"===typeof f&&(f=0);"undefined"===typeof g&&(g=0);"undefined"===typeof h&&(h=0);"undefined"===typeof k&&(k=0);"undefined"===typeof l&&(l=0);"undefined"===typeof m&&(m=1);"undefined"===typeof n&&(n=100);"undefined"===typeof p&&(p=100);c=this.pxm(-c);d=this.pxm(-d);e=this.pxm(-e);f=this.pxm(-f);
g=this.pxm(-g);h=this.pxm(-h);k=this.pxm(-k);l=this.pxm(-l);n=this.pxm(n);p=this.pxm(p);a.body&&(a=a.body);b.body&&(b=b.body);var q=new box2d.b2PulleyJointDef;q.bodyA=a.data;q.bodyB=b.data;q.localAnchorA.SetXY(c,d);q.localAnchorB.SetXY(e,f);q.groundAnchorA.SetXY(g,h);q.groundAnchorB.SetXY(k,l);q.lengthA=n;q.lengthB=p;q.ratio=m;return this.world.CreateJoint(q)},gearJoint:function(a,b,c){"undefined"===typeof c&&(c=1);var d=new box2d.b2GearJointDef;d.joint1=a;d.joint2=b;d.ratio=-c;d.bodyA=a.GetBodyA();
d.bodyB=b.GetBodyB();return this.world.CreateJoint(d)},clearTilemapLayerBodies:function(a,b){b=a.getLayer(b);for(var c=a.layers[b].bodies.length;c--;)a.layers[b].bodies[c].destroy();a.layers[b].bodies.length=0},convertTilemap:function(a,b,c,d){b=a.getLayer(b);"undefined"===typeof c&&(c=!0);"undefined"===typeof d&&(d=!0);this.clearTilemapLayerBodies(a,b);for(var e,f=0,g=0,h=0,k=a.layers[b].height;h<k;h++)for(var l=e=0,m=a.layers[b].width;l<m;l++){var n=a.layers[b].data[h][l];if(n&&-1<n.index&&n.collides)if(d){var p=
a.getTileRight(b,l,h);0===e&&(f=n.x*n.width,g=n.y*n.height,e=n.width);p&&p.collides?e+=n.width:(p=new Phaser.Physics.Box2D.Body(this.game,null,f,g,0),p.addRectangle(e,n.height,e/2,n.height/2,0),c&&this.addBody(p),a.layers[b].bodies.push(p),e=0)}else p=this.createBody(n.x*n.width,n.y*n.height,0,!1),p.addRectangle(n.width,n.height,n.width/2,n.height/2,0),c&&this.addBody(p),a.layers[b].bodies.push(p)}return a.layers[b].bodies},raycast:function(a,b,c,d,e,f){"undefined"===typeof e&&(e=!0);"undefined"===
typeof f&&(f=null);a=this.pxm(-a);b=this.pxm(-b);c=this.pxm(-c);d=this.pxm(-d);a=new box2d.b2Vec2(a,b);d=new box2d.b2Vec2(c,d);c=[];e=new Phaser.Physics.Box2D.RayCastCallback(this,e,f);this.world.RayCast(e,a,d);for(f=0;f<e.hits.length;f++)a=e.hits[f],a.point={x:this.mpx(-a.point.x),y:this.mpx(-a.point.y)},a.normal={x:-a.normal.x,y:-a.normal.y},c.push(a);return c},queryAABB:function(a,b,c,d){a=this.pxm(-a);b=this.pxm(-b);c=this.pxm(c);d=this.pxm(d);var e=new box2d.b2AABB;e.lowerBound.SetXY(a-c,b-d);
e.upperBound.SetXY(a,b);a=new Phaser.Physics.Box2D.QueryCallback(this);this.world.QueryAABB(a,e);return a.hits},queryFixture:function(a){var b=new Phaser.Physics.Box2D.QueryCallback(this);this.world.QueryShape(b,a.GetShape(),a.GetBody().GetTransform());return b.hits},setPTMRatio:function(a){this.ptmRatio=a;this.debugDraw=new Phaser.Physics.Box2D.DefaultDebugDraw(this.ptmRatio);this.world.SetDebugDraw(this.debugDraw)}};
Phaser.Physics.Box2D.RayCastCallback=function(a,b,c){this.world=a;this.closestHitOnly=b;this.filterFunction=c;this.hits=[]};goog.inherits(Phaser.Physics.Box2D.RayCastCallback,box2d.b2RayCastCallback);
Phaser.Physics.Box2D.RayCastCallback.prototype.ReportFixture=function(a,b,c,d){if(null!==this.filterFunction){var e={x:this.world.mpx(-b.x),y:this.world.mpx(-b.y)},f={x:-c.x,y:-c.y},g=a.GetBody().parent;if(!this.filterFunction.call(this,g,a,e,f))return-1}this.closestHitOnly&&(this.hits=[]);e={};e.body=a.GetBody().parent;e.fixture=a;e.point={x:b.x,y:b.y};e.normal={x:c.x,y:c.y};this.hits.push(e);return this.closestHitOnly?d:1};Phaser.Physics.Box2D.QueryCallback=function(a){this.world=a;this.hits=[]};
goog.inherits(Phaser.Physics.Box2D.QueryCallback,box2d.b2QueryCallback);Phaser.Physics.Box2D.QueryCallback.prototype.ReportFixture=function(a){var b={};b.body=a.GetBody().parent;b.fixture=a;this.hits.push(b);return!0};
Phaser.Physics.Box2D.renderBody=function(a,b,c,d){c=c||"rgb(255,255,255)";var e=b.data,f=e.GetTransform();d=b.world;f.p.x+=-b.game.camera.x/d.ptmRatio;f.p.y-=-b.game.camera.y/d.ptmRatio;d.debugDraw.start(a);d.debugDraw.PushTransform(f);b=Phaser.Color.webToColor(c);a=d.debugDraw.color;a.r=b.r/255;a.g=b.g/255;a.b=b.b/255;for(e=e.GetFixtureList();e;e=e.GetNext())d.world.DrawShape(e,a);d.debugDraw.PopTransform();d.debugDraw.stop()};
Phaser.Physics.Box2D.Body=function(a,b,c,d,e,f){"undefined"===typeof b&&(b=null);"undefined"===typeof c&&(c=0);"undefined"===typeof d&&(d=0);"undefined"===typeof e&&(e=2);"undefined"===typeof f&&(f=a.physics.box2d);this.game=a;this.world=f;this.id=this.world.getNextBodyId();this.sprite=b;this.type=Phaser.Physics.BOX2D;this.offset=new Phaser.Point;this.bodyDef=new box2d.b2BodyDef;this.bodyDef.position.SetXY(-this.world.pxm(c),-this.world.pxm(d));0===e?this.bodyDef.type=box2d.b2BodyType.b2_staticBody:
1===e?this.bodyDef.type=box2d.b2BodyType.b2_kinematicBody:2===e?this.bodyDef.type=box2d.b2BodyType.b2_dynamicBody:3===e&&(this.bodyDef.type=box2d.b2BodyType.b2_bulletBody);this.data=this.world.world.CreateBody(this.bodyDef);this.data.world=this.world.world;this.data.parent=this;this.velocity=new Phaser.Physics.Box2D.PointProxy(this.world,this.data,this.data.GetLinearVelocity,this.data.SetLinearVelocity);this.removeNextStep=!1;this._fixtureContactCallbacks={};this._fixtureContactCallbackContext={};
this._bodyContactCallbacks={};this._bodyContactCallbackContext={};this._categoryContactCallbacks={};this._categoryContactCallbackContext={};this._fixturePresolveCallbacks={};this._fixturePresolveCallbackContext={};this._bodyPresolveCallbacks={};this._bodyPresolveCallbackContext={};this._categoryPresolveCallbacks={};this._categoryPresolveCallbackContext={};this._fixturePostsolveCallbacks={};this._fixturePostsolveCallbackContext={};this._bodyPostsolveCallbacks={};this._bodyPostsolveCallbackContext=
{};this._categoryPostsolveCallbacks={};this._categoryPostsolveCallbackContext={};b&&this.setRectangleFromSprite(b)};
Phaser.Physics.Box2D.Body.prototype={setBodyContactCallback:function(a,b,c){var d=-1;a.id?d=a.id:a.body&&(d=a.body.id);-1<d&&(null===b?(delete this._bodyContactCallbacks[d],delete this._bodyContactCallbackContext[d]):(this._bodyContactCallbacks[d]=b,this._bodyContactCallbackContext[d]=c))},setFixtureContactCallback:function(a,b,c){a=a.id;-1<a&&(null===b?(delete this._fixtureContactCallbacks[a],delete this._fixtureContactCallbackContext[a]):(this._fixtureContactCallbacks[a]=b,this._fixtureContactCallbackContext[a]=
c))},setCategoryContactCallback:function(a,b,c){null===b?(delete this._categoryContactCallbacks[a],delete this._categoryContactCallbacksContext[a]):(this._categoryContactCallbacks[a]=b,this._categoryContactCallbackContext[a]=c)},setBodyPresolveCallback:function(a,b,c){var d=-1;a.id?d=a.id:a.body&&(d=a.body.id);-1<d&&(null===b?(delete this._bodyPresolveCallbacks[d],delete this._bodyPresolveCallbackContext[d]):(this._bodyPresolveCallbacks[d]=b,this._bodyPresolveCallbackContext[d]=c))},setFixturePresolveCallback:function(a,
b,c){a=a.id;-1<a&&(null===b?(delete this._fixturePresolveCallbacks[a],delete this._fixturePresolveCallbackContext[a]):(this._fixturePresolveCallbacks[a]=b,this._fixturePresolveCallbackContext[a]=c))},setCategoryPresolveCallback:function(a,b,c){null===b?(delete this._categoryPresolveCallbacks[a],delete this._categoryPresolveCallbacksContext[a]):(this._categoryPresolveCallbacks[a]=b,this._categoryPresolveCallbackContext[a]=c)},setBodyPostsolveCallback:function(a,b,c){var d=-1;a.id?d=a.id:a.body&&(d=
a.body.id);-1<d&&(null===b?(delete this._bodyPostsolveCallbacks[d],delete this._bodyPostsolveCallbackContext[d]):(this._bodyPostsolveCallbacks[d]=b,this._bodyPostsolveCallbackContext[d]=c))},setFixturePostsolveCallback:function(a,b,c){a=a.id;-1<a&&(null===b?(delete this._fixturePostsolveCallbacks[a],delete this._fixturePostsolveCallbackContext[a]):(this._fixturePostsolveCallbacks[a]=b,this._fixturePostsolveCallbackContext[a]=c))},setCategoryPostsolveCallback:function(a,b,c){null===b?(delete this._categoryPostsolveCallbacks[a],
delete this._categoryPostsolveCallbacksContext[a]):(this._categoryPostsolveCallbacks[a]=b,this._categoryPostsolveCallbackContext[a]=c)},setCollisionCategory:function(a,b){if("undefined"===typeof b)for(var c=this.data.GetFixtureList();c;c=c.GetNext()){var d=c.GetFilterData();d.categoryBits=a}else d=b.GetFilterData(),d.categoryBits=a},setCollisionMask:function(a,b){if("undefined"===typeof b)for(var c=this.data.GetFixtureList();c;c=c.GetNext()){var d=c.GetFilterData();d.maskBits=a}else d=b.GetFilterData(),
d.maskBits=a},applyForce:function(a,b){this.data.ApplyForce(new box2d.b2Vec2(-a,-b),this.data.GetWorldCenter(),!0)},setZeroRotation:function(){this.data.SetAngularVelocity(0)},setZeroVelocity:function(){this.data.SetLinearVelocity(box2d.b2Vec2.ZERO)},setZeroDamping:function(){this.data.SetLinearDamping(0);this.data.SetAngularDamping(0)},toLocalPoint:function(a,b){a.x=this.world.pxm(-b.x);a.y=this.world.pxm(-b.y);this.data.GetLocalPoint(a,a);a.x=this.world.mpx(-a.x);a.y=this.world.mpx(-a.y);return a},
toWorldPoint:function(a,b){a.x=this.world.pxm(-b.x);a.y=this.world.pxm(-b.y);this.data.GetWorldPoint(a,a);a.x=this.world.mpx(-a.x);a.y=this.world.mpx(-a.y);return a},toLocalVector:function(a,b){a.x=this.world.pxm(-b.x);a.y=this.world.pxm(-b.y);this.data.GetLocalVector(a,a);a.x=this.world.mpx(-a.x);a.y=this.world.mpx(-a.y);return a},toWorldVector:function(a,b){a.x=this.world.pxm(-b.x);a.y=this.world.pxm(-b.y);this.data.GetWorldVector(a,a);a.x=this.world.mpx(-a.x);a.y=this.world.mpx(-a.y)},rotateLeft:function(a){this.data.SetAngularVelocity(this.world.pxm(-a))},
rotateRight:function(a){this.data.SetAngularVelocity(this.world.pxm(a))},moveForward:function(a){a=this.world.pxm(a);var b=new box2d.b2Vec2;this.toWorldVector(b,{x:0,y:a});this.data.SetLinearVelocity(b)},moveBackward:function(a){a=this.world.pxm(-a);var b=new box2d.b2Vec2;this.toWorldVector(b,{x:0,y:a});this.data.SetLinearVelocity(b)},thrust:function(a){a=this.world.pxm(a)*this.data.GetMass();var b=new box2d.b2Vec2;this.toWorldVector(b,{x:0,y:a});this.data.ApplyForce(b,this.data.GetWorldCenter(),
!0)},reverse:function(a){a=-this.world.pxm(a)*this.data.GetMass();var b=new box2d.b2Vec2;this.toWorldVector(b,{x:0,y:a});this.data.ApplyForce(b,this.data.GetWorldCenter(),!0)},moveLeft:function(a){this.velocity.x=-a},moveRight:function(a){this.velocity.x=a},moveUp:function(a){this.velocity.y=-a},moveDown:function(a){this.velocity.y=a},preUpdate:function(){this.removeNextStep&&(this.removeFromWorld(),this.removeNextStep=!1)},postUpdate:function(){this.sprite&&(this.sprite.x=this.world.mpx(-this.data.GetPosition().x),
this.sprite.y=this.world.mpx(-this.data.GetPosition().y),this.sprite.rotation=this.data.GetAngle())},kill:function(){this.data.SetActive(!1)},reset:function(a,b){this.data.SetPositionXY(this.world.pxm(-a),this.world.pxm(-b));this.data.SetActive(!0)},removeFromWorld:function(){this.data.world===this.game.physics.box2d.world&&this.game.physics.box2d.removeBodyNextStep(this)},destroy:function(){this.removeFromWorld();this._bodyCallbacks={};this._bodyCallbackContext={};this._categoryCallbacks={};this._categoryCallbackContext=
{};this.sprite=null},clearFixtures:function(){for(var a=[],b=this.data.GetFixtureList();b;b=b.GetNext())a.push(b);for(b=a.length;b--;)this.data.DestroyFixture(a[b])},addCircle:function(a,b,c){a=new box2d.b2CircleShape(this.world.pxm(a));a.m_p.SetXY(this.world.pxm(-b),this.world.pxm(-c));b=new box2d.b2FixtureDef;b.shape=a;b.friction=this.world.friction;b.restitution=this.world.restitution;b.density=this.world.density;b=this.data.CreateFixture(b);b.id=this.world.getNextFixtureId();return b},addRectangle:function(a,
b,c,d,e){"undefined"===typeof a&&(a=16);"undefined"===typeof b&&(b=16);"undefined"===typeof c&&(c=0);"undefined"===typeof d&&(d=0);"undefined"===typeof e&&(e=0);a=this.world.pxm(a);b=this.world.pxm(b);var f=new box2d.b2PolygonShape;f.SetAsOrientedBox(.5*a,.5*b,new box2d.b2Vec2(this.world.pxm(-c),this.world.pxm(-d)),e);a=new box2d.b2FixtureDef;a.shape=f;a.friction=this.world.friction;a.restitution=this.world.restitution;a.density=this.world.density;f=this.data.CreateFixture(a);f.id=this.world.getNextFixtureId();
return f},addEdge:function(a,b,c,d){var e=new box2d.b2EdgeShape;e.Set(new box2d.b2Vec2(this.world.pxm(-a),this.world.pxm(-b)),new box2d.b2Vec2(this.world.pxm(-c),this.world.pxm(-d)));a=new box2d.b2FixtureDef;a.shape=e;a.friction=this.world.friction;a.restitution=this.world.restitution;a.density=this.world.density;e=this.data.CreateFixture(a);e.id=this.world.getNextFixtureId();return e},addChain:function(a,b,c,d){if("undefined"===typeof a||4>a.length)return null;"undefined"===typeof b&&(b=0);"undefined"===
typeof c&&(c=(a.length-b)/2);for(var e=[],f=b;f<b+c;f++)e.push(new box2d.b2Vec2(this.world.pxm(-a[2*f]),this.world.pxm(-a[2*f+1])));a=new box2d.b2ChainShape;d?a.CreateLoop(e,e.length):a.CreateChain(e,e.length);d=new box2d.b2FixtureDef;d.shape=a;d.friction=this.world.friction;d.restitution=this.world.restitution;d.density=this.world.density;d=this.data.CreateFixture(d);d.id=this.world.getNextFixtureId();return d},addLoop:function(a,b,c){return this.addChain(a,b,c,!0)},addPolygon:function(a,b,c){if("undefined"===
typeof a||6>a.length)return null;"undefined"===typeof b&&(b=0);"undefined"===typeof c&&(c=(a.length-b)/2);for(var d=[],e=b;e<b+c;e++)d.push({x:this.world.pxm(-a[2*e]),y:this.world.pxm(-a[2*e+1])});e=new Phaser.Physics.Box2D.Polygon;e.setFromXYObjects(d);d=e.decompose(d);a=null;for(e=0;e<d.length;e++)a=new box2d.b2PolygonShape,a.Set(d[e],d[e].length),b=new box2d.b2FixtureDef,b.shape=a,b.friction=this.world.friction,b.restitution=this.world.restitution,b.density=this.world.density,a=this.data.CreateFixture(b),
a.id=this.world.getNextFixtureId();return a},removeFixture:function(a){if(a.GetBody()!=this.data)return!1;this.data.DestroyFixture(a);return!0},setCircle:function(a,b,c){"undefined"===typeof a&&(a=32);"undefined"===typeof b&&(b=0);"undefined"===typeof c&&(c=0);this.clearFixtures();return this.addCircle(a,b,c)},setRectangle:function(a,b,c,d,e){this.clearFixtures();return this.addRectangle(a,b,c,d,e)},setRectangleFromSprite:function(a){"undefined"===typeof a&&(a=this.sprite);this.clearFixtures();return this.addRectangle(a.width,
a.height,0,0,a.rotation)},setEdge:function(a,b,c,d){"undefined"===typeof a&&(a=0);"undefined"===typeof b&&(b=0);"undefined"===typeof c&&(c=0);"undefined"===typeof d&&(d=0);this.clearFixtures();return this.addEdge(a,b,c,d)},setChain:function(a,b,c,d){if("undefined"===typeof a||4>a.length)return null;"undefined"===typeof b&&(b=0);"undefined"===typeof c&&(c=(a.length-b)/2);this.clearFixtures();return this.addChain(a,b,c,d)},setLoop:function(a,b,c){return this.setChain(a,b,c,!0)},setPolygon:function(a,
b,c){if("undefined"===typeof a||4>a.length)return null;"undefined"===typeof b&&(b=0);"undefined"===typeof c&&(c=(a.length-b)/2);this.clearFixtures();return this.addPolygon(a,b,c)},loadPolygon:function(a,b,c){"undefined"===typeof c&&(c=null);a=this.game.cache.getPhysicsData(a,b);for(b=0;b<a.length;b++){for(var d=[],e=0;e<a[b].shape.length;e+=2)d.push(new box2d.b2Vec2(this.world.pxm(-a[b].shape[e]),this.world.pxm(-a[b].shape[e+1])));if(c){e=this.world.pxm(-.5*c.width);for(var f=this.world.pxm(-.5*c.height),
g=0;g<d.length;g++)d[g].x-=e,d[g].y-=f}e=new box2d.b2PolygonShape;e.Set(d,d.length);d=new box2d.b2FixtureDef;d.shape=e;d.friction=a[b].friction;d.restitution=a[b].bounce;d.density=a[b].density;d.filter.categoryBits=a[b].filter.categoryBits;d.filter.maskBits=a[b].filter.maskBits;this.data.CreateFixture(d).id=this.world.getNextFixtureId()}return!0},containsPoint:function(a){var b=this.world.pxm(-a.x);a=this.world.pxm(-a.y);b=new box2d.b2Vec2(b,a);for(a=this.data.GetFixtureList();a;a=a.GetNext())if(a.TestPoint(b))return!0;
return!1}};Phaser.Physics.Box2D.Body.prototype.constructor=Phaser.Physics.Box2D.Body;Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"static",{get:function(){return this.data.GetType()===box2d.b2BodyType.b2_staticBody},set:function(a){a&&this.data.GetType()!==box2d.b2BodyType.b2_staticBody?this.data.SetType(box2d.b2BodyType.b2_staticBody):a||this.data.GetType()!==box2d.b2BodyType.b2_staticBody||this.data.SetType(box2d.b2BodyType.b2_dynamicBody)}});
Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"dynamic",{get:function(){return this.data.GetType()===box2d.b2BodyType.b2_dynamicBody},set:function(a){a&&this.data.GetType()!==box2d.b2BodyType.b2_dynamicBody?this.data.SetType(box2d.b2BodyType.b2_dynamicBody):a||this.data.GetType()!==box2d.b2BodyType.b2_dynamicBody||this.data.SetType(box2d.b2BodyType.b2_staticBody)}});
Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"kinematic",{get:function(){return this.data.GetType()===box2d.b2BodyType.b2_kinematicBody},set:function(a){a&&this.data.GetType()!==box2d.b2BodyType.b2_kinematicBody?this.data.SetType(box2d.b2BodyType.b2_kinematicBody):a||this.data.GetType()!==box2d.b2BodyType.b2_kinematicBody||this.data.SetType(box2d.b2BodyType.b2_staticBody)}});
Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"angle",{get:function(){return Phaser.Math.wrapAngle(Phaser.Math.radToDeg(this.data.GetAngle()))},set:function(a){this.data.SetAngle(Phaser.Math.degToRad(Phaser.Math.wrapAngle(a)))}});Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"linearDamping",{get:function(){return this.data.GetLinearDamping()},set:function(a){this.data.SetLinearDamping(a)}});
Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"angularDamping",{get:function(){return this.data.GetAngularDamping()},set:function(a){this.data.SetAngularDamping(a)}});Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"angularVelocity",{get:function(){return this.data.GetAngularVelocity()},set:function(a){this.data.SetAngularVelocity(a)}});Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"fixedRotation",{get:function(){return this.data.IsFixedRotation()},set:function(a){this.data.SetFixedRotation(a)}});
Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"gravityScale",{get:function(){return this.data.GetGravityScale()},set:function(a){this.data.SetGravityScale(a)}});Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"friction",{get:function(){var a=this.data.GetFixtureList();return a?a.GetFriction():0},set:function(a){for(var b=this.data.GetFixtureList();b;b=b.GetNext())b.SetFriction(a),b.Refilter()}});
Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"restitution",{get:function(){var a=this.data.GetFixtureList();return a?a.GetRestitution():0},set:function(a){for(var b=this.data.GetFixtureList();b;b=b.GetNext())b.SetRestitution(a),b.Refilter()}});Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"sensor",{get:function(){var a=this.data.GetFixtureList();return a?a.IsSensor():0},set:function(a){for(var b=this.data.GetFixtureList();b;b=b.GetNext())b.SetSensor(a),b.Refilter()}});
Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"bullet",{get:function(){return this.data.IsBullet()},set:function(a){this.data.SetBullet(a)}});
Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"mass",{get:function(){return this.data.GetMass()},set:function(a){if(0===a)this.data.SetType(box2d.b2BodyType.b2_staticBody);else{this.data.GetType()!==box2d.b2BodyType.b2_dynamicBody&&this.data.SetType(box2d.b2BodyType.b2_dynamicBody);var b=this.data.GetMass();a/=b;for(b=this.data.GetFixtureList();b;b=b.GetNext()){var c=b.GetDensity();b.SetDensity(c*a)}this.data.ResetMassData()}}});
Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"rotation",{get:function(){return this.data.GetAngle()},set:function(a){this.data.SetAngle(a)}});Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"x",{get:function(){return this.world.mpx(-this.data.GetPosition().x)},set:function(a){this.data.SetPositionXY(this.world.pxm(-a),this.data.GetPosition().y)}});
Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"y",{get:function(){return this.world.mpx(-this.data.GetPosition().y)},set:function(a){this.data.SetPositionXY(this.data.GetPosition().x,this.world.pxm(-a))}});
Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"collideWorldBounds",{get:function(){for(var a=this.data.GetFixtureList();a;a=a.GetNext())if(a.GetFilterData().maskBits&Phaser.Physics.Box2D.worldBoundsFilterCategory)return!0;return!1},set:function(a){for(var b=this.data.GetFixtureList();b;b=b.GetNext()){var c=b.GetFilterData();c.maskBits=a?c.maskBits|Phaser.Physics.Box2D.worldBoundsFilterCategory:c.maskBits&~Phaser.Physics.Box2D.worldBoundsFilterCategory}}});
Phaser.Physics.Box2D.PointProxy=function(a,b,c,d){this.world=a;this.object=b;this.gettor=c;this.settor=d};Phaser.Physics.Box2D.PointProxy.prototype.constructor=Phaser.Physics.Box2D.PointProxy;Object.defineProperty(Phaser.Physics.Box2D.PointProxy.prototype,"x",{get:function(){return this.world.mpx(-this.gettor.call(this.object).x)},set:function(a){var b=this.gettor.call(this.object);b.x=this.world.pxm(-a);this.settor.call(this.object,b)}});
Object.defineProperty(Phaser.Physics.Box2D.PointProxy.prototype,"y",{get:function(){return this.world.mpx(-this.gettor.call(this.object).y)},set:function(a){var b=this.gettor.call(this.object);b.y=this.world.pxm(-a);this.settor.call(this.object,b)}});Phaser.Physics.Box2D.DefaultDebugDraw=function(a){this.context=null;this.pixelsPerMeter=a;this.flags=box2d.b2DrawFlags.e_shapeBit};Phaser.Physics.Box2D.DefaultDebugDraw.prototype.color=new box2d.b2Color(1,1,1);
Phaser.Physics.Box2D.DefaultDebugDraw.prototype.SetFlags=function(a){this.flags=a};Phaser.Physics.Box2D.DefaultDebugDraw.prototype.GetFlags=function(){return this.flags};Phaser.Physics.Box2D.DefaultDebugDraw.prototype.start=function(a){this.context=a;this.context.save();this.context.scale(-1,-1);this.context.scale(this.pixelsPerMeter,this.pixelsPerMeter)};Phaser.Physics.Box2D.DefaultDebugDraw.prototype.stop=function(){this.context.restore()};
Phaser.Physics.Box2D.DefaultDebugDraw.prototype.PushTransform=function(a){var b=this.context;b.save();b.translate(a.p.x,a.p.y);b.rotate(a.q.GetAngleRadians())};Phaser.Physics.Box2D.DefaultDebugDraw.prototype.PopTransform=function(){this.context.restore()};
Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawPolygon=function(a,b,c){if(b){var d=this.context;d.lineWidth=1/this.pixelsPerMeter;d.beginPath();d.moveTo(a[0].x,a[0].y);for(var e=1;e<b;e++)d.lineTo(a[e].x,a[e].y);d.closePath();d.strokeStyle=c.MakeStyleString(1);d.stroke()}};
Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawSolidPolygon=function(a,b,c){if(b){var d=this.context;d.lineWidth=1/this.pixelsPerMeter;d.beginPath();d.moveTo(a[0].x,a[0].y);for(var e=1;e<b;e++)d.lineTo(a[e].x,a[e].y);d.closePath();d.fillStyle=c.MakeStyleString(.5);d.fill();d.strokeStyle=c.MakeStyleString(1);d.stroke()}};
Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawCircle=function(a,b,c){if(b){var d=this.context;d.beginPath();d.arc(a.x,a.y,b,0,2*Math.PI,!0);d.strokeStyle=c.MakeStyleString(1);d.stroke()}};
Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawSolidCircle=function(a,b,c,d){if(b){var e=this.context;e.lineWidth=1/this.pixelsPerMeter;var f=a.x;a=a.y;e.beginPath();e.arc(f,a,b,0,2*Math.PI,!0);e.moveTo(f,a);e.lineTo(f+c.x*b,a+c.y*b);e.fillStyle=d.MakeStyleString(.5);e.fill();e.strokeStyle=d.MakeStyleString(1);e.stroke()}};
Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawSegment=function(a,b,c){var d=this.context;d.lineWidth=1/this.pixelsPerMeter;d.beginPath();d.moveTo(a.x,a.y);d.lineTo(b.x,b.y);d.strokeStyle=c.MakeStyleString(1);d.stroke()};
Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawTransform=function(a){var b=this.context;b.lineWidth=1/this.pixelsPerMeter;this.PushTransform(a);b.beginPath();b.moveTo(0,0);b.lineTo(1,0);b.strokeStyle=box2d.b2Color.RED.MakeStyleString(1);b.stroke();b.beginPath();b.moveTo(0,0);b.lineTo(0,1);b.strokeStyle=box2d.b2Color.GREEN.MakeStyleString(1);b.stroke();this.PopTransform(a)};
Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawPoint=function(a,b,c){var d=this.context;d.fillStyle=c.MakeStyleString();c=b/2;d.fillRect(a.x-c,a.y-c,b,b)};Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawAABB=function(a,b){var c=this.context;c.strokeStyle=b.MakeStyleString();c.strokeRect(a.lowerBound.x,a.lowerBound.y,a.upperBound.x-a.lowerBound.x,a.upperBound.y-a.lowerBound.y)};
Object.defineProperty(Phaser.Physics.Box2D.DefaultDebugDraw.prototype,"shapes",{get:function(){return this.flags&box2d.b2DrawFlags.e_shapeBit},set:function(a){this.flags=a?this.flags|box2d.b2DrawFlags.e_shapeBit:this.flags&~box2d.b2DrawFlags.e_shapeBit}});Object.defineProperty(Phaser.Physics.Box2D.DefaultDebugDraw.prototype,"joints",{get:function(){return this.flags&box2d.b2DrawFlags.e_jointBit},set:function(a){this.flags=a?this.flags|box2d.b2DrawFlags.e_jointBit:this.flags&~box2d.b2DrawFlags.e_jointBit}});
Object.defineProperty(Phaser.Physics.Box2D.DefaultDebugDraw.prototype,"aabbs",{get:function(){return this.flags&box2d.b2DrawFlags.e_aabbBit},set:function(a){this.flags=a?this.flags|box2d.b2DrawFlags.e_aabbBit:this.flags&~box2d.b2DrawFlags.e_aabbBit}});Object.defineProperty(Phaser.Physics.Box2D.DefaultDebugDraw.prototype,"pairs",{get:function(){return this.flags&box2d.b2DrawFlags.e_pairBit},set:function(a){this.flags=a?this.flags|box2d.b2DrawFlags.e_pairBit:this.flags&~box2d.b2DrawFlags.e_pairBit}});
Object.defineProperty(Phaser.Physics.Box2D.DefaultDebugDraw.prototype,"centerOfMass",{get:function(){return this.flags&box2d.b2DrawFlags.e_centerOfMassBit},set:function(a){this.flags=a?this.flags|box2d.b2DrawFlags.e_centerOfMassBit:this.flags&~box2d.b2DrawFlags.e_centerOfMassBit}});Phaser.Physics.Box2D.DefaultContactListener=function(){};Phaser.Physics.Box2D.DefaultContactListener.prototype.BeginContact=function(a){this.handleContactBeginOrEnd(a,!0)};
Phaser.Physics.Box2D.DefaultContactListener.prototype.EndContact=function(a){this.handleContactBeginOrEnd(a,!1)};
Phaser.Physics.Box2D.DefaultContactListener.prototype.handleContactBeginOrEnd=function(a,b){var c=a.GetFixtureA(),d=a.GetFixtureB(),e=c.GetBody(),f=d.GetBody(),g=c.GetFilterData().categoryBits,h=d.GetFilterData().categoryBits;e=e.parent;f=f.parent;if(void 0!==e&&void 0!==f){var k=e.id,l=f.id;e._bodyContactCallbacks[l]&&e._bodyContactCallbacks[l].call(e._bodyContactCallbackContext[l],e,f,c,d,b,a);f._bodyContactCallbacks[k]&&f._bodyContactCallbacks[k].call(f._bodyContactCallbackContext[k],f,e,d,c,b,
a);e._fixtureContactCallbacks[d.id]&&e._fixtureContactCallbacks[d.id].call(e._fixtureContactCallbackContext[d.id],e,f,c,d,b,a);f._fixtureContactCallbacks[c.id]&&f._fixtureContactCallbacks[c.id].call(f._fixtureContactCallbackContext[c.id],f,e,d,c,b,a);e._fixtureContactCallbacks[c.id]&&e._fixtureContactCallbacks[c.id].call(e._fixtureContactCallbackContext[c.id],e,f,c,d,b,a);f._fixtureContactCallbacks[d.id]&&f._fixtureContactCallbacks[d.id].call(f._fixtureContactCallbackContext[d.id],f,e,d,c,b,a);e._categoryContactCallbacks[h]&&
e._categoryContactCallbacks[h].call(e._categoryContactCallbackContext[h],e,f,c,d,b,a);f._categoryContactCallbacks[g]&&f._categoryContactCallbacks[g].call(f._categoryContactCallbackContext[g],f,e,d,c,b,a);e._categoryContactCallbacks[g]&&e._categoryContactCallbacks[g].call(e._categoryContactCallbackContext[g],e,f,c,d,b,a);f._categoryContactCallbacks[h]&&f._categoryContactCallbacks[h].call(f._categoryContactCallbackContext[h],f,e,d,c,b,a)}};
Phaser.Physics.Box2D.DefaultContactListener.prototype.PreSolve=function(a,b){var c=a.GetFixtureA(),d=a.GetFixtureB(),e=c.GetBody(),f=d.GetBody(),g=c.GetFilterData().categoryBits,h=d.GetFilterData().categoryBits;e=e.parent;f=f.parent;if(void 0!==e&&void 0!==f){var k=e.id,l=f.id;e._bodyPresolveCallbacks[l]&&e._bodyPresolveCallbacks[l].call(e._bodyPresolveCallbackContext[l],e,f,c,d,a,b);f._bodyPresolveCallbacks[k]&&f._bodyPresolveCallbacks[k].call(f._bodyPresolveCallbackContext[k],f,e,d,c,a,b);e._fixturePresolveCallbacks[d.id]&&
e._fixturePresolveCallbacks[d.id].call(e._fixturePresolveCallbackContext[d.id],e,f,c,d,a,b);f._fixturePresolveCallbacks[c.id]&&f._fixturePresolveCallbacks[c.id].call(f._fixturePresolveCallbackContext[c.id],f,e,d,c,a,b);e._categoryPresolveCallbacks[h]&&e._categoryPresolveCallbacks[h].call(e._categoryPresolveCallbackContext[h],e,f,c,d,a,b);f._categoryPresolveCallbacks[g]&&f._categoryPresolveCallbacks[g].call(f._categoryPresolveCallbackContext[g],f,e,d,c,a,b)}};
Phaser.Physics.Box2D.DefaultContactListener.prototype.PostSolve=function(a,b){var c=a.GetFixtureA(),d=a.GetFixtureB(),e=c.GetBody(),f=d.GetBody(),g=c.GetFilterData().categoryBits,h=d.GetFilterData().categoryBits;e=e.parent;f=f.parent;if(void 0!==e&&void 0!==f){var k=e.id,l=f.id;e._bodyPostsolveCallbacks[l]&&e._bodyPostsolveCallbacks[l].call(e._bodyPostsolveCallbackContext[l],e,f,c,d,a,b);f._bodyPostsolveCallbacks[k]&&f._bodyPostsolveCallbacks[k].call(f._bodyPostsolveCallbackContext[k],f,e,d,c,a,b);
e._fixturePostsolveCallbacks[d.id]&&e._fixturePostsolveCallbacks[d.id].call(e._fixturePostsolveCallbackContext[d.id],e,f,c,d,a,b);f._fixturePostsolveCallbacks[c.id]&&f._fixturePostsolveCallbacks[c.id].call(f._fixturePostsolveCallbackContext[c.id],f,e,d,c,a,b);e._categoryPostsolveCallbacks[h]&&e._categoryPostsolveCallbacks[h].call(e._categoryPostsolveCallbackContext[h],e,f,c,d,a,b);f._categoryPostsolveCallbacks[g]&&f._categoryPostsolveCallbacks[g].call(f._categoryPostsolveCallbackContext[g],f,e,d,
c,a,b)}};Phaser.Physics.Box2D.Polygon=function(){this.vertices=[]};Phaser.Physics.Box2D.Polygon.prototype.setFromFlatXYCoords=function(a){this.vertices=[];for(var b=0;b<a.length/2;b++)this.vertices.push({x:a[2*b],y:a[2*b+1]})};Phaser.Physics.Box2D.Polygon.prototype.setFromXYObjects=function(a){this.vertices=a.concat()};Phaser.Physics.Box2D.Polygon.prototype.addVertex=function(a){this.vertices.push(a)};
Phaser.Physics.Box2D.Polygon.prototype.at=function(a){var b=this.vertices.length;return this.vertices[0>a?a%b+b:a%b]};Phaser.Physics.Box2D.Polygon.prototype.indicesAreAdjacent=function(a,b){a%=this.vertices.length;b%=this.vertices.length;if(a==b)return!0;var c=Math.abs(a-b);return 2>c||c==this.vertices.length-1?!0:!1};Phaser.Physics.Box2D.Polygon.prototype.areaInTriangle=function(a,b,c){a=this.at(a);b=this.at(b);c=this.at(c);return.5*((b.x-a.x)*(c.y-a.y)-(c.x-a.x)*(b.y-a.y))};
Phaser.Physics.Box2D.Polygon.prototype.left=function(a,b,c){return 0<this.areaInTriangle(a,b,c)};Phaser.Physics.Box2D.Polygon.prototype.leftOn=function(a,b,c){return 0<=this.areaInTriangle(a,b,c)};Phaser.Physics.Box2D.Polygon.prototype.right=function(a,b,c){return 0>this.areaInTriangle(a,b,c)};Phaser.Physics.Box2D.Polygon.prototype.rightOn=function(a,b,c){return 0>=this.areaInTriangle(a,b,c)};Phaser.Physics.Box2D.Polygon.sqdist=function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d};
Phaser.Physics.Box2D.Polygon.prototype.makeCCW=function(){for(var a=0,b=1,c=this.vertices.length;b<c;b++)if(this.at(b).y<this.at(a).y||this.at(b).y===this.at(a).y&&this.at(b).x>this.at(a).x)a=b;return this.left(a-1,a,a+1)?!1:(this.vertices.reverse(),!0)};Phaser.Physics.Box2D.Polygon.prototype.isConvex=function(){for(var a=!1,b=!1,c=0,d=this.vertices.length;c<d;c++)0<this.areaInTriangle(this.vertices[c],this.vertices[(c+1)%d],this.vertices[(c+2)%d])?a=!0:b=!0;return b^a};
Phaser.Physics.Box2D.Polygon.prototype.isReflex=function(a){return this.right(a-1,a,a+1)};Phaser.Physics.Box2D.Polygon.areVecsEqual=function(a,b){return a.x==b.x&&a.y==b.y};
Phaser.Physics.Box2D.Polygon.linesCross=function(a,b,c,d){if(Phaser.Physics.Box2D.Polygon.areVecsEqual(b,c)||Phaser.Physics.Box2D.Polygon.areVecsEqual(a,c)||Phaser.Physics.Box2D.Polygon.areVecsEqual(b,d)||Phaser.Physics.Box2D.Polygon.areVecsEqual(a,d))return null;var e={};box2d.b2SubVV(b,a,e);box2d.b2CrossVS(e,1,e);var f=box2d.b2DotVV(e,a),g=box2d.b2DotVV(e,c);e=box2d.b2DotVV(e,d);if(g>f&&e>f||g<f&&e<f)return null;e={};box2d.b2SubVV(d,c,e);box2d.b2CrossVS(e,1,e);g=box2d.b2DotVV(e,c);f=box2d.b2DotVV(e,
a);c=box2d.b2DotVV(e,b);if(f>g&&c>g||f<g&&c<g)return null;f=(g-f)/(c-f);return{x:a.x+f*(b.x-a.x),y:a.y+f*(b.y-a.y)}};Phaser.Physics.Box2D.Polygon.prototype.canSee=function(a,b){if(this.indicesAreAdjacent(a,b)||this.leftOn(a+1,a,b)&&this.rightOn(a-1,a,b))return!1;for(var c=0;c<this.vertices.length;++c)if((c+1)%this.vertices.length!=a&&c!=a&&this.leftOn(a,b,c+1)&&this.rightOn(a,b,c)&&Phaser.Physics.Box2D.Polygon.linesCross(this.at(a),this.at(b),this.at(c),this.at(c+1)))return!1;return!0};
Phaser.Physics.Box2D.Polygon.prototype.subPolygon=function(a,b){var c=new Phaser.Physics.Box2D.Polygon;if(a<b)var d=a;else{for(d=a;d<this.vertices.length;d++)c.addVertex(this.at(d));d=0}for(;d<b+1;d++)c.addVertex(this.at(d));return c};
Phaser.Physics.Box2D.Polygon.prototype.decomposeOptimal=function(a){"undefined"===typeof a&&(a=0);if(1<a)return this.vertices;this.makeCCW();for(var b=[],c,d,e=Number.MAX_VALUE,f=0;f<this.vertices.length;f++)if(this.isReflex(f))for(var g=0;g<this.vertices.length;g++)this.canSee(f,g)&&(c=this.subPolygon(f,g).decompose(a+1),d=this.subPolygon(g,f).decompose(a+1),c.length+d.length<e&&(b=c.concat(d),e=b.length));0===b.length&&b.push(this.vertices);return b};
Phaser.Physics.Box2D.Polygon.prototype.decompose=function(a){"undefined"===typeof a&&(a=0);this.makeCCW();for(var b=[],c=Number.MAX_VALUE,d,e,f=!1,g=0;g<this.vertices.length;g++)if(this.isReflex(g)){f=!0;for(var h=this.at(g),k=0;k<this.vertices.length;k++)if(this.canSee(g,k)){var l=this.at(k),m=l.x-h.x;l=l.y-h.y;m=m*m*l*l;m<c&&(d=g,e=k,c=m)}}!f&&8<this.vertices.length&&(d=0,e=Math.floor(this.vertices.length/2),f=!0);f&&(b=this.subPolygon(d,e).decompose(a+1),a=this.subPolygon(e,d).decompose(a+1),b=
b.concat(a));0===b.length&&b.push(this.vertices);return b};
